<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <script>
        (function() {
            try {
                let theme = localStorage.getItem('theme');
                if (!theme) {
                    theme = window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark';
                }
                if (theme === 'light') {
                    document.documentElement.classList.add('light-mode');
                } else {
                    document.documentElement.classList.remove('light-mode');
                }
            } catch (e) {}
        })();
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badr Ibraheem - Graphic Designer</title>
    <meta name="description" content="badr ibraheem mohameed — Graphic Designer and Software Developer from Faiyum, Egypt. Bachelor in Hotel Hospitality Management (2025). Specialized in branding, UI/UX, 3D modeling, and modern web development.">
    <meta name="author" content="Badr Ibraheem Mohameed">
    <meta property="og:image" content="https://badre.site/images/50.webp">
    <link rel="canonical" href="https://badre.site/" />
    <link rel="alternate" hreflang="en" href="https://badre.site/" />
    <link rel="alternate" hreflang="x-default" href="https://badre.site/" />
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Badr Ibraheem">
    <meta property="og:url" content="https://badre.site/">
    <meta property="og:locale" content="en_US" />
    <meta property="og:locale:alternate" content="ar_EG" />
    <meta property="og:title" content="Badr Ibraheem - Software Developer & Graphic Designer Portfolio | Faiyum, Egypt">
    <meta property="og:description" content="Explore the portfolio of Badr Ibraheem, a creative software developer and graphic designer from Faiyum, Egypt with 3+ years of experience. Specializing in branding, 3D design, UI/UX, and modern web development.">
    <meta property="og:image" content="https://badre.site/SEO/Qw93bz.webp">
    <meta property="og:image" content="https://badre.site/SEO/wP6Xq8.webp">
    <meta property="og:image" content="https://badre.site/SEO/tH2xL9.webp">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="badr ibraheem graphic">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="https://badre.site/">
    <meta property="twitter:domain" content="badre.site">
    <meta property="twitter:url" content="https://badre.site/">
    <meta name="twitter:title" content="Badr Ibraheem - Software Developer & Graphic Designer Portfolio | Faiyum, Egypt">
    <meta name="twitter:description" content="badr ibraheem mohameed — Graphic Designer and Software Developer from Faiyum, Egypt. Specialized in branding, UI/UX, 3D modeling, and web development.">
    <meta name="twitter:image" content="https://badre.site/images/50.webp">
    <meta name="twitter:image:alt" content="Badr Ibraheem Mohameed">

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "@id": "https://badre.site/#person",
  "name": "badr ibraheem mohameed",
  "givenName": "badr",
  "familyName": "mohameed",
  "alternateName": [
    "badr ibrahim mohammed",
    "badr e. mohamed"
  ],
  "url": "https://badre.site/",
  "image": [
    {
      "@type": "ImageObject",
      "url": "https://badre.site/images/50.webp",
      "width": 1200,
      "height": 1200,
      "caption": "badr ibraheem graphic"
    },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/bQ9xC1.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/Rb72Ks.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/N1xWc6.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/uK4gV2.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/jK9qW4.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/a7FkP2.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/V4nKp7.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/rF3Zp2.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/L3fZt7.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/Y6nDk0.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/yL5dN0.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/mW2vH9.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/Qw93bz.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/Tz9bF3.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/Zp8mQa.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/sT7nB0.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/Mx1cV8.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/Pq4Lz7.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/tH2xL9.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/yL5dN0.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/mW2vH9.webp" },
    { "@type": "ImageObject", "url": "http://badre.site/SEO/S8kPq4.webp" }
  ],
  "description": "Graphic Designer and Software Developer — specialized in brand identity, UI/UX design, 3D modeling, and modern web development.",
  "jobTitle": "Graphic Designer and Software Developer",
  "worksFor": {
    "@type": "Organization",
    "name": "Gedar (Jedar) Decor Exhibition",
    "url": "https://www.facebook.com/gedar.fayoum/"
  },
  "alumniOf": {
    "@type": "CollegeOrUniversity",
    "name": "Higher Institute of Tourism and Hotels, 6th of October",
    "endDate": "2025"
  },
  "educationalCredentialAwarded": "Bachelor in Tourism and Hotels (Hotel Hospitality Management) — 2025",
  "birthDate": "2003-02-01",
  "birthPlace": { "@type": "Place", "name": "Faiyum, Egypt" },
  "nationality": "Egyptian",
  "knowsAbout": [
    "Graphic Design",
    "Brand Identity",
    "UI/UX Design",
    "3D Modeling",
    "Blender",
    "Adobe Creative Suite",
    "Web Development",
    "HTML",
    "CSS",
    "JavaScript"
  ],
  "email": "mailto:bdr.e.mohameed@gmail.com",
  "telephone": [
    "+20-10-6991-3150",
    "+20-11-1216-2908"
  ],
  "contactPoint": [
    {
      "@type": "ContactPoint",
      "contactType": "work",
      "telephone": "+20-10-6991-3150",
      "areaServed": "EG"
    },
    {
      "@type": "ContactPoint",
      "contactType": "work",
      "telephone": "+20-11-1216-2908",
      "areaServed": "EG"
    }
  ],
  "address": {
    "@type": "PostalAddress",
    "addressLocality": "Faiyum",
    "addressCountry": "EG"
  },
  "sameAs": [
    "https://www.linkedin.com/in/bdremohameed",
    "https://github.com/bdremohameed",
    "https://www.facebook.com/bdr.e.mohmed",
    "https://www.behance.net/bdremohameed",
    "https://khamsat.com/user/bdremohameed/services",
    "https://www.instagram.com/bdr_e_mohamed"
  ]
}
</script>

    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%232B2729'/><defs><linearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%23ACAEB7;stop-opacity:1' /><stop offset='100%25' style='stop-color:%23988381;stop-opacity:1' /></linearGradient></defs><text x='50%' y='55%' dominant-baseline='middle' text-anchor='middle' font-family='Manrope' font-size='80' font-weight='800' fill='url(%23grad)'>B</text></svg>">
    <link rel="apple-touch-icon" href="https://i.postimg.cc/6pYSvmhq/favico.png">


    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8458311823906095"
     crossorigin="anonymous"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>

    <style>
        body, .glass-card, .header-glass, .nav-link, .form-input, .secondary-btn, .store-btn, .view-work-btn, .social-btn, .submit-btn, .skill-card, .service-card, .chat-message, .recommendation-card, .search-result-card, #chat-widget, .maintenance-content {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        :root {
            --background-dark: #2B2729;
            --text-primary: #EAEAEA;
            --text-secondary: #ACAEB7;
            --accent-gradient: linear-gradient(to right, #988381, #ACAEB7);
            --accent-color: #988381;
            --accent-color-rgb: 152, 131, 129;

            --bg-primary: #2B2729;
            --bg-overlay: rgba(43, 39, 41, 0.85);
            --text-primary-color: #EAEAEA;
            --text-secondary-color: #ACAEB7; 
            --border-primary: rgba(172, 174, 183, 0.15);
            --glass-bg: rgba(122, 119, 125, 0.1);
            --glass-hover-bg: rgba(122, 119, 125, 0.2);
            --glass-border-hover: rgba(152, 131, 129, 0.3);
            --text-on-accent: #FFFFFF;
            --shadow-sm: none;
            --shadow-md: 0 8px 20px rgba(0,0,0,0.3);
        }

        html.light-mode {
            --bg-primary: #F0EBE3; 
            --bg-overlay: rgba(240, 235, 227, 0.9);
            --text-primary-color: #29352A; 
            --text-secondary-color: #667063; 
            --border-primary: rgba(41, 53, 42, 0.15);
            --glass-bg: rgba(255, 255, 255, 0.6); 
            --glass-hover-bg: rgba(255, 255, 255, 0.8);
            --glass-border-hover: rgba(102, 112, 99, 0.4); 
            --text-on-accent: #FFFFFF;
            --shadow-sm: 0 1px 2px 0 rgba(41, 53, 42, 0.07);
            --shadow-md: 0 10px 15px -3px rgba(41, 53, 42, 0.1), 0 4px 6px -4px rgba(41, 53, 42, 0.1);
            --accent-gradient: linear-gradient(to right, #29352A, #667063); 
            --accent-color: #667063; 
            --accent-color-rgb: 102, 112, 99;
        }

        body {
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg-primary); 
            color: var(--text-primary-color);
            position: relative;
            overflow-x: hidden;
        }

        #maintenance-overlay {
            background-color: rgba(13, 13, 13, 0.5); 
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
        }
        html.light-mode #maintenance-overlay {
            background-color: rgba(243, 244, 246, 0.7); 
        }
        .maintenance-content {
            background: var(--glass-bg);
            border: 1px solid var(--border-primary);
            padding: 2.5rem;
            border-radius: 1.5rem;
            max-width: 500px;
            box-shadow: var(--shadow-md);
        }

        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            display: none; 
        }
        html.light-mode #bg-canvas {
            display: block; 
        }

        .glow {
            position: fixed;
            filter: blur(120px);
            z-index: -1;
            pointer-events: none;
        }
        #glow1 {
            top: -10%;
            left: -10%;
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, rgba(122, 119, 125, 0.1), transparent 70%);
            animation: pulse-glow 15s infinite alternate;
        }
        #glow2 {
            bottom: -20%;
            right: -20%;
            width: 800px;
            height: 800px;
            background: radial-gradient(circle, rgba(152, 131, 129, 0.08), transparent 70%);
            animation: pulse-glow-two 20s infinite alternate;
        }

        @keyframes pulse-glow {
            from { transform: scale(0.8); opacity: 0.7; }
            to { transform: scale(1.2); opacity: 1; }
        }
        @keyframes pulse-glow-two {
            from { transform: scale(1.2); opacity: 1; }
            to { transform: scale(0.8); opacity: 0.7; }
        }
        
        @keyframes pulse-shadow {
            0% { box-shadow: 0 0 25px rgba(var(--accent-color-rgb), 0.4); }
            50% { box-shadow: 0 0 40px rgba(var(--accent-color-rgb), 0.8); }
            100% { box-shadow: 0 0 25px rgba(var(--accent-color-rgb), 0.4); }
        }
        
        .gradient-text {
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        #mobile-menu {
            position: fixed;
            inset: 0;
            z-index: 90;
            background-color: var(--bg-overlay);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            visibility: hidden;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        #mobile-menu.active {
            opacity: 1;
            pointer-events: auto;
            visibility: visible;
        }
        #mobile-menu .mobile-menu-link {
            font-size: 1.5rem; 
            font-weight: 700;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        #mobile-menu.active .mobile-menu-link {
            opacity: 1;
            transform: translateY(0);
        }
        #mobile-menu.active .mobile-menu-link:nth-child(1) { transition-delay: 0.1s; }
        #mobile-menu.active .mobile-menu-link:nth-child(2) { transition-delay: 0.15s; }
        #mobile-menu.active .mobile-menu-link:nth-child(3) { transition-delay: 0.2s; }
        #mobile-menu.active .mobile-menu-link:nth-child(4) { transition-delay: 0.25s; }
        #mobile-menu.active .mobile-menu-link:nth-child(5) { transition-delay: 0.3s; }
        #mobile-menu.active .mobile-menu-link:nth-child(6) { transition-delay: 0.35s; }

        .project-card:hover .project-overlay {
            opacity: 1;
        }

        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-primary);
            box-shadow: var(--shadow-sm);
            transition: background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease;
        }
        .glass-card:hover {
             background: var(--glass-hover-bg);
             border-color: var(--glass-border-hover);
             box-shadow: var(--shadow-md);
        }

        .header-glass {
            background: rgba(13, 13, 13, 0.6); 
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            border: 1px solid var(--border-primary);
        }
        html.light-mode .header-glass {
             background: rgba(255, 255, 255, 0.8);
             border-color: #e5e7eb; 
             box-shadow: var(--shadow-md);
        }

        .secondary-btn {
             color: var(--text-primary-color);
             font-weight: 600;
             border: 1px solid rgba(255,255,255,0.3);
             padding: 0.5rem 1rem;
             border-radius: 9999px;
             transition: all 0.3s ease;
        }
         html.light-mode .secondary-btn {
            border-color: rgba(0,0,0,0.2);
         }
        .secondary-btn:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-2px);
            border-color: var(--accent-color);
        }
        html.light-mode .secondary-btn:hover {
            background: rgba(0,0,0,0.05);
            border-color: var(--accent-color);
        }
        
        .store-btn {
            color: var(--text-on-accent);
            font-weight: 700;
            border: 1px solid transparent;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            background-image: var(--accent-gradient);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html.light-mode .store-btn {
             background-image: var(--accent-gradient);
             border: 1px solid rgba(0, 0, 0, 0.1);
             color: var(--text-on-accent);
        }
        .store-btn:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(var(--accent-color-rgb), 0.5);
            filter: brightness(1.15); 
        }
        html.light-mode .store-btn:hover {
            box-shadow: 0 8px 25px rgba(var(--accent-color-rgb), 0.4);
        }

        .view-work-btn {
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary-color);
        }
        html.light-mode .view-work-btn {
            background-color: rgba(0, 0, 0, 0.05);
            border-color: rgba(0, 0, 0, 0.1);
        }
        html.light-mode .view-work-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .social-btn {
             color: var(--text-primary-color);
             transition: all 0.3s ease;
             border-radius: 9999px;
             padding: 0.5rem;
        }
        .social-btn svg {
             width: 1.5rem; 
             height: 1.5rem;
        }
        .social-btn:hover {
            color: var(--accent-color);
            transform: scale(1.1) translateY(-2px);
            background-color: rgba(212, 175, 55, 0.1);
        }
        html.light-mode .social-btn:hover {
            background-color: rgba(212, 175, 55, 0.1);
        }
       
        .timeline-item {
            position: relative;
            padding-left: 2.5rem;
            padding-bottom: 2rem;
            border-left: 2px solid rgba(255, 255, 255, 0.1);
        }
        .timeline-item:last-child {
            border-left: 2px solid transparent;
            padding-bottom: 0;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -9px;
            top: 0px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: var(--accent-color);
            border: 2px solid var(--background-dark);
        }
        
        .cta-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--border-primary);
            border-radius: 9999px;
            color: var(--text-primary-color);
            transition: all 0.4s ease;
        }
        .light-mode .cta-btn {
            background: rgba(255, 255, 255, 0.6);
            color: var(--text-primary-color);
        }
        
        .cta-btn:hover {
            transform: scale(1.1);
            background: rgba(255, 255, 255, 0.2);
            border-color: var(--accent-color);
            box-shadow: 0 0 25px rgba(var(--accent-color-rgb), 0.5);
        }
        
        .gsap-reveal {
            will-change: transform, opacity;
        }

        .form-input {
            width: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-primary);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary-color);
            transition: all 0.3s ease;
        }
        html.light-mode .form-input {
             background: rgba(0, 0, 0, 0.05);
        }
        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 15px rgba(var(--accent-color-rgb), 0.3);
        }

        .submit-btn {
            background-image: var(--accent-gradient);
            color: var(--text-on-accent);
            font-weight: 700;
            padding: 0.75rem 1.5rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
        }
        .submit-btn:hover {
            transform: scale(1.05);
            filter: brightness(1.1);
            animation: pulse-shadow 2s infinite;
        }

        .skill-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-radius: 1rem;
        }
        .skill-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
            background-color: var(--glass-hover-bg);
            border-color: var(--glass-border-hover);
        }
        .skill-icon {
            flex-shrink: 0;
            width: 48px;
            height: 48px;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(var(--accent-color-rgb), 0.1);
            color: var(--accent-color);
            transition: all 0.3s ease;
        }
        .skill-card:hover .skill-icon {
            transform: scale(1.1) rotate(-5deg);
            box-shadow: 0 4px 10px rgba(var(--accent-color-rgb), 0.3);
        }
        .skill-icon svg {
            width: 28px;
            height: 28px;
        }
        .skill-details {
            flex-grow: 1;
        }
        .skill-name {
            font-weight: 700;
            color: var(--text-primary-color);
        }
        .skill-desc {
            font-size: 0.875rem;
            color: #9CA3AF; 
        }
        html.light-mode .skill-desc {
            color: #4B5563; 
        }

        .service-card {
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem; 
            padding: 2rem;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            z-index: 1;
        }
        .service-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at var(--x) var(--y), rgba(212, 175, 55, 0.15), transparent 50%);
            opacity: 0;
            transition: opacity 0.4s ease;
            z-index: -1;
        }
        .service-card:hover::before {
            opacity: 1;
        }
        .service-card:hover {
            transform: translateY(-8px);
            border-color: var(--glass-border-hover);
            background: var(--glass-hover-bg);
            box-shadow: var(--shadow-md);
        }
        html.light-mode .service-card {
            background: var(--glass-bg);
            border-color: #e5e7eb; 
        }
        html.light-mode .service-card:hover {
            background: #ffffff;
        }
        html.light-mode .service-card::before {
            background: radial-gradient(circle at var(--x) var(--y), rgba(0, 169, 157, 0.08), transparent 60%);
        }
        .service-card .service-icon {
<!-- ... existing code ...
            transition: color 0.4s ease;
            z-index: -1;
        }
        .service-card:hover .service-number {
            color: rgba(212, 175, 55, 0.15);
        }
        html.light-mode .service-card .service-number {
            color: rgba(0, 0, 0, 0.05);
        }
        html.light-mode .service-card:hover .service-number {
            color: rgba(0, 169, 157, 0.1);
        }


        #preloader {
            position: fixed;
            inset: 0;
            z-index: 100;
            display: none; 
            align-items: center;
            justify-content: center;
            background-color: var(--bg-primary); 
            transition: opacity 1s cubic-bezier(0.77, 0, 0.175, 1); 
        }
        
        #preloader-logo {
            z-index: 101;
            transition: transform 1s cubic-bezier(0.77, 0, 0.175, 1), opacity 0.8s ease-out, filter 0.8s ease-out;
            transform: scale(1);
        }
        
        #preloader.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        #preloader.hidden #preloader-logo {
            transform: scale(0.5); 
            filter: blur(5px);   
            opacity: 0;
        }
        
        body {
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg-primary);
            color: var(--text-primary-color);
            position: relative;
            overflow-x: hidden;
            background-image: url('');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-overlay);
            z-index: -1;
            transition: background-color 0.3s ease;
        }
        .content-hidden {
            opacity: 0;
        }

        #projects-slider-container {
            scroll-behavior: smooth;
            scrollbar-width: none; 
        }
        #projects-slider-container::-webkit-scrollbar {
            display: none; 
        }
        #projects-slider-container {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            scroll-behavior: smooth; 
            padding: 2rem 0;
            perspective: 1000px;
        }
        .project-card {
            scroll-snap-align: center;
            flex: 0 0 auto; 
            margin: 0 1rem; 
            transition: transform 0.5s cubic-bezier(0.25, 1, 0.5, 1);
            transform-style: preserve-3d;
            width: 300px; 
        }
        @media (min-width: 640px) { 
            .project-card { width: 340px; }
        }
        @media (min-width: 768px) { 
            .project-card { width: 360px; }
        }

        #projects-grid {
            padding: 0 calc(50% - 150px);
        }
        @media (min-width: 640px) {
            #projects-grid {
                padding: 0 calc(50% - 170px);
            }
        }
        @media (min-width: 768px) {
            #projects-grid {
                padding: 0 calc(50% - 180px);
            }
        }

        .slider-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            z-index: 30;
            color: var(--text-primary-color);
            transition: all 0.3s ease;
            cursor: pointer;
            padding: 1rem;
        }
        .slider-btn svg {
            width: 2rem; 
            height: 2rem; 
            transition: all 0.3s ease;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
        }
        html.light-mode .slider-btn svg {
             filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
        }
        .slider-btn:hover {
            color: var(--accent-color);
            transform: translateY(-50%) scale(1.15);
        }
        .slider-btn.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
            transform: translateY(-50%) scale(1);
        }

        #testimonial-slider {
            position: relative;
            min-height: 220px; 
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .testimonial-card {
            position: absolute;
            width: 100%;
            opacity: 0;
            transition: opacity 0.6s ease-in-out;
            pointer-events: none;
            text-align: center;
        }
        .testimonial-card.active {
            opacity: 1;
            pointer-events: auto;
            position: relative;
        }

        .star-rating {
            display: flex;
            flex-direction: row; 
            justify-content: center;
            gap: 0.25rem;
            margin-bottom: 1.5rem; 
        }
        .star-rating svg {
            width: 24px;
            height: 24px;
            color: #6B7280; 
        }
        .star-rating svg.filled {
            color: #F59E0B; 
        }
        
        #comment-rating-input {
            display: flex;
            flex-direction: row-reverse;
            justify-content: center;
            gap: 0.25rem;
            margin-bottom: 1rem;
        }
        #comment-rating-input input[type="radio"] {
            display: none;
        }
        #comment-rating-input label {
            cursor: pointer;
        }
        #comment-rating-input label svg {
            width: 28px;
            height: 28px;
            color: #6B7280; 
            transition: color 0.2s ease, transform 0.2s ease;
        }
        #comment-rating-input label:hover {
            transform: scale(1.1);
        }
        
        #comment-rating-input:not(:hover) input[type="radio"]:checked ~ label svg,
        #comment-rating-input:hover label:hover ~ label svg,
        #comment-rating-input label:hover svg {
            color: #F59E0B; 
        }


        #comment-section-wrapper {
            position: relative;
        }
        #comment-form .flex.items-start {
            background: var(--glass-bg);
            padding: 1rem 1.5rem;
            border-radius: 1.5rem; 
            border: 1px solid var(--border-primary);
            transition: all 0.4s ease;
        }
        #comment-form.is-expanded .flex.items-start {
            border-color: var(--glass-border-hover);
            box-shadow: var(--shadow-md);
        }
        #comment-avatar {
            width: 40px;
            height: 40px;
            border-radius: 9999px;
            object-fit: cover;
            border: 2px solid var(--border-primary);
            transition: transform 0.4s ease;
        }
        #comment-form.is-expanded #comment-avatar {
            transform: scale(1.1);
        }
        #comment-message {
            background: transparent;
            border: none;
            border-bottom: 2px solid var(--border-primary);
            border-radius: 0;
            padding: 0.5rem 0.25rem;
            transition: border-color 0.3s ease;
        }
        #comment-message:focus {
            border-color: var(--accent-color);
            box-shadow: none;
            ring: 0 !important;
        }
        #comment-form-collapsible {
            transition: max-height 0.5s cubic-bezier(0.23, 1, 0.32, 1), 
                        opacity 0.4s ease 0.1s,
                        transform 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            transform: translateY(15px);
            max-height: 0px;
            opacity: 0;
            overflow: hidden;
        }
        #comment-form.is-expanded #comment-form-collapsible {
            max-height: 300px;
            opacity: 1;
            transform: translateY(0);
        }


        .modal-hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        #contact-modal, #login-modal, #project-modal {
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        #contact-modal > div:last-of-type,
        #login-modal > div:last-of-type,
        #project-modal > div:last-of-type,
        #settings-modal > div:last-of-type { 
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        #contact-modal:not(.modal-hidden) > div:last-of-type,
        #login-modal:not(.modal-hidden) > div:last-of-type,
        #project-modal:not(.modal-hidden) > div:last-of-type,
        #settings-modal:not(.modal-hidden) > div:last-of-type {
            transform: scale(1);
        }
        
        .project-modal-content {
            background: linear-gradient(160deg, rgba(30, 30, 30, 0.7), rgba(15, 15, 15, 0.8));
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        html.light-mode .project-modal-content {
             background: var(--glass-bg);
        }
        .project-modal-content .form-input {
            background: transparent;
            border: none;
            border-bottom: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 0;
            padding: 0.75rem 0.25rem;
            color: var(--text-primary);
        }
        html.light-mode .project-modal-content .form-input {
            color: var(--text-primary-color);
            border-bottom-color: rgba(0,0,0,0.2);
        }
        .project-modal-content .form-input:focus {
            outline: none;
            box-shadow: none;
            border-color: var(--accent-color);
        }
        .project-modal-content .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #9CA3AF; 
            margin-bottom: 0.25rem;
            text-align: left;
        }
        html.light-mode .project-modal-content .form-label {
            color: #374151; 
        }
        .project-modal-content select.form-input {
            background-color: var(--background-dark);
        }

        .login-modal-content {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.07), rgba(255, 255, 255, 0.02));
            border: 1px solid var(--border-primary);
            position: relative;
            overflow: hidden;
        }
        .login-modal-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(transparent, rgba(212, 175, 55, 0.3), transparent 30%);
            animation: rotate-glow 6s linear infinite;
        }
        @keyframes rotate-glow {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        #google-signin-btn {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-primary-color);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        html.light-mode #google-signin-btn {
            background-color: rgba(0,0,0,0.05);
            border-color: rgba(0,0,0,0.1);
        }
        #google-signin-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
            border-color: rgba(212, 175, 55, 0.5);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }
        html.light-mode #google-signin-btn:hover {
            background-color: rgba(0,0,0,0.1);
            border-color: var(--accent-color);
            box-shadow: 0 0 15px rgba(0, 169, 157, 0.2);
        }

        #theme-toggle-btn {
            position: relative;
        }
        #theme-toggle-btn svg {
            position: absolute;
            left: 50%;
            top: 50%;
            transition: transform 0.4s ease, opacity 0.4s ease;
        }
        html.light-mode #theme-toggle-btn .sun-icon {
            transform: translate(-50%, -50%) rotate(90deg) scale(0.5); 
            opacity: 0;
        }
        html.light-mode #theme-toggle-btn .moon-icon {
            transform: translate(-50%, -50%) rotate(0deg) scale(1); 
            opacity: 1;
        }
        #theme-toggle-btn .sun-icon {
            transform: translate(-50%, -50%) rotate(0deg) scale(1); 
            opacity: 1;
        }
        #theme-toggle-btn .moon-icon {
            transform: translate(-50%, -50%) rotate(90deg) scale(0.5); 
            opacity: 0;
        }

        .nav-link {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
            color: var(--text-primary-color);
        }
        .nav-link:hover {
            color: var(--accent-color);
            background-color: rgba(212, 175, 55, 0.1);
        }
        .nav-link svg {
            transition: transform 0.3s ease;
        }
        .nav-link:hover svg {
            transform: scale(1.1) rotate(5deg);
        }
        .nav-link .tooltip {
            position: absolute;
            top: 120%;
            left: 50%;
            transform: translateX(-50%) scale(0.9);
            background-color: var(--bg-primary);
            color: var(--text-primary-color);
            padding: 0.25rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            border: 1px solid var(--border-primary);
        }
        .nav-link:hover .tooltip {
            opacity: 1;
            transform: translateX(-50%) scale(1);
            top: 130%;
        }

        .nav-link.active {
            color: var(--accent-color);
            background-color: rgba(212, 175, 55, 0.1);
        }



        #user-dropdown {
            display: none;
            transform-origin: top right;
            animation: grow-down 0.2s ease-in-out;
        }
        #user-dropdown.show {
            display: block;
        }
        #user-menu-btn svg {
            transition: transform 0.3s ease;
        }
        #user-menu-btn.open svg {
            transform: rotate(180deg);
        }


        .language-switcher-btn {
            background: none;
            border: none;
            color: var(--text-primary-color);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }
        .language-switcher-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        #language-dropdown {
            display: none;
            position: absolute;
            top: calc(100% + 10px);
            right: 0;
            min-width: 160px;
            z-index: 60;
            transform-origin: top right;
            animation: grow-down 0.3s ease-in-out;
        }
        #language-dropdown.show {
            display: block;
        }
        #language-dropdown a {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary-color);
            transition: background-color 0.3s ease;
            white-space: nowrap;
        }
        #language-dropdown a:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        html.light-mode #language-dropdown a:hover {
             background-color: rgba(0, 0, 0, 0.05);
        }

        @keyframes grow-down {
            0% {
                opacity: 0;
                transform: scale(0.95) translateY(-10px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        

        html[dir="rtl"] body {
            font-family: 'Cairo', sans-serif;
        }
        html[dir="rtl"] .header-glass .container,
        html[dir="rtl"] .header-glass .container .flex.items-center,
        html[dir="rtl"] nav {
            flex-direction: row-reverse;
        }
        html[dir="rtl"] .timeline-item {
            padding-left: 0;
            padding-right: 2.5rem;
            border-left: none;
            border-right: 2px solid rgba(255, 255, 255, 0.1);
            text-align: right;
        }
        html[dir="rtl"] .timeline-item::before {
            left: auto;
            right: -9px;
        }
        html[dir="rtl"] .md\:text-left {
            text-align: right !important;
        }
        html[dir="rtl"] #language-dropdown {
            right: auto;
            left: 0;
            transform-origin: top left;
        }
        html[dir="rtl"] .submit-btn svg {
            transform: translateX(-4px);
        }
        html[dir="rtl"] .submit-btn:hover svg {
            transform: translateX(-8px);
        }
        html[dir="rtl"] .list-disc {
            padding-right: 2.5rem;
        }
        
        /* --- Emoji Fix for Article View Only --- */
        #article-detail-view {
            font-family: 'Manrope', sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }
        html[dir="rtl"] #article-detail-view {
            font-family: 'Cairo', sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }

        #search-modal {
            position: fixed;
            inset: 0;
            z-index: 80;
            background-color: var(--bg-overlay);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        #search-modal.visible {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        #search-modal .search-content {
            width: 100%;
            max-width: 600px;
            margin-top: 20vh;
            transform: translateY(20px);
            transition: transform 0.4s ease 0.1s;
        }
        #search-modal.visible .search-content {
            transform: translateY(0);
        }
        #search-modal #search-input {
            width: 100%;
            background: transparent;
            border: none;
            border-bottom: 2px solid var(--border-primary);
            font-size: 2.5rem; 
            font-weight: 700;
            color: var(--text-primary-color);
            padding: 0.75rem 0;
            outline: none;
            text-align: center;
            transition: border-color 0.3s ease;
        }
        html.light-mode #search-modal #search-input {
            border-bottom-color: rgba(0,0,0,0.2);
        }
        #search-modal #search-input:focus {
            border-bottom-color: var(--accent-color);
        }
        #search-modal #search-input::placeholder {
            color: var(--text-secondary-color);
            opacity: 0.5;
        }
        #search-close-btn {
            position: absolute;
            top: 2rem;
            right: 2rem;
            color: var(--text-secondary-color);
            transition: color 0.3s ease, transform 0.3s ease;
            cursor: pointer;
        }
        #search-close-btn:hover {
            color: var(--text-primary-color);
            transform: rotate(90deg) scale(1.1);
        }

        .admin-controls {
            display: none; 
            gap: 0.5rem;
            position: absolute;
            top: 0.75rem;
            right: 0.75rem;
            z-index: 20;
        }
        body.logged-in .project-card .admin-controls {
            display: flex; 
        }
        #add-project-container {
            display: none; 
        }
        body.logged-in #add-project-container {
            display: block;
        }
        .admin-btn {
            background-color: rgba(13, 13, 13, 0.7);
            backdrop-filter: blur(10px);
            color: white;
            border-radius: 9999px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            border: 1px solid var(--border-primary);
        }
        .admin-btn:hover {
             background-color: rgba(139, 92, 246, 0.8);
        }
        .admin-btn.delete:hover {
            background-color: rgba(239, 68, 68, 0.8);
        }

        .video-container {
            position: relative;
            padding-bottom: 56.25%; 
            height: 0;
            overflow: hidden;
            max-width: 100%;
            background: #000;
        }
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }


        #project-filters-wrapper {

        }

        @keyframes scroll-left {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(-50%); 
            }
        }

        #project-filters {
            padding: 0.25rem 0; 
            animation: scroll-left 40s linear infinite;
        }
        
        #project-filters-wrapper:hover #project-filters {
            animation-play-state: paused;
        }

        .filter-btn {
            background-color: var(--glass-bg); 
            border: 1px solid var(--border-primary); 
            color: var(--text-secondary-color);
            transition: all 0.3s ease; 
            padding: 0.5rem 1rem;
            font-weight: 600;
            border-radius: 9999px; 
            cursor: pointer;
            text-decoration: none; 
            flex-shrink: 0; 
        }
        .filter-btn:hover {
            color: var(--text-primary-color);
            background-color: var(--glass-hover-bg); 
            border-color: var(--glass-border-hover); 
            transform: translateY(-2px); 
        }
        .filter-btn.active {
            color: var(--text-on-accent); 
            background-image: var(--accent-gradient); 
            border-color: transparent; 
            font-weight: 700;
            transform: translateY(0); 
            box-shadow: 0 4px 15px rgba(var(--accent-color-rgb), 0.3);
        }
        

        .status-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 0.75rem;
            font-weight: 700;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            z-index: 10;
        }
        .status-Completed {
            background-color: #10B981; 
            color: #F0FDF4;
        }
        .status-InProgress {
            background-color: #3B82F6; 
            color: #EFF6FF;
        }
        .status-Idea {
            background-color: #F59E0B; 
            color: #FFFBEB;
        }
        

        .project-card-content {
            opacity: 0;
            transform: translateY(100%);
            transition: transform 0.5s cubic-bezier(0.23, 1, 0.32, 1), opacity 0.5s ease;
        }
        .group:hover .project-card-content {
            opacity: 1;
            transform: translateY(0);
            background: linear-gradient(to top, rgba(13, 13, 13, 0.95) 40%, rgba(13, 13, 13, 0.75) 70%, transparent 100%);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
        }
        .project-card-details {
            opacity: 0;
            transition: opacity 0.4s ease-in-out 0.15s;
        }
        .group:hover .project-card-details {
            opacity: 1;
        }
        .light-mode .project-card-content {
            color: var(--text-primary-color);
            background: transparent;
        }
         html.light-mode .group:hover .project-card-content {
            background: linear-gradient(to top, rgba(205, 216, 235, 1) 40%, rgba(205, 216, 235, 0.8) 70%, transparent 100%);
        }
        html.light-mode .project-card-content .text-gray-300 {
            color: var(--text-secondary-color);
        }

        #cv-view {
            position: fixed;
            inset: 0;
            background-color: rgba(13, 13, 13, 0.5);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.4s ease, visibility 0.4s ease;
        }
        html.light-mode #cv-view {
            background-color: rgba(243, 244, 246, 0.7);
        }
        #cv-view.visible {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }
        #cv-view .cv-container {
            background: var(--glass-bg);
            border: 1px solid var(--border-primary);
            border-radius: 1.5rem;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform: scale(0.95);
            transition: transform 0.4s ease;
        }
        #cv-view.visible .cv-container {
            transform: scale(1);
        }
        .cv-content-wrapper {
            overflow-y: auto;
            padding: 1rem;
        }
        @media (min-width: 768px) {
             .cv-content-wrapper {
                padding: 1.5rem 2.5rem 2.5rem 2.5rem;
            }
        }
        .cv-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2.5rem;
        }
        @media (min-width: 768px) {
            .cv-grid {
                grid-template-columns: 300px 1fr;
            }
        }
        .cv-sidebar {
            background-color: rgba(255, 255, 255, 0.03);
            border-radius: 1rem;
            padding: 2rem;
        }
        html.light-mode .cv-sidebar {
             background-color: rgba(0, 0, 0, 0.03);
        }

        @media print {
            body *, #cv-view {
                visibility: hidden;
            }
            .cv-container, .cv-container * {
                visibility: visible;
            }
            #cv-view {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: auto;
                transform: translateY(0) !important;
                overflow: visible;
                background: none !important;
                backdrop-filter: none !important;
                padding: 0;
            }
            .cv-container {
                max-height: none;
                overflow: visible;
                display: block;
                border-radius: 0;
            }
            .cv-content-wrapper {
                overflow: visible;
                padding: 0;
            }
            .cv-header {
                display: none;
            }
            .cv-grid {
                grid-template-columns: 300px 1fr !important;
            }
            .glass-card, .cv-sidebar {
                 background: transparent !important;
                 box-shadow: none !important;
                 border: 1px solid #e5e7eb !important;
            }
            body {
                background: #fff !important;
                color: #000 !important;
            }
            h1, h2, h3, h4, p, span, a, li {
                color: #000 !important;
            }
            .gradient-text {
                background: none !important;
                -webkit-text-fill-color: #00A99D !important;
            }
        }

        #articles-slider-container {
            scroll-behavior: smooth;
            scrollbar-width: none;
            perspective: 1000px; 
        }
        #articles-slider-container::-webkit-scrollbar {
            display: none;
        }
        #articles-grid {
            padding: 0 calc(50% - 140px);
        }
        @media (min-width: 640px) {
            #articles-grid {
                padding: 0 calc(50% - 160px);
            }
        }

        #article-detail-admin-controls {
            display: none;
        }
        body.logged-in #article-detail-admin-controls {
            display: flex;
        }


        .gallery-container {
            position: relative;
            margin-bottom: 1.5rem;
        }
        .gallery-main-image img {
            width: 100%;
            max-height: 70vh;
            object-fit: contain;
            border-radius: 0.75rem;
            background-color: rgba(0,0,0,0.2);
        }
        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 0.5rem;
            pointer-events: none;
        }
        .gallery-nav button {
            pointer-events: all;
            background-color: rgba(13, 13, 13, 0.6);
            backdrop-filter: blur(8px);
            border: 1px solid var(--border-primary);
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }
        .gallery-nav button:hover {
            background-color: var(--accent-color);
            transform: scale(1.1);
        }
        .gallery-thumbs {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }
        .gallery-thumb {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 0.375rem;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease;
            opacity: 0.6;
            flex-shrink: 0;
        }
        .gallery-thumb:hover {
            opacity: 1;
            border-color: var(--accent-color);
        }
        .gallery-thumb.active {
            opacity: 1;
            border-color: var(--accent-color);
        }

        /* --- Image Lightbox --- */
        #image-lightbox.modal-hidden {
            pointer-events: none;
            opacity: 0;
        }
        #image-lightbox {
            transition: opacity 0.3s ease;
        }
        #image-lightbox img {
            transition: transform 0.3s ease;
            transform: scale(0.95);
        }
        #image-lightbox:not(.modal-hidden) img {
            transform: scale(1);
        }

        .project-stats {
            display: flex;
            align-items: center;
            gap: 0.75rem; 
            color: #9CA3AF; 
        }
        html.light-mode .project-stats {
            color: #4B5563; 
        }
        .project-stats svg {
            width: 1rem; 
            height: 1rem; 
        }

        .like-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary-color);
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 9999px;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
        }
        html.light-mode .like-btn {
            background-color: rgba(0,0,0,0.05);
            border-color: rgba(0,0,0,0.1);
        }
        .like-btn svg {
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .like-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
        }
        .like-btn:hover svg {
            transform: scale(1.2);
        }
        html.light-mode .like-btn:hover {
             background-color: rgba(0,0,0,0.1);
             color: var(--text-primary-color);
        }
        .like-btn.liked {
            background-color: #ef4444; 
            color: white;
            border-color: transparent;
        }
        .like-btn.liked svg {
            fill: white;
        }

        .share-btn {
            background-color: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary-color);
            transition: all 0.3s ease;
            padding: 0.5rem;
            border-radius: 9999px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            width: 40px;
            height: 40px;
        }
        html.light-mode .share-btn {
            background-color: rgba(0,0,0,0.05);
            border-color: rgba(0,0,0,0.1);
        }
        .share-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            transform: translateY(-2px);
        }
        html.light-mode .share-btn:hover {
             background-color: rgba(0,0,0,0.1);
             color: var(--text-primary-color);
        }
        .share-btn.copied {
            background-color: #10B981 !important; 
            color: white !important;
            border-color: transparent !important;
        }

        #contact-fab-btn {
            transform: scale(0);
            opacity: 0;
            pointer-events: none;
        }
        #contact-fab-btn.fab-visible {
            transform: scale(1);
            opacity: 1;
            pointer-events: auto;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        html.light-mode ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #FFD700; 
        }
        html.light-mode #hero h2, .light-mode #hero p, .light-mode .prose {
             color: var(--text-secondary-color);
        }
        html.light-mode .text-gray-300 { color: var(--text-secondary-color); }
        html.light-mode .text-gray-400 { color: #374151; } 
        html.light-mode .text-gray-500 { color: #4B5563; } 
        html.light-mode .text-white { color: var(--text-primary-color); }
        html.light-mode .prose-invert {
            --tw-prose-body: var(--text-secondary-color);
            --tw-prose-headings: var(--text-primary-color);
            --tw-prose-lead: #4b5563;
            --tw-prose-links: #111827;
            --tw-prose-bold: #111827;
            --tw-prose-counters: #6b7280;
            --tw-prose-bullets: #9ca3af;
            --tw-prose-hr: rgba(0,0,0,0.1);
            --tw-prose-quotes: #111827;
            --tw-prose-quote-borders: #e5e7eb;
            --tw-prose-captions: #6b7280;
            --tw-prose-code: #111827;
            --tw-prose-pre-code: #e5e7eb;
            --tw-prose-pre-bg: #1f2937;
            --tw-prose-th-borders: #d1d5db;
            --tw-prose-td-borders: #e5e7eb;
        }
        html.light-mode .ring-white\/10 {
            --tw-ring-color: rgba(0,0,0,0.05);
        }
        html.light-mode .bg-white\/10 {
            background-color: rgba(0,0,0,0.05);
        }
        html.light-mode .text-violet-300, span.text-violet-300 {
            color: #00A99D; 
        }
        html.light-mode .contact-info-panel {
             border-right: 1px solid var(--border-primary);
        }
        #contact-modal .glass-card {
            background: rgba(13, 13, 13, 0.4); 
            backdrop-filter: blur(32px); 
            -webkit-backdrop-filter: blur(32px);
        }
        html.light-mode #contact-modal .glass-card {
            background: rgba(255, 255, 255, 0.6); 
        }
        html.light-mode #testimonials .glass-card {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
        }

        #timeline-nav {
            border-bottom: 2px solid var(--border-primary);
        }
        .timeline-nav-btn {
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            color: var(--text-secondary-color);
            position: relative;
            cursor: pointer;
            transition: color 0.3s ease;
            background: transparent;
            border: none;
        }
        .timeline-nav-btn::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 50%;
            right: 50%;
            height: 3px;
            background: var(--accent-gradient);
            transition: left 0.3s ease, right 0.3s ease;
        }
        .timeline-nav-btn:hover,
        .timeline-nav-btn.active {
            color: var(--text-primary-color);
        }
        .timeline-nav-btn.active::after {
            left: 0;
            right: 0;
        }

        #timeline-content-cards .timeline-content-card {
            position: absolute;
            inset: 0;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: opacity 0.5s ease, transform 0.5s ease, visibility 0.5s;
        }
        #timeline-content-cards .timeline-content-card.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .experience-timeline-container {
            position: relative;
            max-width: 48rem;
            margin: 0 auto;
        }
        .experience-timeline-container::after {
            content: '';
            position: absolute;
            width: 2px;
            background: linear-gradient(to bottom, transparent, var(--accent-color), transparent);
            top: 1rem;
            bottom: 1rem;
            left: 1rem;
            margin-left: -1px;
            border-radius: 2px;
        }
        .timeline-item-vertical {
            padding: 0;
            padding-left: 3rem;
            position: relative;
            margin-bottom: 2.5rem;
        }
        .timeline-item-vertical:last-child {
            margin-bottom: 0;
        }
        .timeline-item-vertical::after {
            content: '';
            position: absolute;
            width: 18px;
            height: 18px;
            left: 1rem;
            transform: translateX(-50%);
            background-color: var(--bg-primary);
            border: 3px solid var(--accent-color);
            top: 0.5rem;
            border-radius: 50%;
            z-index: 1;
            transition: all 0.3s ease;
        }
        .timeline-item-vertical:hover::after {
            background-color: var(--accent-color);
            box-shadow: 0 0 15px rgba(var(--accent-color-rgb), 0.5);
        }
        .timeline-content {
            padding: 1.5rem;
            position: relative;
            border-radius: 1rem;
            transition: all 0.3s ease;
            border: 1px solid var(--border-primary);
        }
        .timeline-item-vertical:hover .timeline-content {
            transform: translateY(-5px);
            border-color: var(--glass-border-hover);
            background: var(--glass-hover-bg);
        }
        .timeline-date {
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--accent-color);
        }
        html[dir="rtl"] .experience-timeline-container::after {
            left: auto;
            right: 1rem;
        }
        html[dir="rtl"] .timeline-item-vertical {
            padding-left: 0;
            padding-right: 3rem;
        }
        html[dir="rtl"] .timeline-item-vertical::after {
            left: auto;
            right: 1rem;
            transform: translateX(50%);
        }

        #cta {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            z-index: 40;
        }
        #cta .glass-card {
            border-bottom-left-radius: 0;
            border-bottom-right-radius: 0;
            border-bottom: none;
            max-width: 900px; 
            margin-left: auto;
            margin-right: auto;
        }
        html.light-mode #cta .glass-card {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(24px);
            -webkit-backdrop-filter: blur(24px);
        }

        .timeline-item-cv {
            position: relative;
        }
        .timeline-item-cv::before {
            content: '';
            position: absolute;
            left: -39px; 
            top: 5px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--bg-primary);
            border: 3px solid var(--accent-color);
            transition: all 0.3s ease;
        }
        html.light-mode .timeline-item-cv::before {
             background: var(--bg-primary);
        }

        html[dir="rtl"] .timeline-item-cv {
            border-left: none;
            border-right: 2px solid var(--border-primary);
            margin-left: 0;
            margin-right: 0.75rem; 
            padding-left: 0;
            padding-right: 2rem; 
        }
         html[dir="rtl"] .timeline-item-cv::before {
            left: auto;
            right: -40px;
        }


        body.logged-in .store-product-card .admin-controls {
            display: flex;
        }
        #add-product-container {
            display: none;
        }
        body.logged-in #add-product-container {
            display: block;
        }

        .store-product-card {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            border-radius: 1.5rem; 
            border: 1px solid var(--border-primary);
            padding: 1rem;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
        }
        .store-product-card:before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 1.5rem;
            border: 2px solid transparent;
            background: linear-gradient(45deg, var(--accent-color), #8B5CF6) border-box;
            -webkit-mask:
                linear-gradient(#fff 0 0) padding-box,
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: destination-out;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.4s ease;
            pointer-events: none; 
        }
        .store-product-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 30px rgba(0,0,0,0.2);
        }
        .store-product-card:hover:before {
            opacity: 1;
        }
        .store-product-card .product-card-image {
            aspect-ratio: 1 / 1;
            overflow: hidden;
            border-radius: 1rem; 
            margin-bottom: 1rem;
        }
        .store-product-card .product-card-image img {
            transition: transform 0.5s ease;
        }
        .store-product-card:hover .product-card-image img {
            transform: scale(1.08);
        }
        .store-product-card .product-category {
            font-size: 0.875rem; 
            color: var(--text-secondary-color);
            font-weight: 500;
        }
        .store-product-card .product-title {
            font-size: 1.25rem; 
            font-weight: 700;
            color: var(--text-primary-color);
            margin: 0.25rem 0 1rem 0;
            min-height: 3.5rem; 
        }
        .store-product-card .details-price-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid var(--border-primary);
        }
        .store-product-card .product-price-display {
            font-size: 1.5rem; 
            font-weight: 800;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .store-product-card .details-btn {
            background: transparent;
            color: var(--text-primary-color);
            font-weight: 600;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            transition: all 0.3s ease;
            border: 1px solid var(--border-primary);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        html.light-mode .store-product-card .details-btn {
            border-color: rgba(0,0,0,0.2);
        }
        .store-product-card .details-btn:hover {
            background-color: var(--accent-color);
            color: var(--text-on-accent);
            transform: scale(1.05);
            border-color: var(--accent-color);
        }
        .store-product-card .details-btn svg {
             width: 1rem; 
             height: 1rem;
             transition: transform 0.3s ease;
        }
        .store-product-card .details-btn:hover svg {
            transform: translateX(3px);
        }

        #product-media-slider-container {
            perspective: 1200px;
            position: relative;
            width: 100%;
            height: 100%;
        }
        .product-media-slide {
            position: absolute;
            width: 60%;
            height: 100%;
            top: 0;
            left: 20%;
            border-radius: 1rem;
            overflow: hidden;
            transition: transform 0.5s ease, opacity 0.5s ease, z-index 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0,0,0,0.2);
        }
        .product-media-slide img,
        .product-media-slide iframe {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .product-media-slide.active {
            transform: translateX(0) scale(1.1);
            opacity: 1;
            z-index: 10;
        }
        .product-media-slide.active[data-media-type="image"] {
            cursor: pointer;
        }
        .product-media-slide.prev {
            transform: translateX(-55%) scale(0.85);
            opacity: 0.4;
            z-index: 5;
        }
        .product-media-slide.next {
            transform: translateX(55%) scale(0.85);
            opacity: 0.4;
            z-index: 5;
        }
        .product-media-slide.hidden-prev {
             transform: translateX(-80%) scale(0.7);
             opacity: 0;
             z-index: 1;
        }
        .product-media-slide.hidden-next {
             transform: translateX(80%) scale(0.7);
             opacity: 0;
             z-index: 1;
        }


        #certificates-slider-container {
            perspective: 1000px;
            position: relative;
            width: 100%;
            height: 100%;
        }
        .certificate-card-slider {
            position: absolute;
            width: 60%;
            height: 100%;
            top: 0;
            left: 20%;
            border-radius: 1rem;
            overflow: hidden;
            cursor: pointer;
            transition: transform 0.5s ease, opacity 0.5s ease, z-index 0.5s ease;
            -webkit-box-reflect: below 1px linear-gradient(transparent, transparent, #0004);
        }
        .certificate-card-slider img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .certificate-card-slider .overlay {
             position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent 70%);
            display: flex;
            align-items: flex-end;
            padding: 1rem;
            opacity: 1; 
        }
         .certificate-card-slider .overlay h5 {
            color: white;
            font-weight: 700;
        }
        .certificate-card-slider.active {
            transform: translateX(0) scale(1.15);
            opacity: 1;
            z-index: 10;
            cursor: default;
        }
        .certificate-card-slider.prev {
            transform: translateX(-50%) scale(0.9);
            opacity: 0.5;
            z-index: 5;
        }
        .certificate-card-slider.next {
            transform: translateX(50%) scale(0.9);
            opacity: 0.5;
            z-index: 5;
        }
        .certificate-card-slider.hidden-prev {
             transform: translateX(-70%) scale(0.7);
             opacity: 0;
             z-index: 1;
        }
        .certificate-card-slider.hidden-next {
             transform: translateX(70%) scale(0.7);
             opacity: 0;
             z-index: 1;
        }
        body.logged-in .certificate-card-slider .admin-controls {
            display: flex;
        }
        body.logged-in #add-certificate-container {
            display: block;
        }

        #certificate-gallery-modal .gallery-nav {
            background-color: rgba(13, 13, 13, 0.6);
            backdrop-filter: blur(8px);
            border: 1px solid var(--border-primary);
            border-radius: 50%;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        #certificate-gallery-modal .gallery-nav:hover {
            background-color: var(--accent-color);
            transform: scale(1.1);
        }
        #certificate-gallery-modal .gallery-nav.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }
        #certificate-gallery-modal img {
            transition: transform 0.3s ease, opacity 0.3s ease;
            transform: scale(0.95);
            opacity: 0;
        }
        #certificate-gallery-modal:not(.modal-hidden) img {
            transform: scale(1);
            opacity: 1;
        }


        #chat-fab-btn {
            transform: scale(0);
            opacity: 0;
            pointer-events: none;
        }
        #chat-fab-btn.fab-visible {
            transform: scale(1);
            opacity: 1;
            pointer-events: auto;
        }
        #chat-widget {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 90;
            width: clamp(300px, 90vw, 400px);
            max-height: 70vh;
            border-radius: 1.5rem;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transform: translateY(20px) scale(0.95);
            opacity: 0;
            visibility: hidden;
            transition: transform 0.3s ease, opacity 0.3s ease, visibility 0.3s ease;
        }
        #chat-widget.visible {
            transform: translateY(0) scale(1);
            opacity: 1;
            visibility: visible;
        }
        .chat-header {
            padding: 1rem 1.5rem;
            flex-shrink: 0;
        }
        #chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 0 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .chat-message {
            max-width: 85%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            word-wrap: break-word;
        }
        .chat-message.user {
            background-image: var(--accent-gradient);
            color: var(--text-on-accent);
            border-bottom-right-radius: 0.25rem;
            align-self: flex-end;
        }
        .chat-message.bot {
            background-color: rgba(255, 255, 255, 0.1);
            border-bottom-left-radius: 0.25rem;
            align-self: flex-start;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        .bot-suggestion-card {
            display: flex;
            align-items: center;
            gap: 0.75rem; 
            background-color: rgba(255, 255, 255, 0.05);
            padding: 0.5rem; 
            border-radius: 0.75rem; 
            transition: background-color 0.2s ease;
            text-decoration: none;
            color: var(--text-primary-color);
        }
        .bot-suggestion-card:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .bot-suggestion-card img {
            width: 48px; 
            height: 48px; 
            border-radius: 0.5rem; 
            object-fit: cover;
            flex-shrink: 0;
        }
         .bot-suggestion-card .suggestion-info {
            flex-grow: 1;
            min-width: 0; 
        }
        .bot-suggestion-card .suggestion-title {
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
         .bot-suggestion-card .suggestion-type {
            font-size: 0.75rem; 
            color: var(--text-secondary-color);
            text-transform: uppercase;
        }
        html.light-mode .chat-message.bot {
            background-color: #e5e7eb; 
        }
        #chat-form {
            padding: 1.5rem;
            flex-shrink: 0;
        }
        #chat-input {
            padding-right: 3rem; 
        }
        #chat-send-btn {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            width: 2rem;
            height: 2rem;
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary-color);
            transition: all 0.2s ease;
        }
        #chat-send-btn:hover {
            background-color: rgba(212, 175, 55, 0.1);
            color: var(--accent-color);
        }
        .typing-indicator span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: currentColor;
            margin: 0 2px;
            animation: bounce 1.4s infinite both;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }

        #project-recommendations-container h4 {
            border-bottom: 2px solid var(--border-primary);
            padding-bottom: 0.75rem;
            margin-bottom: 1.5rem;
        }
        .recommendation-card {
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }
        .recommendation-card:hover {
            transform: translateY(-5px);
            border-color: var(--glass-border-hover);
            background: var(--glass-hover-bg);
        }
        .recommendation-card img {
            aspect-ratio: 16 / 10;
            object-fit: cover;
        }

        #article-recommendations-container h4 {
            border-bottom: 2px solid var(--border-primary);
            padding-bottom: 0.75rem;
            margin-bottom: 1.5rem;
        }
        .article-recommendation-card {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
            padding: 1rem;
            border-radius: 1rem;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            text-decoration: none;
        }
        .article-recommendation-card:hover {
            transform: translateY(-5px);
            border-color: var(--glass-border-hover);
            background: var(--glass-hover-bg);
        }
        .article-recommendation-card img {
            width: 80px;
            aspect-ratio: 16 / 10;
            object-fit: cover;
            border-radius: 0.5rem;
            flex-shrink: 0;
        }
        .article-recommendation-card-info h5 {
            font-weight: 700;
            color: var(--text-primary-color);
            line-height: 1.3;
            margin-bottom: 0.25rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .article-recommendation-card-info p { 
            font-size: 0.75rem;
            color: var(--text-secondary-color);
        }
        .article-recommendation-desc {
            font-size: 0.875rem; 
            color: var(--text-secondary-color);
            line-height: 1.4;
            margin-bottom: 0.5rem;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .article-recommendation-date {
            font-size: 0.75rem; 
            color: var(--text-secondary-color);
            opacity: 0.7;
        }


        #reading-progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background-image: var(--accent-gradient);
            width: 0%;
            z-index: 9998; 
            transition: width 0.1s linear;
            box-shadow: 0 2px 10px rgba(var(--accent-color-rgb), 0.5);
            display: none; 
        }

        .search-result-card {
            display: flex;
            gap: 1.5rem; 
            align-items: flex-start;
            background: transparent; 
            padding: 1.5rem;
            border-radius: 1.25rem; 
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            border: 1px solid var(--border-primary);
            margin-bottom: 1.5rem;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
         .search-result-card:hover {
            transform: translateY(-6px);
            border-color: var(--glass-border-hover);
            background: var(--glass-hover-bg);
            box-shadow: var(--shadow-md);
        }
        .search-result-icon {
            flex-shrink: 0;
            width: 52px;
            height: 52px;
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(var(--accent-color-rgb), 0.1);
            color: var(--accent-color);
            transition: all 0.4s ease;
        }
        .search-result-card:hover .search-result-icon {
            transform: scale(1.1) rotate(-8deg);
            box-shadow: 0 5px 15px rgba(var(--accent-color-rgb), 0.3);
        }
        .search-result-icon svg {
            width: 28px;
            height: 28px;
        }
        .search-result-content {
            flex-grow: 1;
        }
        .search-result-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary-color);
            margin-bottom: 0.25rem;
        }
        .search-result-description {
            color: var(--text-secondary-color);
            font-size: 0.875rem;
            line-height: 1.6;
        }
        .search-result-type-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary-color);
            background-color: rgba(255, 255, 255, 0.05);
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        html.light-mode .search-result-type-badge {
            background-color: rgba(0,0,0,0.05);
        }

        .article-body[dir="rtl"] {
            text-align: right;
            direction: rtl;
        }
        .article-body[dir="ltr"] {
            text-align: left;
            direction: ltr;
        }
        /* Fix lists in RTL mode */
        .article-body[dir="rtl"] ul, 
        .article-body[dir="rtl"] ol {
            padding-right: 1.5rem;
            padding-left: 0;
        }
        .article-body[dir="rtl"] .list-disc {
             padding-right: 1.5rem;
             padding-left: 0;
        }

    </style>
</head>

<body>
    <div id="reading-progress-bar"></div>
    <div id="maintenance-overlay" class="hidden fixed inset-0 z-[9999] flex items-center justify-center p-4">
        <div class="maintenance-content text-center">
            <svg class="mx-auto h-16 w-16 text-[var(--accent-color)] mb-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M11.42 15.17L17.25 21A2.652 2.652 0 0021 17.25l-5.877-5.877M11.42 15.17l2.472-2.472a3.375 3.375 0 00-4.773-4.773L6.23 5.73a3.375 3.375 0 00-4.773 4.773l2.472 2.472M11.42 15.17l-2.472 2.472a3.375 3.375 0 01-4.773-4.773L5.73 6.23a3.375 3.375 0 014.773-4.773l2.472 2.472" />
            </svg>
            <h1 class="text-4xl font-bold mb-2">Under Maintenance</h1>
            <p class="text-gray-400">Our site is currently undergoing scheduled maintenance. We'll be back shortly. Thank you for your patience.</p>
        </div>
    </div>
    <canvas id="bg-canvas"></canvas>
    <div id="preloader">
        <div id="preloader-logo" class="text-7xl font-bold gradient-text">B</div>
    </div>

    <div id="glow1" class="glow"></div>
    <div id="glow2" class="glow"></div>

    <header class="header-glass fixed top-4 left-1/2 -translate-x-1/2 w-[90%] sm:w-[95%] max-w-5xl z-50 rounded-full content-hidden">
        <div class="container mx-auto px-4 sm:px-6 py-3 flex justify-between items-center relative">
            
            <div class="flex items-center gap-2 md:gap-4">
                <div id="header-search-container" class="relative flex items-center">
                    <input type="text" id="header-search-input" placeholder="Type to search..." 
                           class="w-0 opacity-0 transition-all duration-300 ease-in-out bg-transparent border-b border-[var(--accent-color)] text-[var(--text-primary-color)] focus:outline-none text-sm"
                           data-translate-placeholder="searchPlaceholder">
                    <button id="header-search-btn" class="nav-link" title="Search">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                    </button>
                </div>
                
                <button id="theme-toggle-btn" class="nav-link" title="Toggle theme" data-translate-title="tooltipToggleTheme">
                    <svg class="sun-icon w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41-1.41"/><path d="m19.07 4.93-1.41 1.41"/></svg>
                    <svg class="moon-icon w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></svg>
                </button>

                <div class="relative" id="language-switcher">
                    <button id="language-switcher-btn" class="nav-link" title="Change language" data-translate-title="tooltipChangeLang">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg>
                    </button>
                    <div id="language-dropdown" class="glass-card rounded-xl overflow-hidden shadow-lg">
                        <a href="#" class="language-option" data-lang="en"><span>🇺🇸</span> English</a>
                        <a href="#" class="language-option" data-lang="ar"><span>🇪🇬</span> العربية</a>
                    </div>
                </div>
            </div>

            <nav class="hidden md:flex space-x-2 lg:space-x-3 items-center absolute left-1/2 -translate-x-1/2">
                <a href="#hero" class="nav-link !p-2 !font-semibold text-sm" data-nav-link="hero" title="Home">
                    <span data-translate-key="navHome">Home</span>
                </a>
                <a href="#projects" class="nav-link !p-2 !font-semibold text-sm" data-nav-link="projects" title="Projects">
                    <span data-translate-key="navProjects">Projects</span>
                </a>
                <a href="#blog" class="nav-link !p-2 !font-semibold text-sm" data-nav-link="blog" title="Blog">
                    <span data-translate-key="navBlog">Blog</span>
                </a>
                 <a href="#certificates" class="nav-link !p-2 !font-semibold text-sm" data-nav-link="certificates" title="Certificates" data-translate-title="navCertificates">
                    <span data-translate-key="navCertificates">Certificates</span>
                </a>
                 <a href="#" id="cv-nav-btn" class="nav-link !p-2 !font-semibold text-sm" title="View CV">
                    <span>CV</span>
                </a>
            </nav>
            
            <div class="flex items-center gap-2 md:gap-4">
                 <div id="auth-container" class="text-2xl font-bold">
                    <a href="#" id="auth-link" class="gradient-text">Badr.</a>
                </div>

                <button id="mobile-menu-button" class="md:hidden p-2 rounded-md focus:outline-none text-gray-300">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" y1="12" x2="20" y2="12"></line><line x1="4" y1="6" x2="20" y2="6"></line><line x1="4" y1="18" x2="20" y2="18"></line></svg>
                </button>
            </div>

        </div>
    </header>

    <div id="mobile-menu" class="md:hidden">
        <button id="mobile-menu-close-button" class="absolute top-6 right-6 text-gray-300 p-2 z-10">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
        <div class="flex flex-col items-center space-y-6 text-center">
             <a href="#hero" class="mobile-menu-link" data-translate-key="navHome">Home</a>
             <a href="#projects" class="mobile-menu-link" data-translate-key="navProjects">Projects</a>
             <a href="#blog" class="mobile-menu-link" data-translate-key="navBlog">Blog</a>
             <a href="#certificates" class="mobile-menu-link" data-translate-key="navCertificates">Certificates</a>
             <a href="#" class="mobile-menu-link contact-modal-trigger" data-translate-key="heroCtaContact">Contact Me</a>
        </div>
    </div>

    <div id="search-modal">
        <button id="search-close-btn" title="Close Search" data-translate-title="tooltipModalClose">
            <svg class="w-8 h-8" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
            </svg>
        </button>
        <div class="search-content">
            <form id="search-form">
                <input type="search" id="search-input" placeholder="اكتب للبحث..." autocomplete="off" data-translate-placeholder="searchPlaceholder">
            </form>
        </div>
    </div>

    <main class="container mx-auto px-6 content-hidden">
        <section id="hero" class="min-h-screen flex items-center justify-center relative pt-24 md:pt-0">
            <div class="relative z-10 w-full flex flex-col-reverse md:grid md:grid-cols-2 items-center gap-8 md:gap-12">
                
                <div class="text-center md:text-left">
                    <span class="block text-xl font-semibold text-violet-400 mb-2" id="hero-greeting" data-translate-key="heroGreeting">Hello, I'm</span>
                    <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-black text-white leading-tight">
                        <span class="gradient-text" data-translate-key="heroLine1">Badr</span><br><span data-translate-key="heroLine2">Ibraheem Mohameed</span>
                    </h1>
                    <h2 class="mt-4 text-lg sm:text-xl md:text-2xl font-medium text-gray-300 min-h-[50px]">
                        <span id="typing-effect"></span>
                    </h2>
                    <p class="mt-6 text-gray-400 max-w-lg mx-auto md:mx-0" data-translate-key="heroBio">
                        I combine design and code to build engaging digital experiences. Specializing in creating unique visual identities and interactive websites that captivate users.
                    </p>
                    
                    <div class="mt-8 flex justify-center md:justify-start items-center gap-x-1 sm:gap-x-2" id="hero-socials">
                        <a href="https://www.linkedin.com/in/bdremohameed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="LinkedIn" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
                        <a href="https://github.com/bdremohameed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="GitHub" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>
                        <a href="https://www.facebook.com/bdr.e.mohmed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="Facebook" title="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
                        <a href="https://www.instagram.com/bdr_e_mohamed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="Instagram" title="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg></a>
                        <a href="https://www.behance.net/bdremohameed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="Behance" title="Behance"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15.44 9.17h5.48V6.26h-5.48zM8.75 11.5c1.47 0 2.5-1.03 2.5-2.5s-1.03-2.5-2.5-2.5-2.5 1.03-2.5 2.5 1.03 2.5 2.5 2.5zM15.44 17.74h5.48v-2.91h-5.48zM8.75 18.02c1.47 0 2.5-1.03 2.5-2.5s-1.03-2.5-2.5-2.5-2.5 1.03-2.5 2.5 1.03 2.5 2.5 2.5zM3.02 12.27h3.94v-1H3.02z"/></svg></a>
                    </div>

                    <div class="mt-8 flex flex-col sm:flex-row items-center justify-center md:justify-start gap-4" id="hero-ctas">
                        <a href="#projects" class="view-work-btn group w-full sm:w-auto justify-center">
                            <span data-translate-key="heroCtaViewWork">View My Work</span>
                            <svg class="ml-2 w-5 h-5 transition-transform duration-300 group-hover:rotate-[-45deg]" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                                <polyline points="15 3 21 3 21 9"/>
                                <line x1="10" y1="14" x2="21" y2="3"/>
                            </svg>
                        </a>
                        <a href="#store" class="store-btn group w-full sm:w-auto justify-center" id="hero-store-btn">
                             <svg class="mr-2 w-5 h-5 transition-transform duration-300 group-hover:scale-110" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line><path d="M16 10a4 4 0 0 1-8 0"></path></svg>
                            <span data-translate-key="navStore">Store</span>
                        </a>
                    </div>
                    <div class="mt-8 flex justify-center md:justify-start items-center gap-2 text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                        <span class="text-sm font-medium"><span id="visitor-count">...</span>&nbsp;<span data-translate-key="visitorsText">Website visitors</span></span>
                    </div>
                </div>

                 <div id="hero-image-container" class="relative flex justify-center items-center">
                    <div class="relative w-full max-w-md md:max-w-lg lg:max-w-xl flex justify-center items-center">
                         <div class="hero-image-glow absolute w-[80%] h-[80%] rounded-full opacity-70"></div>
                         <div class="relative z-10 w-60 h-60 sm:w-80 sm:h-80 md:w-[420px] md:h-[420px] rounded-full overflow-hidden shadow-2xl ring-4 ring-white/10">
                            <img id="profile-picture-img" src="https://badre.site/images/50.webp"
                                 data-dark-src="https://badre.site/images/50.webp"
                                 data-light-src="https://i.ibb.co/N6dQBv1/IMG-20240621-WA0010.jpg"
                                 alt="Badr Ibraheem Mohameed personal photo" class="w-full h-full object-cover opacity-95 transition-opacity duration-300" loading="lazy" width="420" height="420">
                         </div>
                    </div>
                </div>

            </div>
        </section>

        
        <section id="skills" class="py-12 sm:py-16">
            <h3 class="text-3xl sm:text-4xl font-bold text-center mb-12 gsap-reveal gradient-text" data-translate-key="skillsTitle">Core Competencies</h3>
            <div class="max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8">
                
                <div class="space-y-6">
                    <h4 class="text-2xl font-bold text-center md:text-left gradient-text">Design & Creative</h4>
                    
                    <div class="skill-card glass-card gsap-reveal">
                        <div class="skill-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.53 16.122a3 3 0 00-5.78 1.128 2.25 2.25 0 01-2.4 2.245 4.5 4.5 0 008.4-2.245c0-.399-.078-.78-.22-1.128zm0 0a15.998 15.998 0 003.388-1.62m-5.043-.025a15.998 15.998 0 011.622-3.385m5.043.025a15.998 15.998 0 001.622-3.385m3.388 1.62a15.998 15.998 0 00-1.622-3.385m-5.043.025a15.998 15.998 0 01-3.388-1.621m7.849 14.742a15.998 15.998 0 00-3.388-1.622m-5.043-.025a15.998 15.998 0 01-1.622-3.385m5.043.025a15.998 15.998 0 00-1.622-3.385m-3.388 1.62a15.998 15.998 0 001.622-3.385m-7.849-1.47a15.998 15.998 0 013.388-1.622m5.043.025a15.998 15.998 0 003.388 1.622m7.849 14.742a15.998 15.998 0 001.622-3.385m-5.043-.025a15.998 15.998 0 011.622-3.385m3.388 1.62a15.998 15.998 0 00-1.622-3.385m-5.043.025a15.998 15.998 0 01-3.388-1.622m7.849 14.742a15.998 15.998 0 00-3.388-1.622m-5.043-.025a15.998 15.998 0 01-1.622-3.385m-3.388 1.62a15.998 15.998 0 001.622-3.385"/></svg>
                        </div>
                        <div class="skill-details">
                            <h5 class="skill-name">Branding & Identity</h5>
                            <p class="skill-desc" data-translate-key="skillBrandDesc">Logos, Style Guides, Visual Systems</p>
                        </div>
                    </div>
                     <div class="skill-card glass-card gsap-reveal">
                        <div class="skill-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 006 3.75v16.5a2.25 2.25 0 002.25 2.25h7.5A2.25 2.25 0 0018 20.25V3.75a2.25 2.25 0 00-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" /></svg>
                        </div>
                        <div class="skill-details">
                            <h5 class="skill-name">UI/UX Design</h5>
                            <p class="skill-desc" data-translate-key="skillUiUxDesc">Websites, Mobile Apps, Prototypes</p>
                        </div>
                    </div>
                     <div class="skill-card glass-card gsap-reveal">
                        <div class="skill-icon">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" /></svg>
                        </div>
                        <div class="skill-details">
                            <h5 class="skill-name">3D Modeling</h5>
                            <p class="skill-desc" data-translate-key="skill3dDesc">Blender, 3D Rendering</p>
                        </div>
                    </div>
                </div>

                <div class="space-y-6">
                    <h4 class="text-2xl font-bold text-center md:text-left gradient-text">Software & Technical</h4>
                     <div class="skill-card glass-card gsap-reveal">
                        <div class="skill-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 7.5l3 2.25-3 2.25m4.5 0h3m-9 8.25h13.5A2.25 2.25 0 0021 18V6a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 6v12a2.25 2.25 0 002.25 2.25z" /></svg>
                        </div>
                        <div class="skill-details">
                            <h5 class="skill-name">HTML & CSS</h5>
                            <p class="skill-desc" data-translate-key="skillHtmlCssDesc">Responsive Web Layouts</p>
                        </div>
                    </div>
                     <div class="skill-card glass-card gsap-reveal">
                        <div class="skill-icon">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 6h9.75M10.5 6a1.5 1.5 0 11-3 0m3 0a1.5 1.5 0 10-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 01-3 0m3 0a1.5 1.5 0 00-3 0m-9.75 0h9.75" /></svg>
                        </div>
                        <div class="skill-details">
                            <h5 class="skill-name">JavaScript</h5>
                             <p class="skill-desc" data-translate-key="skillJsDesc">Interactive Web Elements</p>
                        </div>
                    </div>
                    <div class="skill-card glass-card gsap-reveal">
                        <div class="skill-icon">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5" /></svg>
                        </div>
                        <div class="skill-details">
                            <h5 class="skill-name">Microsoft Office</h5>
                            <p class="skill-desc" data-translate-key="skillOfficeDesc">Word, PowerPoint, Excel</p>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="experience" class="py-12 sm:py-16 overflow-hidden">
            <h3 class="text-3xl sm:text-4xl font-bold text-center mb-12 gsap-reveal gradient-text" data-translate-key="experienceTitle">Experience & Training</h3>
            <div id="experience-horizontal-timeline" class="max-w-5xl mx-auto">
                <div id="timeline-nav" class="flex justify-center mb-8 gap-2 md:gap-4 flex-wrap">
                </div>
                <div id="timeline-content-cards" class="relative min-h-[200px] md:min-h-[150px]">
                </div>
            </div>
        </section>

        <section id="education" class="py-12 sm:py-16">
            <h3 class="text-3xl sm:text-4xl font-bold text-center mb-12 gsap-reveal gradient-text" data-translate-key="educationTitle">Education & Certifications</h3>
             <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                 <div class="glass-card p-6 md:p-8 rounded-2xl gsap-reveal">
                     <h4 class="text-2xl font-bold mb-4 md:text-left" data-translate-key="educationSubTitle">Education</h4>
                     <p class="font-semibold text-white" data-translate-key="educationDegree">Bachelor of Tourism and Hotels</p>
                     <p class="text-gray-400" data-translate-key="educationDepartment">Hospitality Management Department</p>
                     <p class="text-sm text-gray-500" data-translate-key="educationInstitute">Higher Institute of Tourism and Hotels - Graduated June 2025</p>
                 </div>
                 <div class="glass-card p-6 md:p-8 rounded-2xl gsap-reveal">
                    <h4 class="text-2xl font-bold mb-4 md:text-left" data-translate-key="languagesSubTitle">Languages</h4>
                    <p data-translate-key="languageArabic"><span class="font-semibold text-white">Arabic:</span> <span class="text-gray-400">Native</span></p>
                    <p data-translate-key="languageEnglish"><span class="font-semibold text-white">English:</span> <span class="text-gray-400">Intermediate Proficiency</span></p>
                </div>
             </div>
        </section>

        <section id="certificates" class="py-12 sm:py-16">
            <div class="text-center">
                <h3 class="text-3xl sm:text-4xl font-bold mb-4 gsap-reveal gradient-text" data-translate-key="certificatesTitle">Certificates & Awards</h3>
                <p class="max-w-2xl mx-auto text-gray-400 mb-12 leading-relaxed gsap-reveal" data-translate-key="certificatesDesc">
                    A collection of my professional certifications and recognitions.
                </p>
            </div>
            <div class="relative max-w-5xl mx-auto h-[300px] md:h-[380px] flex items-center justify-center">
                 <div id="certificates-slider-container" class="relative w-full h-full">
                    <!-- Certificates will be injected here by JS -->
                </div>
                <button id="prev-certificate-slide" class="slider-btn absolute top-1/2 -translate-y-1/2 left-0 sm:-left-4 z-30 disabled" aria-label="Previous Certificate">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg>
                </button>
                <button id="next-certificate-slide" class="slider-btn absolute top-1/2 -translate-y-1/2 right-0 sm:-right-4 z-30 disabled" aria-label="Next Certificate">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" /></svg>
                </button>
            </div>
            <div id="add-certificate-container" class="text-center mt-12 hidden">
                <button id="add-certificate-btn" class="submit-btn group">
                    <span data-translate-key="addCertificateBtn">Add New Certificate</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 ml-2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                </button>
            </div>
        </section>

        <section id="projects" class="py-12 sm:py-16 relative">
            <div class="text-center">
                <h3 class="text-3xl sm:text-4xl font-bold mb-4 gsap-reveal gradient-text" data-translate-key="projectsTitle">My Projects</h3>
                <p class="max-w-2xl mx-auto text-gray-400 mb-12 leading-relaxed gsap-reveal" data-translate-key="projectsDesc">
                    A selection of my recent work. Hover over a project to see more details and click "View Details" to see the full case study.
                </p>
            </div>
            
            <div id="project-filters-wrapper" class="w-full max-w-5xl mx-auto mb-10 overflow-hidden relative" style="mask-image: linear-gradient(to right, transparent 0%, black 10%, black 90%, transparent 100%); -webkit-mask-image: linear-gradient(to right, transparent 0%, black 10%, black 90%, transparent 100%);">
                <div id="project-filters" class="flex flex-nowrap gap-3">
                </div>
            </div>

            <div class="relative max-w-7xl mx-auto">
                <div id="projects-slider-container">
                    <div id="projects-grid" class="flex items-center">
                    </div>
                </div>
                <button id="prev-slide" class="slider-btn left-2 md:-left-6" title="Previous" data-translate-title="tooltipSliderPrev" aria-label="Previous Project">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg>
                </button>
                <button id="next-slide" class="slider-btn right-2 md:-right-6" title="Next" data-translate-title="tooltipSliderNext" aria-label="Next Project">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" /></svg>
                </button>
            </div>
            <div id="add-project-container" class="text-center mt-8">
                <button id="add-project-btn" class="submit-btn group">
                    <span data-translate-key="addProjectBtn">Add New Project</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 ml-2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                </button>
            </div>
        </section>

        <section id="blog" class="py-12 sm:py-16">
            <div class="text-center">
                <h3 class="text-3xl sm:text-4xl font-bold mb-4 gsap-reveal gradient-text" data-translate-key="blogTitle">From the Blog</h3>
                <p class="max-w-2xl mx-auto text-gray-400 mb-12 leading-relaxed gsap-reveal" data-translate-key="blogDesc">
                    Sharing insights, tips, and tutorials on design, development, and creative technology.
                </p>
            </div>

            <div class="relative max-w-7xl mx-auto">
                <div id="articles-slider-container" class="flex overflow-x-auto snap-x snap-mandatory py-4 -mx-6 px-6">
                    <div id="articles-grid" class="flex-none flex gap-8">
                    </div>
                </div>
                <button id="prev-article-slide" class="slider-btn left-2 md:-left-6" title="Previous Article" aria-label="Previous Article">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" /></svg>
                </button>
                <button id="next-article-slide" class="slider-btn right-2 md:-right-6" title="Next Article" aria-label="Next Article">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" /></svg>
                </button>
            </div>

            <div id="add-article-container" class="text-center mt-12 hidden">
                <button id="add-article-btn" class="submit-btn group">
                    <span data-translate-key="addArticleBtn">Write New Article</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 ml-2"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>
                </button>
            </div>
        </section>

        <section id="testimonials" class="py-12 sm:py-16">
            <h3 class="text-3xl sm:text-4xl font-bold text-center mb-12 gsap-reveal gradient-text" data-translate-key="testimonialsTitle">What Clients Say</h3>
            <div class="relative max-w-3xl mx-auto">
                <div id="testimonial-slider" class="w-full">
                </div>
                <div id="testimonial-dots" class="flex justify-center gap-3 mt-8">
                </div>
            </div>

            <div id="comment-section-wrapper" class="max-w-xl mx-auto gsap-reveal mt-20">
                <form id="comment-form">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 pt-2">
                            <img id="comment-avatar" src="https://badre.site/images/50.webp" alt="Your avatar">
                        </div>
                        <div class="w-full space-y-4">
                            <div>
                                <label for="comment-message" class="sr-only">Your Comment</label>
                                <textarea id="comment-message" name="message" rows="1" placeholder="Leave a reply..." required class="form-input transition-all duration-300 resize-none"></textarea>
                            
                                <div id="comment-form-collapsible" class="overflow-hidden">
                                    <div class="space-y-4 pt-4">
                                            <div>
                                                <label class="form-label text-center block mb-2">Your Rating</label>
                                                <div id="comment-rating-input">
                                                    <input type="radio" id="star5" name="rating" value="5" required><label for="star5" title="5 stars"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg></label>
                                                    <input type="radio" id="star4" name="rating" value="4"><label for="star4" title="4 stars"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg></label>
                                                    <input type="radio" id="star3" name="rating" value="3"><label for="star3" title="3 stars"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg></label>
                                                    <input type="radio" id="star2" name="rating" value="2"><label for="star2" title="2 stars"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg></label>
                                                    <input type="radio" id="star1" name="rating" value="1"><label for="star1" title="1 star"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg></label>
                                                </div>
                                            </div>
                                            <div>
                                            <label for="comment-name" class="sr-only">Your Name</label>
                                            <input type="text" id="comment-name" name="name" placeholder="Your Name" required class="form-input">
                                        </div>
                                        <div class="flex justify-end items-center gap-4">
                                            <button type="button" id="cancel-comment-btn" class="secondary-btn !py-2 !px-4 !text-sm">Cancel</button>
                                            <button type="submit" id="submit-comment-btn" class="submit-btn group">
                                                <span data-translate-key="postCommentBtn">Post Comment</span>
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 ml-2 transition-transform duration-300 group-hover:translate-x-1"><path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"></path></svg>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div id="comment-status" class="text-center mt-4 h-6 max-w-3xl mx-auto"></div>
        </section>

        <section id="cta" class="gsap-reveal">
            <div class="glass-card p-6 sm:p-8 text-center flex flex-col sm:flex-row items-center justify-center gap-2 sm:gap-4">
                <h3 class="text-xl sm:text-2xl font-bold text-white" data-translate-key="ctaTitle">Interested in working together?</h3>
                <p class="text-gray-300" data-translate-key="ctaSubtitle">Let's start a conversation.</p>
            </div>
        </section>
    </main>

    <section id="project-detail-view" class="hidden min-h-screen py-20">
        <div class="container mx-auto px-6">
            <button id="back-to-home-btn" class="secondary-btn mb-8 inline-flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                <span data-translate-key="backToHomeBtn">Back to Home</span>
            </button>
            <div id="project-detail-content" class="max-w-6xl mx-auto">
            </div>
        </div>
    </section>

    <section id="article-detail-view" class="hidden min-h-screen py-20">
        <div class="container mx-auto px-6">
            <div class="flex justify-between items-center mb-8">
                <button id="back-to-home-from-article-btn" class="secondary-btn inline-flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                    <span data-translate-key="backToHomeBtn">Back to Home</span>
                </button>
                <div id="article-detail-admin-controls" class="gap-2">
                </div>
            </div>
            <div id="article-detail-content" class="max-w-screen-xl mx-auto">
            </div>
        </div>
    </section>

    <section id="search-results-view" class="hidden min-h-screen py-20 sm:py-24">
        <div class="container mx-auto px-6">
            <div class="max-w-4xl mx-auto">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-10">
                    <div>
                         <h2 class="text-3xl sm:text-4xl font-bold gradient-text">Search Results</h2>
                         <p id="search-query-display" class="text-gray-400 mt-2">Results for your query will appear here.</p>
                    </div>
                    <button id="close-search-btn" class="secondary-btn inline-flex items-center gap-2 mt-4 sm:mt-0">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                        <span data-translate-key="tooltipModalClose">Close</span>
                    </button>
                </div>
                <div id="search-results-content">
                    <div id="ai-search-answer" class="mb-12"></div>
                    <div id="keyword-search-results"></div>
                </div>
            </div>
        </div>
    </section>

    <section id="store-view" class="hidden min-h-screen py-20">
        <div class="container mx-auto px-6">
            <div class="flex justify-between items-center mb-8">
                 <h2 class="text-3xl sm:text-4xl font-bold gradient-text" data-translate-key="navStore">Store</h2>
                <button id="close-store-btn" class="secondary-btn inline-flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    <span>Close</span>
                </button>
            </div>
            <div id="store-content" class="max-w-7xl mx-auto">
                <div id="products-grid-store" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                </div>
                 <div id="add-product-container" class="text-center mt-12">
                    <button id="add-product-btn" class="submit-btn group">
                        <span data-translate-key="addProductBtn">Add New Product</span>
                        <svg xmlns="http://www.w.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 ml-2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                    </button>
                </div>
            </div>
        </div>
    </section>

    <section id="product-detail-view" class="hidden min-h-screen py-20">
        <div class="container mx-auto px-6">
            <div class="flex justify-between items-center mb-8">
                <button id="back-to-store-btn" class="secondary-btn inline-flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                    <span>Back to Store</span>
                </button>
            </div>
            <div id="product-detail-content" class="max-w-7xl mx-auto">
            </div>
        </div>
    </section>

    <div id="product-admin-modal" class="modal-hidden fixed inset-0 z-[70] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm product-admin-modal-overlay-bg"></div>
        <div class="relative w-11/12 max-w-2xl project-modal-content glass-card rounded-2xl p-6 md:p-8 z-10 max-h-[90vh] overflow-y-auto">
            <button id="close-product-admin-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors" aria-label="Close">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h3 id="product-admin-modal-title" class="text-2xl font-bold mb-6">Add New Product</h3>
            <form id="product-admin-form" class="space-y-6">
                <input type="hidden" id="product-admin-id" name="id">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="product-admin-name" class="form-label">Product Name</label>
                        <input type="text" id="product-admin-name" name="name" required class="form-input">
                    </div>
                    <div>
                        <label for="product-admin-category" class="form-label">Category</label>
                        <input type="text" id="product-admin-category" name="category" required class="form-input">
                    </div>
                </div>
                <div>
                    <label for="product-admin-tags" class="form-label">Tags</label>
                    <input type="text" id="product-admin-tags" name="tags" placeholder="e.g. design, template, 3d" class="form-input">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="md:col-span-2">
                        <label for="product-admin-price" class="form-label">Price</label>
                        <input type="number" id="product-admin-price" name="price" required class="form-input">
                    </div>
                    <div>
                        <label for="product-admin-currency" class="form-label">Currency</label>
                        <select id="product-admin-currency" name="currency" class="form-input">
                            <option value="EGP">EGP</option>
                            <option value="USD">USD</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label for="product-admin-description" class="form-label">Description</label>
                    <textarea id="product-admin-description" name="description" rows="4" required class="form-input"></textarea>
                </div>
                 <div>
                    <label for="product-admin-youtube" class="form-label">YouTube Video URL (Optional)</label>
                    <input type="url" id="product-admin-youtube" name="youtubeUrl" placeholder="https://www.youtube.com/watch?v=..." class="form-input">
                </div>
                <div>
                    <label for="product-admin-media" class="form-label">Image URLs</label>
                    <textarea id="product-admin-media" name="media" rows="4" placeholder="Enter one image URL per line." class="form-input"></textarea>
                </div>
                <div class="text-center pt-4">
                    <button type="submit" class="submit-btn group w-full sm:w-auto justify-center px-8 py-3">
                        <span id="product-admin-submit-btn-text">Save Product</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="cv-view">
        <div class="cv-container">
            <header class="cv-header flex-shrink-0 flex justify-between items-center p-4 border-b border-[var(--border-primary)]">
                <h2 class="text-xl sm:text-2xl font-bold gradient-text flex items-center gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                    <span data-translate-key="cvTitle">Curriculum Vitae</span>
                </h2>
                <div class="cv-actions flex items-center gap-2">
                    <a href="#" id="download-cv-btn" class="secondary-btn !py-1.5 !px-3 !text-sm" download>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="mr-1.5"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        <span data-translate-key="downloadCvBtn">Download</span>
                    </a>
                    <button id="close-cv-btn" class="nav-link !p-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                    </button>
                </div>
            </header>
            <div class="cv-content-wrapper">
                <div class="cv-grid">
                    <aside class="cv-sidebar">
                        <div class="text-center mb-8">
                            <img id="cv-profile-picture-img" src="https://badre.site/images/50.webp" alt="Badr Ibraheem" class="w-32 h-32 rounded-full mx-auto mb-4 ring-4 ring-[var(--accent-color)] p-1">
                            <h1 class="text-2xl font-bold" data-translate-key="cvName">Badr Ibraheem</h1>
                            <p class="gradient-text font-semibold" data-translate-key="cvJobTitle">Graphic & Software Designer</p>
                        </div>
                        <div class="space-y-6">
                            <div>
                                <h3 class="font-bold text-lg mb-2 border-b-2 border-[var(--accent-color)] pb-1 inline-block" data-translate-key="cvContactTitle">Contact</h3>
                                <ul class="space-y-2 text-sm">
                                    <li class="flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg><a href="mailto:badr.e.mohameed@gmail.com" class="hover:text-[var(--accent-color)]">badr.e.mohameed@gmail.com</a></li>
                                    <li class="flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg><a href="tel:+201069913150" class="hover:text-[var(--accent-color)]">+20 106 991 3150</a></li>
                                    <li class="flex items-center gap-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg><span data-translate-key="cvLocation">Faiyum, Egypt</span></li>
                                </ul>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg mb-2 border-b-2 border-[var(--accent-color)] pb-1 inline-block" data-translate-key="cvSkillsTitle">Skills</h3>
                                <div class="flex flex-wrap gap-2 text-sm">
                                    <span class="bg-white/10 px-3 py-1 rounded-full" data-translate-key="cvSkillAdobe">Adobe Suite</span>
                                    <span class="bg-white/10 px-3 py-1 rounded-full" data-translate-key="cvSkill3D">3D Design</span>
                                    <span class="bg-white/10 px-3 py-1 rounded-full" data-translate-key="cvSkillUIUX">UI/UX</span>
                                    <span class="bg-white/10 px-3 py-1 rounded-full" data-translate-key="skillOffice">Microsoft Office</span>
                                    <span class="bg-white/10 px-3 py-1 rounded-full" data-translate-key="cvSkillHTML">HTML & CSS</span>
                                    <span class="bg-white/10 px-3 py-1 rounded-full" data-translate-key="cvSkillJS">JavaScript</span>
                                </div>
                            </div>
                             <div>
                                <h3 class="font-bold text-lg mb-2 border-b-2 border-[var(--accent-color)] pb-1 inline-block" data-translate-key="languagesSubTitle">Languages</h3>
                                <p class="text-sm"><strong data-translate-key="cvLangArabicLabel">Arabic:</strong> <span data-translate-key="cvLangArabicLevel">Native</span></p>
                                <p class="text-sm"><strong data-translate-key="cvLangEnglishLabel">English:</strong> <span data-translate-key="cvLangEnglishLevel">Intermediate</span></p>
                            </div>
                        </div>
                    </aside>
                    <main>
                        <section class="mb-8">
                            <h2 class="text-2xl font-bold mb-4 border-l-4 border-[var(--accent-color)] pl-4" data-translate-key="cvSummaryTitle">Summary</h2>
                            <p class="text-gray-400" data-translate-key="cvSummaryContent">
                                Creative graphic designer and software developer from Faiyum, Egypt with over 3 years of experience in print and digital advertising. Skilled in using 3D elements, Adobe Creative Suite, and modern web technologies to deliver high-quality, impactful visual projects and user experiences.
                            </p>
                        </section>
                        <section class="mb-8">
                            <h2 class="text-2xl font-bold mb-6 border-l-4 border-[var(--accent-color)] pl-4" data-translate-key="experienceTitle">Experience</h2>
                            <div class="relative border-l-2 border-[var(--border-primary)] ml-3 pl-8 space-y-8">
                                 <div class="timeline-item-cv">
                                    <h3 class="font-bold" data-translate-key="exp5Title">Graphic Designer & E-Marketer</h3>
                                    <p class="text-sm text-gray-400" data-translate-key="exp5Meta">2025 - Present | Jedar Decor Exhibition, Egypt</p>
                                    <ul class="list-disc pl-5 mt-2 text-gray-400 text-sm space-y-1">
                                        <li data-translate-key="cvExp5Point1">Handling graphic design, e-marketing, and sales responsibilities.</li>
                                    </ul>
                                </div>
                                 <div class="timeline-item-cv">
                                    <h3 class="font-bold" data-translate-key="exp1Title">Hotel Marketing Intern</h3>
                                    <p class="text-sm text-gray-400" data-translate-key="exp1Meta">Dec 2024 – Feb 2025 | 6th of October City, Giza</p>
                                    <ul class="list-disc pl-5 mt-2 text-gray-400 text-sm space-y-1">
                                        <li data-translate-key="cvExp1Point1">Supported marketing initiatives, including creating content for social media.</li>
                                        <li data-translate-key="cvExp1Point2">Assisted with market research and analysis to guide marketing strategies.</li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                         <section class="mb-8">
                            <h2 class="text-2xl font-bold mb-6 border-l-4 border-[var(--accent-color)] pl-4" data-translate-key="educationTitle">Education</h2>
                             <div class="relative border-l-2 border-[var(--border-primary)] ml-3 pl-8 space-y-8">
                                <div class="timeline-item-cv">
                                    <h3 class="font-bold" data-translate-key="educationDegree">Bachelor of Tourism and Hotels</h3>
                                    <p class="text-sm text-gray-400"><span data-translate-key="educationInstitute">Higher Institute of Tourism and Hotels</span> - <span data-translate-key="cvEducationDate">Graduated June 2025</span></p>
                                </div>
                            </div>
                        </section>
                        <section>
                            <h2 class="text-2xl font-bold mb-6 border-l-4 border-[var(--accent-color)] pl-4" data-translate-key="cvCoursesTitle">Courses & Training</h2>
                             <div class="relative border-l-2 border-[var(--border-primary)] ml-3 pl-8 space-y-8">
                                 <div class="timeline-item-cv">
                                    <h3 class="font-bold" data-translate-key="exp2Title">Graphic Designer Course</h3>
                                    <p class="text-sm text-gray-400" data-translate-key="exp2Meta">Jan 2021 – Feb 2022 | Adobe, Nasr City</p>
                                </div>
                                <div class="timeline-item-cv">
                                    <h3 class="font-bold" data-translate-key="exp6Title">Inflight Food and Beverage Service</h3>
                                    <p class="text-sm text-gray-400" data-translate-key="exp6Meta">2023 | Higher Institute of Tourism and Hotels, 6th of October</p>
                                </div>
                            </div>
                        </section>
                    </main>
                </div>
            </div>
        </div>
    </div>

    <button id="contact-fab-btn" class="fixed bottom-6 right-6 md:bottom-8 md:right-8 z-50 cta-btn group" aria-label="Get in touch" title="Get in touch" data-translate-title="tooltipFabContact">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7 transition-transform duration-300 group-hover:scale-110"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
    </button>
    
    <button id="chat-fab-btn" class="fixed bottom-6 left-6 md:bottom-8 md:left-8 z-50 cta-btn group" aria-label="Open Chatbot" title="Open Chatbot" data-translate-title="tooltipChatbot">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7 transition-transform duration-300 group-hover:scale-110"><path d="M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2z"></path></svg>
    </button>
    <div id="chat-widget" class="glass-card">
        <div class="chat-header flex justify-between items-center border-b border-white/10">
            <div>
                <h3 class="font-bold text-lg">Badr's Assistant</h3>
                <p class="text-xs text-gray-400">Powered by Gemini AI</p>
            </div>
            <button id="close-chat-btn" class="p-2 -mr-2 text-gray-400 hover:text-white" title="Close chat" data-translate-title="tooltipModalClose">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <div id="chat-messages">
        </div>
        <form id="chat-form">
            <div class="relative">
                <input type="text" id="chat-input" placeholder="Ask about projects, skills..." class="form-input w-full">
                <button type="submit" id="chat-send-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"></path></svg>
                </button>
            </div>
        </form>
    </div>

    <div id="login-modal" class="modal-hidden fixed inset-0 z-[80] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm login-modal-overlay-bg"></div>
    
        <div class="relative w-11/12 max-w-sm login-modal-content rounded-2xl p-6 sm:p-8 z-10">
            <button id="close-login-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors z-20" aria-label="Close" title="Close" data-translate-title="tooltipModalClose">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
    
            <div class="text-center relative z-10">
                 <div class="flex justify-center mb-6">
                    <div class="w-14 h-14 rounded-full flex items-center justify-center bg-white/5 ring-2 ring-white/10 overflow-hidden">
                         <img src="https://badre.site/images/50.webp" alt="Badr Ibraheem profile picture" class="w-full h-full object-cover" loading="lazy">
                    </div>
                 </div>
                 <h3 class="text-3xl font-bold mb-2">Badr Ibrahee Mohamed</h3>
                 <p class="text-gray-400 mb-8">Sign in to manage your portfolio.</p>
            </div>
            
            <p id="login-error" class="text-red-400 text-sm text-center h-4 mb-4 relative z-10"></p>

            <button id="google-signin-btn" class="relative z-10 w-full flex justify-center items-center gap-3 font-semibold py-3 px-4 rounded-full transition-all duration-300">
                <svg class="w-5 h-5" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"></path><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"></path><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"></path><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"></path><path fill="none" d="M0 0h48v48H0z"></path></svg>
                Sign in with Google
            </button>

        </div>
    </div>
    
    <div id="project-modal" class="modal-hidden fixed inset-0 z-[70] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm project-modal-overlay-bg"></div>
    
        <div class="relative w-11/12 max-w-2xl project-modal-content glass-card rounded-2xl p-6 md:p-8 z-10 max-h-[90vh] overflow-y-auto">
            <button id="close-project-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors" aria-label="Close" title="Close" data-translate-title="tooltipModalClose">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
    
            <div class="text-left mb-8 flex items-center gap-4">
                <div class="w-12 h-12 rounded-lg bg-white/5 flex items-center justify-center">
                    <svg class="w-7 h-7 text-gold-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line></svg>
                </div>
                <div>
                    <h3 id="project-modal-title" class="text-2xl font-bold">Add Project</h3>
                    <p class="text-gray-400 text-sm">Fill in the details below to add a new project.</p>
                </div>
            </div>
            
            <form id="project-form" class="space-y-6">
                <input type="hidden" id="project-id" name="id">
                
                <div>
                    <label for="project-title" class="form-label">Project Title</label>
                    <input type="text" id="project-title" name="title" placeholder="e.g., Modern Branding Redesign" required class="form-input">
                </div>
                
                <div>
                    <label for="project-description" class="form-label">Short Description (for card)</label>
                    <textarea id="project-description" name="description" rows="3" placeholder="A brief, catchy description for the portfolio grid." required class="form-input"></textarea>
                </div>

                <div>
                    <label for="project-coverImageUrl" class="form-label">Cover Image URL</label>
                    <input type="url" id="project-coverImageUrl" name="coverImageUrl" placeholder="https://.../cover-image.jpg" required class="form-input">
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="project-url" class="form-label">Project Link (Behance, etc.)</label>
                        <input type="url" id="project-url" name="url" placeholder="https://behance.net/..." class="form-input">
                    </div>
                    <div>
                        <label for="project-downloadUrl" class="form-label">Download Link (Optional)</label>
                        <input type="url" id="project-downloadUrl" name="downloadUrl" placeholder="https://.../download.zip" class="form-input">
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="project-tools" class="form-label">Tools Used</label>
                        <input type="text" id="project-tools" name="tools" placeholder="Photoshop, Illustrator, GSAP" class="form-input">
                    </div>
                    <div>
                        <label for="project-tags" class="form-label">Tags / Categories</label>
                        <input type="text" id="project-tags" name="tags" placeholder="Branding, 3D, Web Design" class="form-input">
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="project-date" class="form-label">Completion Date</label>
                        <input type="date" id="project-date" name="date" class="form-input text-gray-400">
                    </div>
                     <div>
                        <label for="project-status" class="form-label">Project Status</label>
                        <select id="project-status" name="status" class="form-input">
                            <option value="Completed">Completed</option>
                            <option value="InProgress">In Progress</option>
                            <option value="Idea">Idea</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label for="project-additionalDetails" class="form-label">Full Project Details</label>
                    <textarea id="project-additionalDetails" name="additionalDetails" rows="5" placeholder="Detailed description for the project page..." class="form-input"></textarea>
                </div>

                <div>
                    <label for="project-gallery" class="form-label">Gallery Image URLs (one per line)</label>
                    <textarea id="project-gallery" name="gallery" rows="4" placeholder="https://.../image1.jpg&#10;https://.../image2.jpg&#10;https://.../image3.jpg" class="form-input"></textarea>
                </div>

                <div class="flex items-center gap-3 text-gray-300 pt-2">
                    <input type="checkbox" id="project-featured" name="featured" class="w-5 h-5 bg-transparent border-gray-600 rounded text-violet-500 focus:ring-violet-500">
                    <label for="project-featured">Mark as a Featured Project</label>
                </div>

                <div class="text-center pt-4">
                    <button type="submit" class="submit-btn group w-full sm:w-auto justify-center px-8 py-3">
                        <span id="project-submit-btn-text">Save Project</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="article-modal" class="modal-hidden fixed inset-0 z-[70] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm article-modal-overlay-bg"></div>
        <div class="relative w-11/12 max-w-3xl project-modal-content glass-card rounded-2xl p-6 md:p-8 z-10 max-h-[90vh] overflow-y-auto">
            <button id="close-article-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors" aria-label="Close" title="Close" data-translate-title="tooltipModalClose">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h3 id="article-modal-title" class="text-2xl font-bold mb-6">Write New Article</h3>
            <form id="article-form" class="space-y-6">
                <input type="hidden" id="article-id" name="id">
                <div>
                    <label for="article-title" class="form-label">Title</label>
                    <input type="text" id="article-title" name="title" placeholder="A catchy title for your article" required class="form-input">
                </div>
                <div>
                    <label for="article-coverImageUrl" class="form-label">Cover Image URL (Optional)</label>
                    <input type="url" id="article-coverImageUrl" name="coverImageUrl" placeholder="https://.../cover-image.jpg" class="form-input">
                </div>
                 <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="article-tags" class="form-label">Tags / Categories</label>
                        <input type="text" id="article-tags" name="tags" placeholder="Design, Tutorial, Tech" class="form-input">
                    </div>
                    <div>
                        <label for="article-direction" class="form-label">Content Direction</label>
                        <select id="article-direction" name="direction" class="form-input">
                            <option value="ltr">Left to Right (LTR)</option>
                            <option value="rtl">Right to Left (RTL)</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label for="article-content" class="form-label">Content</label>
                    <textarea id="article-content" name="content" rows="12" placeholder="Write your article content here..." required class="form-input font-mono text-sm"></textarea>
                    <div class="text-xs text-gray-400 mt-3 space-y-1 bg-white/5 p-3 rounded-lg">
                        <p class="font-bold text-gray-300 mb-1">Formatting Guide:</p>
                        <p><code class="text-violet-400"># Main Title</code> - Use for major sections</p>
                        <p><code class="text-violet-400">## Subtitle</code> - Use for subsections</p>
                        <p><code class="text-violet-400">- List item</code> - Use for bullet points</p>
                        <p>Leave an empty line between paragraphs.</p>
                    </div>
                </div>
                <div class="text-center pt-4">
                    <button type="submit" class="submit-btn group w-full sm:w-auto justify-center px-8 py-3">
                        <span id="article-submit-btn-text">Publish Article</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="contact-modal" class="modal-hidden fixed inset-0 z-[60] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm modal-overlay-bg"></div>
    
        <div class="relative w-11/12 max-w-md md:max-w-3xl bg-transparent rounded-2xl z-10 max-h-[85vh] flex flex-col">
            <button id="close-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors z-20" aria-label="Close" title="Close" data-translate-title="tooltipModalClose">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            
            <div class="grid md:grid-cols-5 glass-card rounded-2xl overflow-y-auto">
                <div class="md:col-span-2 p-4 md:p-8 text-white">
                    <div class="flex items-center gap-3 mb-2">
                        <div class="w-10 h-10 rounded-lg bg-white/5 flex items-center justify-center flex-shrink-0">
                            <svg class="w-6 h-6 text-gold-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" /></svg>
                        </div>
                        <h3 class="text-2xl md:text-3xl font-bold gradient-text" data-translate-key="contactTitle">Get In Touch</h3>
                    </div>
                    <p class="text-gray-300 mb-6 text-sm" data-translate-key="contactDesc">Fill up the form and I will get back to you within 24 hours.</p>
                    
                    <div class="space-y-4">
                        <div class="flex items-start gap-3 text-left">
                            <div class="bg-white/5 p-2 rounded-full text-[#25D366] mt-1">
                                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 4.316 1.905 6.03l-.419 1.533 1.519-.4zM9.5 14.5c-.042-.124-.125-.195-.27-.295-.145-.1-.315-.148-.43-.153s-.24-.008-.344.092c-.105.1-.33.34-.438.465-.108.125-.216.25-.324.375s-.24.165-.368.125c-.128-.04-.547-.21-1.046-.595s-.863-.835-1.19-1.16c-.27-.27-.504-.635-.504-.975s.25-.56.375-.75c.125-.19.25-.31.375-.435s.125-.24.062-.375c-.062-.125-.562-1.345-.75-1.845-.19-.5-.375-.435-.5-.435s-.24-.008-.344.092c-.105.1-.33.34-.438.465s-.33.375-.438.635c-.108.25-.165.56-.165.875s.125 1.19.25 1.435c.125.25.562.935 1.312 1.688s1.438 1.19 2.188 1.5s1.19.438 1.562.438c.312 0 .562-.062.75-.125s.562-.625.625-.75c.062-.125.062-.25.062-.31s-.062-.125-.125-.19c-.062-.062-.24-.125-.312-.19s-.125-.125-.125-.19c0-.062-.042-.125-.062-.165z"/></svg>
                            </div>
                            <div>
                                <h4 class="font-semibold text-base text-white" data-translate-key="phoneTitle">WhatsApp</h4>
                                <a href="https://wa.me/201069913150" target="_blank" rel="noopener noreferrer" class="block text-sm text-gray-300 hover:text-white transition-colors">+20 106 991 3150</a>
                                <a href="https://wa.me/201112162908" target="_blank" rel="noopener noreferrer" class="block text-sm text-gray-300 hover:text-white transition-colors mt-1">+20 111 216 2908</a>
                            </div>
                        </div>
                         <a href="mailto:badr.e.mohameed@gmail.com" class="flex items-start gap-3 group text-left">
                            <div class="bg-white/5 p-2 rounded-full group-hover:bg-[var(--accent-color)] group-hover:text-[var(--background-dark)] transition-all duration-300 mt-1">
                                <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
                            </div>
                            <div>
                                <h4 class="font-semibold text-base text-white" data-translate-key="emailTitle">Email</h4>
                                <p class="text-sm text-gray-300 group-hover:text-white transition-colors break-all">badr.e.mohameed@gmail.com</p>
                            </div>
                        </a>
                    </div>

                    <div class="mt-6 pt-4 border-t border-white/10">
                         <h4 class="font-semibold text-base mb-3 text-white" data-translate-key="socialTitle">Follow Me</h4>
                         <div class="flex items-center gap-2">
                             <a href="https://www.linkedin.com/in/bdremohameed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="LinkedIn" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
                             <a href="https://github.com/bdremohameed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="GitHub" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>
                         </div>
                    </div>
                </div>

                <div class="md:col-span-3 p-4 md:p-8">
                    <form id="contact-form" action="https://formspree.io/f/mzzayzwe" method="POST" class="space-y-4">
                        <div>
                            <label for="contact-name" class="sr-only">Name</label>
                            <input type="text" id="contact-name" name="name" placeholder="Your Name" required class="form-input" data-translate-placeholder="formName">
                        </div>
                        <div>
                             <label for="contact-email" class="sr-only">Email</label>
                            <input type="email" id="contact-email" name="email" placeholder="Your Email" required class="form-input" data-translate-placeholder="formEmail">
                        </div>
                        <div>
                            <label for="contact-message" class="sr-only">Message</label>
                            <textarea id="contact-message" name="message" rows="4" placeholder="Your Message" required class="form-input" data-translate-placeholder="formMessage"></textarea>
                        </div>
                        <div class="pt-1">
                            <button type="submit" class="submit-btn group w-full justify-center">
                                <span data-translate-key="sendMessageBtn">Send Message</span>
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 ml-2 transition-transform duration-300 group-hover:translate-x-1"><path d="M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"></path></svg>
                            </button>
                        </div>
                    </form>
                    <div id="form-status" class="text-center mt-4 h-6"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="image-lightbox" class="modal-hidden fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-md lightbox-overlay"></div>
        <img id="lightbox-image" src="" alt="Full-size project image, enlarged view." class="relative max-w-full max-h-full rounded-lg z-10" loading="lazy">
        <button id="close-lightbox-btn" class="absolute top-6 right-6 text-white hover:text-gray-300 transition-colors z-20" aria-label="Close" title="Close" data-translate-title="tooltipModalClose">
             <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
        </button>
    </div>

    <div id="settings-modal" class="modal-hidden fixed inset-0 z-[70] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm settings-modal-overlay-bg"></div>
        <div class="relative w-11/12 max-w-lg project-modal-content glass-card rounded-2xl p-6 md:p-8 z-10 max-h-[90vh] overflow-y-auto">
            <button id="close-settings-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors" aria-label="Close">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h3 class="text-2xl font-bold mb-6">Profile Settings</h3>
            <form id="settings-form" class="space-y-6">
                <div>
                    <label for="light-mode-url" class="form-label">Light Mode Profile Picture URL</label>
                    <input type="url" id="light-mode-url" name="lightModeUrl" placeholder="https://..." required class="form-input">
                </div>
                 <div>
                    <label for="dark-mode-url" class="form-label">Dark Mode Profile Picture URL</label>
                    <input type="url" id="dark-mode-url" name="darkModeUrl" placeholder="https://..." required class="form-input">
                </div>
                <div class="border-t border-white/10 pt-6 mt-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <label for="maintenance-mode-toggle" class="form-label !mb-0">Maintenance Mode</label>
                            <p class="text-xs text-gray-400">Puts the site offline for all visitors.</p>
                        </div>
                        <label for="maintenance-mode-toggle" class="relative inline-flex items-center cursor-pointer">
                            <input type="checkbox" id="maintenance-mode-toggle" class="sr-only peer">
                            <div class="w-11 h-6 bg-gray-600 rounded-full peer peer-focus:ring-2 peer-focus:ring-violet-500 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-violet-600"></div>
                        </label>
                    </div>
                </div>
                <div id="settings-status" class="text-center h-5 text-sm"></div>
                <div class="text-center pt-4">
                    <button type="submit" class="submit-btn group w-full sm:w-auto justify-center px-8 py-3">
                        <span>Save Settings</span>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="certificate-gallery-modal" class="modal-hidden fixed inset-0 z-[100] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-md certificate-gallery-overlay"></div>
        <div class="relative w-full max-w-5xl h-full flex flex-col items-center justify-center">
            <img id="certificate-gallery-image" src="" alt="Full-size certificate image." class="relative max-w-full max-h-[85%] object-contain rounded-lg z-10">
            <p id="certificate-gallery-title" class="text-white text-lg font-bold mt-4"></p>
            <button id="close-certificate-gallery-btn" class="absolute top-6 right-6 text-white hover:text-gray-300 transition-colors z-20" aria-label="Close">
                 <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <button id="certificate-gallery-prev" class="absolute left-4 top-1/2 -translate-y-1/2 gallery-nav button text-white">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
            </button>
            <button id="certificate-gallery-next" class="absolute right-4 top-1/2 -translate-y-1/2 gallery-nav button text-white">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
            </button>
        </div>
    </div>

    <div id="certificate-modal" class="modal-hidden fixed inset-0 z-[70] flex items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/70 backdrop-blur-sm certificate-modal-overlay-bg"></div>
        <div class="relative w-11/12 max-w-lg project-modal-content glass-card rounded-2xl p-6 md:p-8 z-10 max-h-[90vh] overflow-y-auto">
            <button id="close-certificate-modal-btn" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors" aria-label="Close">
                 <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="w-7 h-7"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h3 id="certificate-modal-title" class="text-2xl font-bold mb-6">Add Certificate</h3>
            <form id="certificate-form" class="space-y-6">
                <input type="hidden" id="certificate-id" name="id">
                <div>
                    <label for="certificate-title" class="form-label">Certificate Title</label>
                    <input type="text" id="certificate-title" name="title" placeholder="e.g., Adobe Certified Expert" required class="form-input">
                </div>
                <div>
                    <label for="certificate-imageUrl" class="form-label">Image URL</label>
                    <input type="url" id="certificate-imageUrl" name="imageUrl" placeholder="https://.../certificate.jpg" required class="form-input">
                </div>
                <div class="text-center pt-4">
                    <button type="submit" class="submit-btn group w-full sm:w-auto justify-center px-8 py-3">
                        <span id="certificate-submit-btn-text">Save Certificate</span>
                    </button>
                </div>
            </form>
        </div>
    </div>


    <footer class="mt-20 border-t border-white/10 pt-12 pb-24 sm:pb-20">
        <div class="container mx-auto px-6 text-center text-gray-500">
            <div class="mb-8 flex justify-center items-center flex-wrap gap-x-2 sm:gap-x-4 gap-y-4">
                <a href="https://www.linkedin.com/in/bdremohameed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="LinkedIn" title="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
                <a href="https://github.com/bdremohameed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="GitHub" title="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a>
                <a href="https://www.facebook.com/bdr.e.mohmed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="Facebook" title="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
                <a href="https://www.instagram.com/bdr_e_mohamed" target="_blank" rel="noopener noreferrer" class="social-btn" aria-label="Instagram" title="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg></a>
            </div>
            <p data-translate-key="footerRights">&copy; 2025 Badr. All rights reserved.</p>
            <div id="admin-footer-controls" class="mt-4 text-center" style="display: none;">
                <button id="download-sitemap-btn" class="secondary-btn !text-sm">Download Sitemap</button>
            </div>
        </div>
    </footer>

            <script src="https://unpkg.com/gsap@3.12.5/dist/gsap.min.js"></script>
    <script src="https://unpkg.com/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, signOut, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, doc, getDoc, addDoc, updateDoc, deleteDoc, onSnapshot, serverTimestamp, query, orderBy, increment, setDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAscmJUPUyFwcE9fiYDNon6-YRM4Xgu1a4",
            authDomain: "website-me-7404b.firebaseapp.com",
            projectId: "website-me-7404b",
            storageBucket: "website-me-7404b.appspot.com",
            messagingSenderId: "436023684505",
            appId: "1:436023684505:web:e69745fac9c926d21cb708",
            measurementId: "G-W1HDBJFGV5"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        const projectsCollection = collection(db, 'projects');
        const articlesCollection = collection(db, 'articles');
        const certificatesCollection = collection(db, 'certificates');
        const productsCollection = collection(db, 'products');
        const siteStatusRef = doc(db, 'settings', 'site_status');
        const visitsRef = doc(db, 'settings', 'visits');

        const translations = {
            en: {
                navHome: 'Home', navSkills: 'Skills', navExperience: 'Experience', navProjects: 'Projects', navBlog: 'Blog', navCertificates: 'Certificates',
                heroLine1: 'Badr', heroLine2: 'Ibraheem Mohameed', heroLine3: 'Digital Experience Designer',
                heroGreeting: "Hello, I'm",
                heroBio: "I combine design and code to build engaging digital experiences. Specializing in creating unique visual identities and interactive websites that captivate users.",
                heroCtaViewWork: 'View My Work',
                heroCtaContact: 'Contact Me',
                aboutTitle: 'About Me',
                aboutParagraph: 'I am a creative graphic designer and software developer from Faiyum, Egypt with over 3 years of experience in print and digital advertising. I am skilled in using 3D elements and Microsoft Office tools, and I deliver high-quality designs on time. I am constantly striving to develop and contribute to impactful visual projects.',
                statYears: 'Years Experience',
                statProjects: 'Projects Completed',
                statClients: 'Happy Clients',
                technicalSkillsTitle: 'Technical Skills',
                skillAdobe: 'Adobe Creative Suite',
                skillOffice: 'Microsoft Office Suite',
                skillComputer: 'Computer Operations',
                skill3d: '3D & Visual Design',
                skillBrandDesc: "Logos, Style Guides, Visual Systems",
                skillUiUxDesc: "Websites, Mobile Apps, Prototypes",
                skill3dDesc: "Blender, 3D Rendering",
                skillHtmlCssDesc: "Responsive Web Layouts",
                skillJsDesc: "Interactive Web Elements",
                skillOfficeDesc: "Word, PowerPoint, Excel",
                personalSkillsTitle: 'Personal Skills',
                skillCommunication: 'Communication',
                skillTeamwork: 'Teamwork & Collaboration',
                skillAdaptable: 'Adaptable & Quick Learner',
                skillAttention: 'Attention to detail and high-quality work',
                skillProblemSolving: 'Creative Problem-Solving',
                skillsTitle: 'Core Competencies',
                experienceTitle: 'Experience & Training',
                educationTitle: 'Education & Certifications',
                exp1Title: 'Hotel Marketing Intern',
                exp1Meta: 'Dec 2024 – Feb 2025 | 6th of October City, Giza',
                exp1Desc: 'Supported marketing initiatives, including creating content for social media and other platforms. Assisted with market research and analysis to guide marketing strategies.',
                exp2Title: 'Graphic Designer Course',
                exp2Meta: 'Jan 2021 – Feb 2022 | Adobe, Nasr City',
                exp2Desc: 'Comprehensive training focused on graphic design principles, visual identity creation, and proficiency in the Adobe Creative Suite.',
                exp4Title: 'Assistant Chef Training',
                exp4Meta: '2019 | Holiday Inn, Nasr City',
                exp4Desc: 'Gained practical experience in kitchen operations and culinary assistance at a professional hotel.',
                exp5Title: 'Graphic Designer & E-Marketer',
                exp5Meta: '2025 - Present | Jedar Decor Exhibition, Egypt',
                exp5Desc: 'Responsible for graphic design, e-marketing, and sales activities for the exhibition.',
                exp6Title: 'Inflight Food and Beverage Service',
                exp6Meta: '2023 | Higher Institute of Tourism and Hotels, 6th of October',
                exp6Desc: 'Certified in the standards and procedures for inflight food and beverage service, in collaboration with EgyptAir.',
                projectsTitle: 'My Projects',
                projectsDesc: 'A selection of my recent work. Hover over a project to see more details and click "View Details" to see the full case study.',
                addProjectBtn: 'Add New Project',
                certificatesTitle: 'Certificates & Awards',
                certificatesDesc: 'A collection of my professional certifications and recognitions.',
                addCertificateBtn: 'Add New Certificate',
                testimonialsTitle: 'What Clients Say',
                blogTitle: 'From the Blog',
                blogDesc: 'Sharing insights, tips, and tutorials on design, development, and creative technology.',
                addArticleBtn: 'Write New Article',
                readMoreBtn: 'Read More',
                replyTitle: 'Leave a Reply',
                replyDesc: 'Your feedback is valuable and appreciated!',
                postCommentBtn: 'Post Comment',
                formName: 'Your Name',
                formEmail: 'Your Email',
                formMessage: 'Your Message',
                sendMessageBtn: 'Send Message',
                projectDetailAboutTitle: 'About This Project',
                projectDetailInfoTitle: 'Project Info',
                projectDetailDate: 'Date',
                projectDetailTools: 'Tools Used',
                projectDetailStatus: 'Status',
                projectDetailTags: 'Tags',
                projectDetailVisitBtn: 'Visit Project',
                projectDetailDownloadBtn: 'Download',
                backToHomeBtn: 'Back to Home',
                footerRights: '&copy; 2025 Badr. All rights reserved.',
                educationSubTitle: 'Education',
                educationDegree: 'Bachelor of Tourism and Hotels',
                educationDepartment: 'Hospitality Management Department',
                educationInstitute: 'Higher Institute of Tourism and Hotels - Graduated June 2025',
                languagesSubTitle: 'Languages',
                languageArabic: '<span class="font-semibold text-white">Arabic:</span> <span class="text-gray-400">Native</span>',
                languageEnglish: '<span class="font-semibold text-white">English:</span> <span class="text-gray-400">Intermediate Proficiency</span>',
                contactTitle: 'Get In Touch',
                contactDesc: 'Fill up the form and I will get back to you within 24 hours.',
                emailTitle: 'Email',
                socialTitle: 'Follow Me',
                cvTitle: "My CV",
                cvName: "Badr Ibraheem",
                cvJobTitle: "Graphic & Software Designer",
                cvContactTitle: "Contact",
                cvLocation: "Faiyum, Egypt",
                cvSkillsTitle: "Skills",
                ctaSubtitle: "Let's start a conversation.",
                cvTitle: "My CV",
                cvName: "Badr Ibraheem",
                cvJobTitle: "Graphic & Software Designer",
                cvContactTitle: "Contact",
                cvLocation: "Faiyum, Egypt",
                cvSkillsTitle: "Skills",
                cvSkillAdobe: "Adobe Suite",
                cvSkill3D: "3D Design",
                cvSkillUIUX: "UI/UX",
                cvSkillHTML: "HTML & CSS",
                cvSkillJS: "JavaScript",
                cvLangArabicLabel: "Arabic:",
                cvLangArabicLevel: "Native",
                cvLangEnglishLabel: "English:",
                cvLangEnglishLevel: "Intermediate",
                cvSummaryTitle: "Summary",
                cvSummaryContent: "Creative graphic designer and software developer from Faiyum, Egypt with over 3 years of experience in print and digital advertising. Skilled in using 3D elements, Adobe Creative Suite, and modern web technologies to deliver high-quality, impactful visual projects and user experiences.",
                cvExp1Point1: "Supported marketing initiatives, including creating content for social media.",
                cvExp1Point2: "Assisted with market research and analysis to guide marketing strategies.",
                cvExp5Point1: "Handling graphic design, e-marketing, and sales responsibilities.",
                cvEducationDate: "Graduated June 2025",
                cvCoursesTitle: "Courses & Training",
                phoneTitle: "WhatsApp",
                productDetailBtn: "Details",
                addProductBtn: "Add New Product",
                productDescriptionTitle: "Description",
                productTagsTitle: "Tags",
                orderViaWhatsApp: "Order via WhatsApp",
                visitorsText: "Website visitors",
                searchPlaceholder: "Type to search...",
                searchProjectsTitle: "Projects",
                searchArticlesTitle: "Blog Articles",
                searchNoResultsTitle: "No Results Found",
                searchNoResultsDesc: "Sorry, we couldn't find anything for your search. Please try a different term or check your spelling.",
                searchResultTypeProject: "Project",
                searchResultTypeArticle: "Article",
            },
            ar: {
                navHome: 'الرئيسية', navSkills: 'المهارات', navExperience: 'الخبرة', navProjects: 'المشاريع', navBlog: 'المدونة', navCertificates: 'الشهادات',
                heroLine1: 'بدر', heroLine2: 'ابراهيم محمد', heroLine3: 'مصمم تجارب رقمية',
                heroGreeting: 'مرحباً، أنا',
                heroBio: 'أدمج التصميم والبرمجة لبناء تجارب رقمية تفاعلية. متخصص في إنشاء هويات بصرية فريدة ومواقع ويب تفاعلية تأسر المستخدمين.',
                heroCtaViewWork: 'عرض أعمالي',
                heroCtaContact: 'تواصل معي',
                aboutTitle: 'عني',
                aboutParagraph: 'أنا مصمم جرافيك ومطور برامج مبدع من الفيوم، مصر ولدي أكثر من 3 سنوات من الخبرة في الإعلانات المطبوعة والرقمية. أنا ماهر في استخدام العناصر ثلاثية الأبعاد وأدوات مايكروسوفت أوفيس، وأقدم تصميمات عالية الجودة في الوقت المحدد. أسعى باستمرار للتطوير والمساهمة في المشاريع المرئية المؤثرة.',
                statYears: 'سنوات خبرة',
                statProjects: 'مشروع مكتمل',
                statClients: 'عميل سعيد',
                technicalSkillsTitle: 'المهارات الفنية',
                skillAdobe: 'مجموعة أدوبي كريتيف',
                skillOffice: 'مجموعة مايكروسوفت أوفيس',
                skillComputer: 'عمليات الحاسوب',
                skill3d: 'العناصر ثلاثية الأبعاد والتصميم المرئي',
                skillBrandDesc: "شعارات، أدلة بصرية، أنظمة مرئية",
                skillUiUxDesc: "مواقع ويب، تطبيقات جوال، نماذج أولية",
                skill3dDesc: "بلندر، تصيير ثلاثي الأبعاد",
                skillHtmlCssDesc: "تخطيطات ويب سريعة الاستجابة",
                skillJsDesc: "عناصر ويب تفاعلية",
                skillOfficeDesc: "وورد، بوربوينت، إكسل",
                personalSkillsTitle: 'المهارات الشخصية',
                skillCommunication: 'التواصل',
                skillTeamwork: 'العمل الجماعي والتعاون',
                skillAdaptable: 'قابلية التكيف وسرعة التعلم',
                skillAttention: 'الاهتمام بالتفاصيل وجودة العمل العالية',
                skillProblemSolving: 'حل المشكلات الإبداعي',
                skillsTitle: 'الكفاءات الأساسية',
                experienceTitle: 'الخبرة والتدريب',
                exp1Title: 'متدرب تسويق فندقي',
                exp1Meta: 'ديسمبر 2024 – فبراير 2025 | مدينة 6 أكتوبر، الجيزة',
                exp1Desc: 'دعم مبادرات التسويق، بما في ذلك إنشاء محتوى لوسائل التواصل الاجتماعي والمنصات الأخرى. المساعدة في أبحاث السوق وتحليلها لتوجيه استراتيجيات التسويق.',
                exp2Title: 'دورة مصمم جرافيك',
                exp2Meta: 'يناير 2021 – فبراير 2022 | شركة أدوبي، مدينة نصر',
                exp2Desc: 'تدريب شامل يركز على مبادئ التصميم الجرافيكي، وإنشاء الهوية البصرية، وإتقان مجموعة أدوبي كريتيف.',
                exp4Title: 'تدريب مساعد شيف',
                exp4Meta: '2019 | هوليداي إن، مدينة نصر',
                exp4Desc: 'اكتساب خبرة عملية في عمليات المطبخ والمساعدة في الطهي في فندق احترافي.',
                exp5Title: 'مصمم جرافيك ومسوق إلكتروني',
                exp5Meta: '2025 - الحاضر | معرض جدار للديكور، مصر',
                exp5Desc: 'مسؤول عن التصميم الجرافيكي والتسويق الإلكتروني وأنشطة المبيعات للمعرض.',
                exp6Title: 'خدمة الأطعمة والمشروبات على متن الطائرة',
                exp6Meta: '2023 | المعهد العالي للسياحة والفنادق، 6 أكتوبر',
                exp6Desc: 'معتمد في معايير وإجراءات خدمة الأطعمة والمشروبات على متن الطائرة، بالتعاون مع مصر للطيران.',
                projectsTitle: 'مشاريعي',
                projectsDesc: 'مجموعة مختارة من أعمالي الأخيرة. مرر الفأرة فوق المشروع لرؤية المزيد من التفاصيل وانقر على "عرض التفاصيل" لرؤية دراسة الحالة الكاملة.',
                addProjectBtn: 'إضافة مشروع جديد',
                certificatesTitle: 'الشهادات والجوائز',
                certificatesDesc: 'مجموعة من شهاداتي المهنية والتقديرات التي حصلت عليها.',
                addCertificateBtn: 'إضافة شهادة جديدة',
                testimonialsTitle: 'ماذا يقول العملاء',
                blogTitle: 'من المدونة',
                blogDesc: 'أشارك رؤى ونصائح ودروسًا تعليمية حول التصميم والتطوير والتكنولوجيا الإبداعية.',
                addArticleBtn: 'اكتب مقال جديد',
                readMoreBtn: 'اقرأ المزيد',
                replyTitle: 'اترك ردًا',
                replyDesc: 'ملاحظاتك قيمة ومقدرة!',
                postCommentBtn: 'انشر التعليق',
                backToHomeBtn: 'العودة إلى الرئيسية',
                footerRights: '&copy; 2025 بدر. كل الحقوق محفوظة.',
                educationTitle: 'التعليم والشهادات',
                educationSubTitle: 'التعليم',
                educationDegree: 'بكالوريوس سياحة وفنادق',
                educationDepartment: 'قسم إدارة الضيافة',
                educationInstitute: 'المعهد العالي للسياحة والفنادق - تخرج يونيو 2025',
                languagesSubTitle: 'اللغات',
                languageArabic: '<span class="font-semibold text-white">العربية:</span> <span class="text-gray-400">اللغة الأم</span>',
                languageEnglish: '<span class="font-semibold text-white">الإنجليزية:</span> <span class="text-gray-400">إتقان متوسط</span>',
                contactTitle: 'تواصل معي',
                contactDesc: 'املأ النموذج وسأعود إليك في غضون 24 ساعة.',
                emailTitle: 'البريد الإلكتروني',
                phoneTitle: 'واتساب',
                socialTitle: 'تابعني',
                sendMessageBtn: 'إرسال رسالة',
                formName: 'اسمك',
                formEmail: 'بريدك الإلكتروني',
                formMessage: 'رسالتك',
                projectDetailAboutTitle: 'عن هذا المشروع',
                projectDetailInfoTitle: 'معلومات المشروع',
                projectDetailDate: 'التاريخ',
                projectDetailTools: 'الأدوات المستخدمة',
                projectDetailStatus: 'الحالة',
                projectDetailTags: 'العلامات',
                projectDetailVisitBtn: 'زيارة المشروع',
                projectDetailDownloadBtn: 'تحميل',
                tooltipToggleTheme: 'تبديل المظهر',
                tooltipChangeLang: 'تغيير اللغة',
                tooltipAdminEdit: 'تعديل',
                tooltipAdminDelete: 'حذف',
                tooltipSliderPrev: 'السابق',
                tooltipSliderNext: 'التالي',
                tooltipModalClose: 'إغلاق',
                tooltipFabContact: 'تواصل معي',
                tooltipChatbot: 'افتح المحادثة',
                resumeBtn: 'تحميل السيرة الذاتية',
                downloadCvBtn: 'تحميل السيرة الذاتية',
                ctaTitle: 'هل أنت مهتم بالعمل معاً؟',
                ctaSubtitle: 'لِنبدأ حواراً.',
                cvTitle: "سيرتي الذاتية",
                cvName: "بدر إبراهيم",
                cvJobTitle: "مصمم جرافيك ومطور برامج",
                cvContactTitle: "معلومات التواصل",
                cvLocation: "الفيوم، مصر",
                cvSkillsTitle: "المهارات",
                cvSkillAdobe: "مجموعة أدوبي",
                cvSkill3D: "تصميم ثلاثي الأبعاد",
                cvSkillUIUX: "تصميم واجهات وتجربة المستخدم",
                cvSkillHTML: "HTML & CSS",
                cvSkillJS: "JavaScript",
                cvLangArabicLabel: "العربية:",
                cvLangArabicLevel: "اللغة الأم",
                cvLangEnglishLabel: "الإنجليزية:",
                cvLangEnglishLevel: "مستوى متوسط",
                cvSummaryTitle: "ملخص احترافي",
                cvSummaryContent: "مصمم جرافيك ومطور برامج مبدع من الفيوم، مصر بخبرة تزيد عن 3 سنوات في مجال الإعلانات المطبوعة والرقمية. ماهر في استخدام العناصر ثلاثية الأبعاد، ومجموعة أدوبي كريتيف، وتقنيات الويب الحديثة لتقديم مشاريع مرئية عالية الجودة وتجارب مستخدم مؤثرة.",
                cvExp1Point1: "دعم المبادرات التسويقية، بما في ذلك إنشاء محتوى لوسائل التواصل الاجتماعي.",
                cvExp1Point2: "المساعدة في أبحاث السوق وتحليلها لتوجيه استراتيجيات التسويق.",
                cvExp5Point1: "مسؤول عن مهام التصميم الجرافيكي والتسويق الإلكتروني والمبيعات.",
                educationDegree: "بكالوريوس سياحة وفنادق",
                educationInstitute: "المعهد العالي للسياحة والفنادق",
                cvEducationDate: "تخرج يونيو 2025",
                cvCoursesTitle: "الدورات والتدريب",
                productDetailBtn: "التفاصيل",
                addProductBtn: "أضف منتج جديد",
                productDescriptionTitle: "الوصف",
                productTagsTitle: "الوسوم",
                orderViaWhatsApp: "اطلب عبر واتساب",
                visitorsText: "زوار الموقع",
                searchPlaceholder: "اكتب للبحث...",
                searchProjectsTitle: "المشاريع",
                searchArticlesTitle: "المقالات",
                searchNoResultsTitle: "لم يتم العثور على نتائج",
                searchNoResultsDesc: "عذراً، لم نتمكن من العثور على أي شيء لبحثك. يرجى تجربة مصطلح مختلف أو التحقق من التهجئة.",
                searchResultTypeProject: "مشروع",
                searchResultTypeArticle: "مقال",
            }
        };

        function getMediaEmbedHTML(url, type, title) {
            let embedHTML = '';
            if(!url) return ''; 
            try {
                if (type === 'video' && url.match(/\.(mp4|webm|ogg)$/i)) {
                    return `<div class="video-container rounded-lg mb-6 overflow-hidden"><video controls autoplay loop muted playsinline src="${url}" class="w-full h-full object-contain"></video></div>`;
                }
                if (type === 'image' && url.match(/\.(jpeg|jpg|gif|png|webp|svg)$/i)) {
                     return `<div class="rounded-lg mb-6 overflow-hidden"><img src="${url}" alt="${title}" class="w-full h-auto max-h-[60vh] object-contain rounded-lg" loading="lazy"></div>`;
                }

                const urlObj = new URL(url);
                const hostname = urlObj.hostname.replace('www.', '');

                if (hostname.includes('instagram.com') || hostname.includes('facebook.com')) {
                    return `
                        <div class="text-center text-amber-300 p-4 rounded-lg bg-amber-500/10 border border-amber-500/30">
                            <h4 class="font-bold mb-2">Embedding from Instagram & Facebook is Unreliable</h4>
                            <p class="text-sm">For a stable portfolio, it's best to upload your video to <strong>YouTube</strong> or <strong>Vimeo</strong>. Your site is already set up to embed those links perfectly. This avoids issues with broken video links in the future.</p>
                        </div>`;
                }
                else if (type === 'video') {
                    if (hostname === 'youtube.com' || hostname === 'youtu.be') {
                        let videoId = urlObj.searchParams.get('v');
                        if (hostname === 'youtu.be') {
                            videoId = urlObj.pathname.substring(1);
                        }
                        if (videoId) {
                            embedHTML = `<iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
                        }
                    } else if (hostname === 'vimeo.com') {
                        const videoId = urlObj.pathname.split('/').pop();
                        if (videoId) {
                             embedHTML = `<iframe src="https://player.vimeo.com/video/${videoId}" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>`;
                        }
                    }
                } else if (type === 'image') {
                    // Fallback for other image links (non-Instagram)
                    return `<div class="rounded-lg mb-6 overflow-hidden"><img src="${url}" alt="${title}" class="w-full h-auto max-h-[60vh] object-contain rounded-lg" loading="lazy"></div>`;
                }

                if (embedHTML) {
                    return `<div class="video-container rounded-lg mb-6 overflow-hidden">${embedHTML}</div>`;
                } else {
                    return `<div class="text-center text-red-400 p-4 rounded-lg bg-red-500/10">Could not embed media. The URL might be private or unsupported.</div>`;
                }

            } catch (error) {
                console.error("Invalid URL:", url, error);
                return `<div class="text-center text-red-400 p-4 rounded-lg bg-red-500/10">Invalid or unsupported media URL provided.</div>`;
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const originalTitle = document.title;
            let lastScrollPosition = 0;
            
            let scene, camera, renderer, particles, animationFrameId;
            let mouseX = 0, mouseY = 0;
            const windowHalfX = window.innerWidth / 2;
            const windowHalfY = window.innerHeight / 2;
            let isThreeJSInitialized = false;


            let myProjects = [];
            let commentsData = [];
            let articlesData = [];
            let certificatesData = [];
            let productsData = [];
            let editingProjectId = null;
            let editingArticleId = null;
            let editingCertificateId = null;
            let editingProductId = null;
            
            const mainContent = document.querySelector('main');
            const projectDetailView = document.getElementById('project-detail-view');
            const projectsGrid = document.getElementById('projects-grid');
            const projectFiltersContainer = document.getElementById('project-filters');
            const authContainer = document.getElementById('auth-container');
            const articlesGrid = document.getElementById('articles-grid');
            const certificatesGrid = document.getElementById('certificates-grid');
            const articleDetailView = document.getElementById('article-detail-view');
            const addArticleContainer = document.getElementById('add-article-container');
            const themeToggleBtn = document.getElementById('theme-toggle-btn');
            const searchBtn = document.getElementById('search-btn');
            const searchModal = document.getElementById('search-modal');
            const searchCloseBtn = document.getElementById('search-close-btn');
            const searchForm = document.getElementById('search-form');
            const searchInput = document.getElementById('search-input');
            const searchResultsView = document.getElementById('search-results-view');
            const searchResultsContent = document.getElementById('search-results-content');
            const aiSearchAnswerContainer = document.getElementById('ai-search-answer');
            const keywordSearchResultsContainer = document.getElementById('keyword-search-results');
            const closeSearchBtn = document.getElementById('close-search-btn');
            const header = document.querySelector('header');
            const cvView = document.getElementById('cv-view');
            const readingProgressBar = document.getElementById('reading-progress-bar');
            const storeView = document.getElementById('store-view');
            const closeStoreBtn = document.getElementById('close-store-btn');
    const productDetailView = document.getElementById('product-detail-view');
    const backToStoreBtn = document.getElementById('back-to-store-btn');
    
    const cvNavBtn = document.getElementById('cv-nav-btn');
            if (cvNavBtn) {
                cvNavBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    renderPage({ view: 'cv' });
                    window.location.hash = '#cv'; 
                });
            }

            const closeCvBtn = document.getElementById('close-cv-btn');
            if (closeCvBtn) {
                closeCvBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    renderPage({ view: 'home' }); 
                    window.location.hash = ''; 
                });
            }

    if (backToStoreBtn) {
        backToStoreBtn.addEventListener('click', (e) => {
            e.preventDefault();
            renderPage({ view: 'store' });
            window.location.hash = '#store'; 
        });
    }

            document.addEventListener('contextmenu', (event) => {
                if (!document.body.classList.contains('logged-in')) {
                    event.preventDefault();
                }
            });
            
            const body = document.body;
            const currentTheme = localStorage.getItem('theme');

            function applyTheme(theme) {
                const articleContent = document.querySelector('#article-detail-content .prose');
                const canvasEl = document.getElementById('bg-canvas');
                const profilePic = document.getElementById('profile-picture-img');
                const cvProfilePic = document.getElementById('cv-profile-picture-img'); 

                if (theme === 'light') {
                    document.documentElement.classList.add('light-mode');
                    if (articleContent) articleContent.classList.remove('prose-invert');
                    if (profilePic) {
                        profilePic.src = profilePic.dataset.lightSrc;
                        if (cvProfilePic) cvProfilePic.src = profilePic.dataset.lightSrc; 
                    }
                    
                    if (canvasEl) canvasEl.style.display = 'block';

                    if (!isThreeJSInitialized) {
                        initThreeJS();
                    }
                    startThreeJSAnimation();

                } else { 
                    document.documentElement.classList.remove('light-mode');
                    if (articleContent) articleContent.classList.add('prose-invert');
                    if (profilePic) {
                        profilePic.src = profilePic.dataset.darkSrc;
                        if (cvProfilePic) cvProfilePic.src = profilePic.dataset.darkSrc; 
                    }
                    
                    if (canvasEl) canvasEl.style.display = 'none';
                    stopThreeJSAnimation();
                    
                }
                 updateCommentAvatar(theme);
            }

            let initialTheme = 'dark';
            if (currentTheme) {
                initialTheme = currentTheme;
            } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
                initialTheme = 'light';
            }
            localStorage.setItem('theme', initialTheme);


            themeToggleBtn.addEventListener('click', () => {
                const newTheme = document.documentElement.classList.contains('light-mode') ? 'dark' : 'light';
                applyTheme(newTheme);
                localStorage.setItem('theme', newTheme);
        });


            onAuthStateChanged(auth, async (user) => {
                let isUserAdmin = false;
                if (user) {
                    const adminRef = doc(db, 'admins', user.uid);
                    const adminDoc = await getDoc(adminRef);

                    if (adminDoc.exists()) {
                        isUserAdmin = true;
                        document.body.classList.add('logged-in');
                        addArticleContainer.style.display = 'block'; 
                        document.getElementById('admin-footer-controls').style.display = 'block';
                        
                        const adminSettings = adminDoc.data();
                        const profilePic = document.getElementById('profile-picture-img');
                        if (adminSettings.lightModeUrl) {
                            profilePic.dataset.lightSrc = adminSettings.lightModeUrl;
                        }
                        if (adminSettings.darkModeUrl) {
                            profilePic.dataset.darkSrc = adminSettings.darkModeUrl;
                        }

                        authContainer.innerHTML = `
                            <div class="relative" id="user-menu">
                                <button id="user-menu-btn" class="flex items-center gap-2 text-lg font-semibold text-white hover:text-gray-200 transition-colors">
                                    <span>Hello, Bader</span>
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                                </button>
                                <div id="user-dropdown" class="glass-card absolute top-full right-0 mt-3 w-48 rounded-xl overflow-hidden shadow-lg z-10">
                                    <a href="#" id="settings-btn" class="flex items-center gap-3 px-4 py-3 text-sm text-white hover:bg-white/5 transition-colors">
                                        <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                                        <span>Settings</span>
                                    </a>
                                    <a href="#" id="logout-btn" class="flex items-center gap-3 px-4 py-3 text-sm text-red-400 hover:bg-white/5 transition-colors">
                                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4"></path></svg>
                                        <span>Log Out</span>
                                    </a>
                                </div>
                            </div>
                        `;
                        
                        const userMenuBtn = document.getElementById('user-menu-btn');
                        const userDropdown = document.getElementById('user-dropdown');
                        
                        userMenuBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            userDropdown.classList.toggle('show');
                            userMenuBtn.classList.toggle('open');
                        });

                        document.getElementById('logout-btn').addEventListener('click', (e) => {
                            e.preventDefault();
                            signOut(auth);
                        });

                        document.getElementById('settings-btn').addEventListener('click', (e) => {
                            e.preventDefault();
                            showSettingsModal();
                        });

                    } else {
                        console.log("Unauthorized user signed in:", user.email);
                        console.log("UID Check Failed. The UID we checked for was:", user.uid); 
                        const loginError = document.getElementById('login-error');
                        if(loginError) {
                            loginError.innerHTML = `Authentication failed.<br>UID checked: ${user.uid}`; 
                        }
                        showLoginModal(); 
                        await signOut(auth); 
                    }
                } else {
                    try {
                        const publicSettingsRef = doc(db, 'settings', 'main_profile');
                        const settingsDoc = await getDoc(publicSettingsRef);
                        
                        if (settingsDoc.exists()) {
                            const publicSettings = settingsDoc.data();
                            const profilePic = document.getElementById('profile-picture-img');

                            if (publicSettings.lightModeUrl) {
                                profilePic.dataset.lightSrc = publicSettings.lightModeUrl;
                            }
                            if (publicSettings.darkModeUrl) {
                                profilePic.dataset.darkSrc = publicSettings.darkModeUrl;
                            }
                        }
                    } catch (error) {
                        console.error("Could not load public admin settings:", error);
                    }
                    document.body.classList.remove('logged-in');
                    addArticleContainer.style.display = 'none'; // Hide add article button
                    document.getElementById('admin-footer-controls').style.display = 'none';
                    authContainer.innerHTML = `<a href="#hero" id="auth-link" class="gradient-text text-2xl font-bold">Badr.</a>`;
                    // The router will handle the #hero link, no custom click listener needed.
                    /*
                    document.getElementById('auth-link').addEventListener('click', (e) => {
                        e.preventDefault();
                        // showLoginModal(); // Disabled login modal
                    });
                    */
                }
                
                try {
                    const statusDoc = await getDoc(siteStatusRef);
                    if (statusDoc.exists() && statusDoc.data().isMaintenanceMode && !isUserAdmin) {
                        document.getElementById('maintenance-overlay').classList.remove('hidden');
                        return; 
                    }
                } catch (error) {
                    console.error("Could not check maintenance status:", error);
                }

                applyTheme(localStorage.getItem('theme') || 'dark');
                displayProjects(projectFiltersContainer.querySelector('.active')?.dataset.filter || 'All');
                displayArticles();
                displayCertificates();
                displayProductsInStore();
            });


            function listenForProjects() {
                onSnapshot(projectsCollection, (snapshot) => {
                    myProjects = snapshot.docs.map(doc => ({ ...doc.data(), id: doc.id }));

                    const completedProjectsCount = myProjects.filter(p => p.status === 'Completed').length;
                    const projectsStatElement = document.getElementById('projects-completed-stat');
                    if (projectsStatElement) {
                        projectsStatElement.textContent = `${completedProjectsCount}+`;
                    }

                    myProjects.sort((a, b) => {
                        const featuredSort = (b.featured ? 1 : 0) - (a.featured ? 1 : 0);
                        if (featuredSort !== 0) {
                            return featuredSort;
                        }
                        return new Date(b.date) - new Date(a.date);
                    });

                    generateFilterButtons();
                    displayProjects();
                    updateAllStructuredData();
                }, (error) => {
                    console.error("Error fetching projects: ", error);
                    projectsGrid.innerHTML = `
                        <div class="w-full flex flex-col items-center justify-center text-center p-8 gap-4 glass-card rounded-2xl mx-auto max-w-md">
                           <svg class="w-16 h-16 text-red-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                            </svg>
                            <h4 class="text-2xl font-bold text-white">Failed to Load Projects</h4>
                            <p class="text-gray-400">There was a problem connecting to the database. Please check your internet connection and refresh the page.</p>
                        </div>
                    `;
                });
            }

            function listenForArticles() {
                onSnapshot(query(articlesCollection, orderBy('createdAt', 'desc')), (snapshot) => {
                    articlesData = snapshot.docs.map(doc => ({ ...doc.data(), id: doc.id }));

                    displayArticles();
                    updateAllStructuredData();
                }, (error) => {
                    console.error("Error fetching articles: ", error);
                    if (articlesGrid) articlesGrid.innerHTML = `
                        <div class="w-full flex flex-col items-center justify-center text-center p-8 gap-4 glass-card rounded-2xl mx-auto max-w-md col-span-full">
                           <svg class="w-16 h-16 text-red-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" />
                            </svg>
                            <h4 class="text-2xl font-bold text-white">Failed to Load Articles</h4>
                            <p class="text-gray-400">There was a problem connecting to the database. Please check your internet connection and refresh the page.</p>
                        </div>
                    `;
                });
            }

            function listenForProducts() {
                const productsGridStore = document.getElementById('products-grid-store');
                if (!productsGridStore) return;

                onSnapshot(query(productsCollection, orderBy('createdAt', 'desc')), (snapshot) => {
                    productsData = snapshot.docs.map(doc => ({ ...doc.data(), id: doc.id }));
                    displayProductsInStore();
                    updateAllStructuredData();
                }, (error) => {
                    console.error("Error fetching products:", error);
                    productsGridStore.innerHTML = `<p class="text-red-400 col-span-full text-center">Failed to load products.</p>`;
                });
            }

            function listenForCertificates() {
                onSnapshot(query(certificatesCollection, orderBy('createdAt', 'desc')), (snapshot) => {
                    certificatesData = snapshot.docs.map(doc => ({ ...doc.data(), id: doc.id }));
                    displayCertificates();
                    updateAllStructuredData();
                }, (error) => {
                    console.error("Error fetching certificates: ", error);
                    const sliderContainer = document.getElementById('certificates-slider-container');
                    if (sliderContainer) sliderContainer.innerHTML = `<p class="text-red-400 col-span-full text-center">Failed to load certificates.</p>`;
                });
            }

            function displayProductsInStore() {
                const productsGridStore = document.getElementById('products-grid-store');
                if (!productsGridStore) return;
                const isLoggedIn = document.body.classList.contains('logged-in');
                productsGridStore.innerHTML = '';

                if (productsData.length === 0) {
                    productsGridStore.innerHTML = `<p class="text-gray-400 text-center col-span-full">No products available yet.</p>`;
                    return;
                }

                productsData.forEach(product => {
                    const adminControls = isLoggedIn ? `
                        <div class="admin-controls">
                            <button class="admin-btn edit-product-btn" data-id="${product.id}" aria-label="Edit Product"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg></button>
                            <button class="admin-btn delete-product-btn delete" data-id="${product.id}" aria-label="Delete Product"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button>
                        </div>
                    ` : '';
                    
                    const coverImage = (product.media && product.media.length > 0) ? product.media.find(m => m.type === 'image')?.url || product.media[0].url : 'https://placehold.co/400x400/0D0D0D/FFD700?text=No+Image';

                    const cardHTML = `
                        <div class="store-product-card">
                            ${adminControls}
                            <div class="product-card-image">
                                <img src="${coverImage}" alt="${product.name}" class="w-full h-full object-cover">
                            </div>
                            <div>
                                <p class="product-category">${product.category}</p>
                                <h4 class="product-title">${product.name}</h4>
                                <div class="details-price-wrapper">
                                    <span class="product-price-display">${product.currency || 'EGP'} ${product.price}</span>
                                    <a href="#" class="details-btn view-product-btn" data-id="${product.id}">
                                        <span data-translate-key="productDetailBtn">Details</span>
                                        <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M17.25 8.25L21 12m0 0l-3.75 3.75M21 12H3" /></svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    `;
                    productsGridStore.innerHTML += cardHTML;
                });

                attachProductEventListeners();
            }

            function displayCertificates() {
                const sliderContainer = document.getElementById('certificates-slider-container');
                if (!sliderContainer) return;
                const isLoggedIn = document.body.classList.contains('logged-in');
                sliderContainer.innerHTML = '';

                if (certificatesData.length === 0) {
                    sliderContainer.innerHTML = `<p class="text-gray-400 text-center col-span-full">No certificates added yet.</p>`;
                    updateCertificatesSliderButtons();
                    return;
                }

                certificatesData.forEach((cert, index) => {
                    const adminControls = isLoggedIn ? `
                        <div class="admin-controls">
                            <button class="admin-btn edit-certificate-btn" data-id="${cert.id}" aria-label="Edit Certificate"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg></button>
                            <button class="admin-btn delete-certificate-btn delete" data-id="${cert.id}" aria-label="Delete Certificate"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg></button>
                        </div>
                    ` : '';

                    const cardHTML = `
                        <div class="certificate-card-slider" data-index="${index}">
                            ${adminControls}
                            <img src="${cert.imageUrl}" alt="${cert.title}" loading="lazy">
                            <div class="overlay">
                                <h5>${cert.title}</h5>
                            </div>
                        </div>
                    `;
                    sliderContainer.innerHTML += cardHTML;
                });
                attachCertificateEventListeners();
                updateCertificatesSlider();
                updateCertificatesSliderButtons();
            }

            function generateFilterButtons() {
                const tagCounts = new Map();
                myProjects.forEach(p => {
                    if (p.tags) {
                        p.tags.split(',').forEach(tag => {
                            const trimmedTag = tag.trim();
                            if (trimmedTag) {
                                tagCounts.set(trimmedTag, (tagCounts.get(trimmedTag) || 0) + 1);
                            }
                        });
                    }
                });

                const sortedTags = Array.from(tagCounts.entries()).sort((a, b) => b[1] - a[1]);
                
                const topTags = sortedTags.slice(0, 11).map(entry => entry[0]);

                let buttonsHTML = '<button class="filter-btn active" data-filter="All">All</button>';
                topTags.forEach(tag => {
                    buttonsHTML += `<button class="filter-btn" data-filter="${tag}">#${tag}</button>`;
                });
                
                projectFiltersContainer.innerHTML = buttonsHTML;
                
                const originalButtonsHTML = projectFiltersContainer.innerHTML;
                
                projectFiltersContainer.innerHTML += originalButtonsHTML; 


                projectFiltersContainer.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        if (projectFiltersContainer.querySelector('.active')) {
                            projectFiltersContainer.querySelector('.active').classList.remove('active');
                        }
                        btn.classList.add('active');
                        displayProjects(btn.dataset.filter);
                    });
                });
            }

            function displayProjects(filter = 'All') {
                currentProjectIndex = 0; 
                const isLoggedIn = !!auth.currentUser;
                
                if (!myProjects) {
                    projectsGrid.innerHTML = '<p class="text-center col-span-full text-gray-400">No projects to display yet.</p>';
                    return;
                }

                const filteredProjects = filter === 'All' ? myProjects : myProjects.filter(p => p.tags && p.tags.split(',').map(t => t.trim()).includes(filter));
                
                if (filteredProjects.length === 0) {
                     projectsGrid.innerHTML = `
                        <div class="w-full flex flex-col items-center justify-center text-center p-8 gap-4 glass-card rounded-2xl mx-auto max-w-md">
                           <svg class="w-16 h-16 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                              <path stroke-linecap="round" stroke-linejoin="round" d="M6 20.25h12m-7.5-3.75v3.75m3.75-3.75v3.75m-7.5-3.75L3 16.5m18 0l-3.75-3.75M3 16.5l7.5-7.5 7.5 7.5" />
                            </svg>
                            <h4 class="text-2xl font-bold text-white">No Projects Found</h4>
                            <p class="text-gray-400">There are currently no projects in the "${filter}" category.</p>
                            <button id="show-all-projects-btn" class="submit-btn mt-4">Show All Projects</button>
                        </div>
                     `;
                     document.getElementById('show-all-projects-btn').addEventListener('click', () => {
                        const allButton = document.querySelector('#project-filters .filter-btn[data-filter="All"]');
                        if (allButton) allButton.click();
                     });
                     updateSliderButtons();
                     return;
                }

                projectsGrid.innerHTML = '';

                filteredProjects.forEach((project) => {
                    const adminControls = isLoggedIn ? `
                        <div class="admin-controls">
                            <button class="admin-btn edit-btn" data-id="${project.id}" aria-label="Edit Project" title="Edit" data-translate-title="tooltipAdminEdit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg></button>
                            <button class="admin-btn delete-btn delete" data-id="${project.id}" aria-label="Delete Project" title="Delete" data-translate-title="tooltipAdminDelete"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg></button>
                        </div>
                    ` : '';

                    const featuredBadge = project.featured ? `
                        <div class="absolute top-4 left-4 bg-yellow-400 text-yellow-900 text-xs font-bold px-3 py-1 rounded-full flex items-center gap-1.5 z-10 shadow-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/></svg>
                            <span>Featured</span>
                        </div>
                    ` : '';
                    
                    let statusDisplay = project.status || '';
                    if (statusDisplay === 'Concept') statusDisplay = 'Idea'; // Map old value to new one
                    const statusText = statusDisplay.replace(/([A-Z])/g, ' $1').trim();
                    const statusBadge = project.status ? `<div class="status-badge status-${statusDisplay}">${statusText}</div>` : '';

                    const tagsHTML = project.tags ? project.tags.split(',').map(tag => `<span class="inline-block bg-white/10 text-violet-300 text-xs font-semibold mr-1 mb-1 px-2.5 py-1 rounded-full">${tag.trim()}</span>`).join('') : '';

                    const projectCard = `
                        <article class="group relative rounded-2xl overflow-hidden shadow-lg project-card h-[450px]">
                            ${adminControls}
                            ${featuredBadge}
                            ${statusBadge}
                            
                            <!-- Background Image -->
                            <img src="${project.coverImageUrl}" alt="صورة الغلاف لمشروع ${project.title}، وهو مشروع في فئة ${project.tags ? project.tags.split(',')[0].trim() : 'تصميم'}." class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 ease-in-out group-hover:scale-110" loading="lazy" width="320" height="420">
                            
                            <!-- Content that slides up -->
                            <div class="absolute inset-0 flex flex-col justify-end p-6 text-white project-card-content">
                                <div> <!-- Wrapper for always-visible content -->
                                    <h4 class="text-2xl font-bold tracking-tight mb-2 flex-shrink-0">${project.title}</h4>
                                    <div class="project-card-stats flex items-center gap-4 text-gray-300 text-sm mb-4">
                                        <span class="flex items-center gap-1.5" title="Views">
                                            <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                                            ${project.views || 0}
                                        </span>
                                        <span class="flex items-center gap-1.5" title="Likes">
                                            <svg class="w-4 h-4" style="fill: currentColor;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                                            ${project.likes || 0}
                                        </span>
                                    </div>
                                </div>
                                
                                <div class="project-card-details">
                                    <p class="text-gray-300 text-sm mb-4 h-12 overflow-hidden">${project.description}</p>
                                    <div class="flex flex-wrap gap-y-1 mb-4">
                                        ${tagsHTML}
                                    </div>
                                    <a href="#project/${project.id}" class="submit-btn view-project-btn w-full justify-center" data-id="${project.id}">View Details</a>
                                </div>
                            </div>
                        </article>
                    `;
                    projectsGrid.innerHTML += projectCard;
                });
                attachProjectEventListeners();
                
                updateSliderButtons();
                setTimeout(updateProjectSliderAppearance, 50);
            }
            
            const sliderContainer = document.getElementById('projects-slider-container');
            const prevButton = document.getElementById('prev-slide');
            const nextButton = document.getElementById('next-slide');
            let currentProjectIndex = 0;

            function updateProjectSliderAppearance() {
                 if (!sliderContainer) return;

                const sliderCenter = sliderContainer.scrollLeft + sliderContainer.offsetWidth / 2;

                projectsGrid.querySelectorAll('.project-card').forEach(card => {
                    const cardCenter = card.offsetLeft + card.offsetWidth / 2;
                    const distance = Math.abs(sliderCenter - cardCenter);
                    const scale = Math.max(0.8, 1 - (distance / sliderContainer.offsetWidth));
                    
                    const rotation = (cardCenter - sliderCenter) / sliderContainer.offsetWidth * 30;

                    card.style.transform = `scale(${scale}) rotateY(${rotation}deg)`;
                });
            }


            function updateSliderButtons() {
                if (!sliderContainer || !prevButton || !nextButton) return;
                const projectCards = projectsGrid.querySelectorAll('.project-card');
                const isScrollable = projectCards.length > 1;
                
                prevButton.classList.toggle('disabled', !isScrollable);
                nextButton.classList.toggle('disabled', !isScrollable);
            }
            
             function scrollToIndex(index) {
                const card = projectsGrid.querySelectorAll('.project-card')[index];
                if (card) {
                    const scrollPosition = card.offsetLeft - (sliderContainer.offsetWidth / 2) + (card.offsetWidth / 2);
                    sliderContainer.scrollTo({
                        left: scrollPosition,
                        behavior: 'smooth'
                    });
                }
            }


            nextButton.addEventListener('click', () => {
                const projectCards = projectsGrid.querySelectorAll('.project-card');
                if (projectCards.length <= 1) return;
                currentProjectIndex = (currentProjectIndex + 1) % projectCards.length;
                scrollToIndex(currentProjectIndex);
            });

            prevButton.addEventListener('click', () => {
                const projectCards = projectsGrid.querySelectorAll('.project-card');
                if (projectCards.length <= 1) return;
                currentProjectIndex = (currentProjectIndex - 1 + projectCards.length) % projectCards.length;
                 scrollToIndex(currentProjectIndex);
            });
            
            let scrollTimeout;
            sliderContainer.addEventListener('scroll', () => {
                 clearTimeout(scrollTimeout);
                 scrollTimeout = setTimeout(updateProjectSliderAppearance, 10);
            });
            
            window.addEventListener('resize', () => setTimeout(() => {
                updateSliderButtons();
                updateProjectSliderAppearance();
            }, 100));

            function displayArticles() {
                if (!articlesGrid) return;
                const isLoggedIn = document.body.classList.contains('logged-in');
                articlesGrid.innerHTML = '';

                if (articlesData.length === 0) {
                    articlesGrid.innerHTML = '<p class="text-gray-400 text-center col-span-full">No articles published yet. Check back soon!</p>';
                    return;
                }

                articlesData.forEach(article => {
                    const adminControls = isLoggedIn ? `
                        <div class="admin-controls">
                            <button class="admin-btn edit-article-btn" data-id="${article.id}" aria-label="Edit Article" title="Edit" data-translate-title="tooltipAdminEdit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg></button>
                            <button class="admin-btn delete-article-btn delete" data-id="${article.id}" aria-label="Delete Article" title="Delete" data-translate-title="tooltipAdminDelete"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg></button>
                        </div>
                    ` : '';
                    const dateFormatted = article.createdAt?.toDate ? new Date(article.createdAt.toDate()).toLocaleDateString('en-US', { year: 'numeric', month: 'long' }) : 'Just now';

                    const placeholderImg = `https://placehold.co/400x400/2B2729/988381?text=${article.title.substring(0,1)}`;
                    const imageUrl = article.coverImageUrl || placeholderImg;

                    const articleCard = `
                    <article class="relative article-card rounded-2xl overflow-hidden w-[280px] sm:w-[320px] h-[400px] flex-none snap-center group gsap-reveal">
                        ${adminControls}
                        <img src="${imageUrl}" alt="صورة الغلاف لمقال بعنوان: ${article.title}" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy" width="320" height="400" onerror="this.src='${placeholderImg}'">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
                        <div class="relative h-full flex flex-col justify-end p-6" style="color: #ffffff;">
                            <p class="text-sm mb-2" style="color: #ffffff;">${dateFormatted}</p>
                            <h4 class="text-xl font-bold mb-3 leading-tight" style="color: #ffffff;">${article.title}</h4>
                            <a href="#article/${article.id}" class="view-article-btn text-sm font-semibold hover:text-gray-300 transition-colors self-start" data-id="${article.id}" style="color: #ffffff;">
                                <span data-translate-key="readMoreBtn">Read More</span> &rarr;
                            </a>
                        </div>
                    </article>
                    `;
                    articlesGrid.innerHTML += articleCard;
                });

                attachArticleEventListeners();

                requestAnimationFrame(() => {
                    if (articlesSliderContainer) {
                        articlesSliderContainer.scrollLeft = 0; 
                        updateArticleSliderButtons();
                        updateArticleSliderAppearance(); 
                    }
                });

                translatePage(getCookie('selected_language') || 'en');
            }


            const articlesSliderContainer = document.getElementById('articles-slider-container');
            const prevArticleButton = document.getElementById('prev-article-slide');
            const nextArticleButton = document.getElementById('next-article-slide');
            let currentArticleIndex = 0;

            function updateArticleSliderAppearance() {
                if (!articlesSliderContainer) return;
                const sliderCenter = articlesSliderContainer.scrollLeft + articlesSliderContainer.offsetWidth / 2;

                articlesSliderContainer.querySelectorAll('.article-card').forEach(card => {
                    const cardCenter = card.offsetLeft + card.offsetWidth / 2;
                    const distance = Math.abs(sliderCenter - cardCenter);
                    const scale = Math.max(0.8, 1 - (distance / articlesSliderContainer.offsetWidth));
                    
                    const rotation = (cardCenter - sliderCenter) / articlesSliderContainer.offsetWidth * 20;

                    card.style.transform = `scale(${scale}) rotateY(${rotation}deg)`;
                });
            }

            function updateArticleSliderButtons() {
                if (!articlesSliderContainer || !prevArticleButton || !nextArticleButton) return;
                const isScrollable = articlesData.length > 1;
                prevArticleButton.classList.toggle('disabled', !isScrollable);
                nextArticleButton.classList.toggle('disabled', !isScrollable);
            }

            function scrollToArticleIndex(index) {
                const card = articlesSliderContainer.querySelectorAll('.article-card')[index];
                if (card) {
                    const scrollPosition = card.offsetLeft - (articlesSliderContainer.offsetWidth / 2) + (card.offsetWidth / 2);
                    articlesSliderContainer.scrollTo({
                        left: scrollPosition,
                        behavior: 'smooth'
                    });
                }
            }

            nextArticleButton.addEventListener('click', () => {
                const articleCards = articlesSliderContainer.querySelectorAll('.article-card');
                if (articleCards.length <= 1) return;
                currentArticleIndex = (currentArticleIndex + 1) % articleCards.length;
                scrollToArticleIndex(currentArticleIndex);
            });

            prevArticleButton.addEventListener('click', () => {
                const articleCards = articlesSliderContainer.querySelectorAll('.article-card');
                if (articleCards.length <= 1) return;
                currentArticleIndex = (currentArticleIndex - 1 + articleCards.length) % articleCards.length;
                scrollToArticleIndex(currentArticleIndex);
            });

            articlesSliderContainer.addEventListener('scroll', () => {
                updateArticleSliderAppearance();
            });
             window.addEventListener('load', () => setTimeout(() => {
                updateArticleSliderButtons();
                updateArticleSliderAppearance();
            }, 100));
            window.addEventListener('resize', () => setTimeout(() => {
                updateArticleSliderButtons();
                updateArticleSliderAppearance();
            }, 100));


            const testimonialSlider = document.getElementById('testimonial-slider');
            let commentsLoaded = false;
            let currentTestimonialIndex = 0;
            let touchStartX = 0;
            let touchEndX = 0;
            let testimonialInterval;

            function updateTestimonialPositions() {
                const cards = document.querySelectorAll('#testimonial-slider .testimonial-card');
                const dots = document.querySelectorAll('#testimonial-dots button');
                if (cards.length === 0) return;

                cards.forEach((card, index) => {
                    card.classList.toggle('active', index === currentTestimonialIndex);
                });

                dots.forEach((dot, index) => {
                    dot.classList.toggle('bg-white/60', index === currentTestimonialIndex);
                    dot.classList.toggle('bg-white/20', index !== currentTestimonialIndex);
                });
            }
            
            if (testimonialSlider) {
                testimonialSlider.addEventListener('touchstart', e => {
                    touchStartX = e.changedTouches[0].screenX;
                    if (testimonialInterval) clearInterval(testimonialInterval); // Stop auto-slide on touch
                }, { passive: true });

                testimonialSlider.addEventListener('touchend', e => {
                    touchEndX = e.changedTouches[0].screenX;
                    handleSwipeGesture();
                }, { passive: true });
            }

            function handleSwipeGesture() {
                const swipeThreshold = 50; 
                if (touchEndX < touchStartX - swipeThreshold) {
                    changeTestimonialSlide(currentTestimonialIndex + 1, true);
                }
                if (touchEndX > touchStartX + swipeThreshold) {
                    changeTestimonialSlide(currentTestimonialIndex - 1, true);
                }
            }

            async function updateAndDisplayVisitorCount() {
                const countElement = document.getElementById('visitor-count');
                if (!countElement) return;

                try {
                    await updateDoc(visitsRef, { count: increment(1) });
                } catch (error) {
                    if (error.code === 'not-found') {
                        try {
                            await setDoc(visitsRef, { count: 1 });
                        } catch (set_error) {
                             console.error("Firebase permission error: Could not create 'visits' document. Please check your Firestore security rules to allow creation.", set_error);
                        }
                    } else {
                        console.error("Firebase permission error: Could not update 'visits' document. Please check your Firestore security rules to allow updates.", error);
                    }
                }

                onSnapshot(visitsRef, (doc) => {
                    if (doc.exists()) {
                        const count = doc.data().count;
                        countElement.textContent = new Intl.NumberFormat().format(count);
                    } else {
                        countElement.textContent = '1'; 
                    }
                }, (error) => {
                    console.error("Error fetching visit count:", error);
                    countElement.textContent = 'N/A';
                });
            }

            function updateReadingProgress() {
                if (readingProgressBar.style.display !== 'block') return;

                const scrollableHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollTop = window.scrollY;
                
                if (scrollableHeight <= 0) {
                    readingProgressBar.style.width = '100%';
                    return;
                }

                const progress = (scrollTop / scrollableHeight) * 100;
                readingProgressBar.style.width = `${Math.min(progress, 100)}%`;
            }


            const form = document.getElementById('contact-form');
            const formStatus = document.getElementById('form-status');
            async function handleSubmit(event) {
                event.preventDefault();
                const data = new FormData(event.target);
                formStatus.innerHTML = '<p class="text-gray-400">Sending...</p>';
                try {
                    const response = await fetch(event.target.action, {
                        method: form.method,
                        body: data,
                        headers: { 'Accept': 'application/json' }
                    });
                    if (response.ok) {
                        formStatus.innerHTML = '<p class="text-green-400">Thank you for your message!</p>';
                        form.reset();
                    } else {
                        const responseData = await response.json();
                        if (Object.hasOwn(responseData, 'errors')) {
                            formStatus.innerHTML = `<p class="text-red-400">${responseData["errors"].map(error => error["message"]).join(", ")}</p>`;
                        } else {
                            formStatus.innerHTML = '<p class="text-red-400">Oops! There was a problem.</p>';
                        }
                    }
                } catch (error) {
                    formStatus.innerHTML = '<p class="text-red-400">Oops! There was a problem.</p>';
                }
            }
                if(form) form.addEventListener("submit", handleSubmit);


            const commentForm = document.getElementById('comment-form');
            const commentStatus = document.getElementById('comment-status');
            const submitCommentBtn = document.getElementById('submit-comment-btn');

            const appsScriptUrl = 'https://script.google.com/macros/s/AKfycbyNlAtuOthsgdF-t9NEh1qD24v2e06TaVmtivm0VWvMXM7nHbjECGAmk7OaRr58Ia1B/exec'; 

            async function fetchComments() {
                if (commentsLoaded) return; 
                testimonialSlider.innerHTML = `<div class="text-center w-full"><div class="typing-indicator" style="opacity: 0.5; margin-bottom: 1rem;"><span></span><span></span><span></span></div><p class="text-gray-400">Loading comments...</p></div>`;

                try {
                    const response = await fetch(`${appsScriptUrl}?action=read`);
                    if (!response.ok) throw new Error('Network response was not ok');
                    const comments = await response.json();
                    if (!Array.isArray(comments)) throw new Error("Received invalid data from API.");

                    if (comments.length > 0) {
                        comments.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                        commentsData = comments;
                    } else {
                        commentsData = [];
                    }
                    commentsLoaded = true; 
                } catch (error) {
                    console.error("Failed to fetch comments:", error);
                    testimonialSlider.innerHTML = `<div class="text-center w-full"><p class="text-red-400">Failed to load comments. Please try refreshing.</p></div>`;
                } finally {
                    displayCommentsSlider();
                }
            }
            
            function displayCommentsSlider() {
                const slider = document.getElementById('testimonial-slider');
                const dotsContainer = document.getElementById('testimonial-dots');
                if (!slider || !dotsContainer) return;

                slider.innerHTML = '';
                dotsContainer.innerHTML = '';

                if (commentsData.length === 0) {
                    slider.innerHTML = `<p class="text-gray-400 text-center w-full">No testimonials have been added yet.</p>`;
                    return;
                }

                commentsData.forEach((comment, index) => {
                    const card = document.createElement('div');
                    card.className = 'testimonial-card';
                    card.dataset.index = index;

                    let starsHTML = '';
                    const rating = parseInt(comment.rating, 10) || 0;
                    for (let i = 1; i <= 5; i++) {
                        const filledClass = i <= rating ? 'filled' : '';
                        starsHTML += `<svg class="${filledClass}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" /></svg>`;
                    }

                    const name = escapeHTML(comment.name);
                    const firstLetter = name ? name.charAt(0).toUpperCase() : '?';

                    const avatarHTML = `
                        <div class="w-12 h-12 rounded-full flex items-center justify-center text-xl font-bold mb-4 mx-auto" style="background-color: var(--glass-bg); border: 1px solid var(--border-primary);">
                            ${firstLetter}
                        </div>
                    `;

                    card.innerHTML = `
                        <div class="max-w-3xl mx-auto">
                             ${avatarHTML}
                             <div class="star-rating">${starsHTML}</div>
                             <p class="text-xl md:text-2xl font-medium text-gray-300 mb-6 leading-relaxed">“${escapeHTML(comment.message)}”</p>
                             <p class="font-bold text-white text-lg">${name}</p>
                             <p class="text-sm text-gray-500 mt-1">${new Date(comment.timestamp).toLocaleDateString()}</p>
                        </div>
                    `;
                    slider.appendChild(card);

                    const dot = document.createElement('button');
                    dot.className = 'w-2 h-2 rounded-full bg-white/20 transition-colors duration-300';
                    dot.dataset.index = index;
                    dot.addEventListener('click', () => {
                        changeTestimonialSlide(index, true);
                    });
                    dotsContainer.appendChild(dot);
                });

                changeTestimonialSlide(0, false); 
                startTestimonialAutoSlide(); 
            }

            function startTestimonialAutoSlide() {
                if (testimonialInterval) clearInterval(testimonialInterval);
                testimonialInterval = setInterval(() => {
                    changeTestimonialSlide(currentTestimonialIndex + 1, false);
                }, 4000);
            }

            function changeTestimonialSlide(newIndex, isManual = false) {
                if (isManual && testimonialInterval) {
                    clearInterval(testimonialInterval);
                }

                const cards = document.querySelectorAll('#testimonial-slider .testimonial-card');
                if (cards.length === 0) return;
                if (newIndex < 0) {
                    newIndex = cards.length - 1;
                } else if (newIndex >= cards.length) {
                    newIndex = 0;
                }
                currentTestimonialIndex = newIndex;
                updateTestimonialPositions();
            }

            function escapeHTML(str) {
                const p = document.createElement('p');
                if (str) {
                    p.textContent = str;
                }
                return p.innerHTML;
            }

            const offensiveWords = [
                'fuck', 'shit', 'bitch', 'cunt', 'asshole', 'dick',
                'كلب', 'حيوان', 'خرا', 'كس', 'عاهرة'
            ];

            function isOffensive(text) {
                const lowerCaseText = text.toLowerCase();
                return offensiveWords.some(word => lowerCaseText.includes(word));
            }

            async function addComment(name, message) {
                submitCommentBtn.disabled = true;
                commentStatus.innerHTML = `<p class="text-gray-400">Adding comment...</p>`;

                const ratingValue = document.querySelector('#comment-rating-input input[name="rating"]:checked')?.value;
                if (!ratingValue) {
                    commentStatus.innerHTML = `<p class="text-red-400">Please select a star rating.</p>`;
                    submitCommentBtn.disabled = false;
                    setTimeout(() => { commentStatus.innerHTML = ''; }, 4000);
                    return;
                }

                const newComment = { timestamp: new Date().toISOString(), name, message, rating: ratingValue };

                commentsData.unshift(newComment);
                currentTestimonialIndex = 0; 
                displayCommentsSlider();
                commentForm.reset();
                commentStatus.innerHTML = `<p class="text-green-400">Your comment has been posted!</p>`;


                try {
                    const postResponse = await fetch(appsScriptUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'text/plain;charset=utf-8' },
                        body: JSON.stringify({ action: 'create', data: newComment })
                    });

                    const result = await postResponse.json();
                    
                    if (!postResponse.ok || result.status !== "success") {

                        console.error("Failed to save comment to server:", result.message || 'Unknown error');
                       
                        commentStatus.innerHTML = `<p class="text-amber-400">Your comment is visible but failed to sync with the server.</p>`;
                    }
                    
                } catch (error) {
                     console.error("Failed to save comment:", error);
                     commentStatus.innerHTML = `<p class="text-amber-400">Your comment is visible but failed to sync with the server.</p>`;
                } finally {
                    submitCommentBtn.disabled = false;
                    setTimeout(() => { commentStatus.innerHTML = ''; }, 5000);
                }
            }


            if(commentForm) {
                const commentWrapper = document.getElementById('comment-section-wrapper');
                const commentMessage = document.getElementById('comment-message');
                const cancelBtn = document.getElementById('cancel-comment-btn');
                const commentNameInput = document.getElementById('comment-name');

                const expandCommentForm = () => {
                    commentMessage.rows = 3;
                    commentForm.classList.add('is-expanded');
                };

                const collapseCommentForm = () => {
                    commentMessage.rows = 1;
                    commentForm.classList.remove('is-expanded');
                    commentMessage.blur(); 
                };

                commentMessage.addEventListener('focus', expandCommentForm);

                cancelBtn.addEventListener('click', () => {
                    commentForm.reset();
                    collapseCommentForm();
                });


                document.addEventListener('click', (e) => {

                    if (commentForm.classList.contains('is-expanded') && !commentWrapper.contains(e.target)) {
                       collapseCommentForm();
                    }
                });

                commentForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const name = commentNameInput.value.trim();
                    const message = commentMessage.value.trim();
                    const rating = document.querySelector('#comment-rating-input input[name="rating"]:checked')?.value;

                    if (isOffensive(name) || isOffensive(message)) {
                        commentStatus.innerHTML = `<p class="text-red-400">Please use respectful language. Your comment was not posted.</p>`;
                        setTimeout(() => { commentStatus.innerHTML = ''; }, 4000);
                        return;
                    }

                    if (name && message && rating) {
                        await addComment(name, message);

                        setTimeout(() => {
                            commentForm.reset();
                            collapseCommentForm();
                        }, 500); 
                    }
                });
            }

            const prevTestimonialBtn = document.getElementById('prev-testimonial');
            const nextTestimonialBtn = document.getElementById('next-testimonial');
            if (prevTestimonialBtn && nextTestimonialBtn) {
                prevTestimonialBtn.addEventListener('click', () => changeTestimonialSlide(currentTestimonialIndex - 1, true));
                nextTestimonialBtn.addEventListener('click', () => changeTestimonialSlide(currentTestimonialIndex + 1, true));
            }



            function initThreeJS() {
                const canvas = document.getElementById('bg-canvas');
                if (!canvas) return;

                camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 1, 10000);
                camera.position.z = 1000;

                scene = new THREE.Scene();

                renderer = new THREE.WebGLRenderer({ canvas: canvas, alpha: true });
                renderer.setPixelRatio(window.devicePixelRatio);
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setClearColor(0x000000, 0); // Transparent background

                const particlesGeometry = new THREE.BufferGeometry();
                const particlesCnt = 5000;
                const posArray = new Float32Array(particlesCnt * 3);

                for (let i = 0; i < particlesCnt * 3; i++) {
                    posArray[i] = (Math.random() - 0.5) * (Math.random() * 5000);
                }
                particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));

                const particlesMaterial = new THREE.PointsMaterial({
                    size: 1.5,
                    color: 0x00A99D, 
                    blending: THREE.AdditiveBlending,
                    transparent: true,
                    opacity: 0.8
                });

                particles = new THREE.Points(particlesGeometry, particlesMaterial);
                scene.add(particles);
                
                document.addEventListener('mousemove', onMouseMove, false);
                window.addEventListener('resize', onWindowResize, false);
                isThreeJSInitialized = true;
            }

            function animate() {
                animationFrameId = requestAnimationFrame(animate);

                const time = Date.now() * 0.00005;
                camera.position.x += (mouseX - camera.position.x) * 0.05;
                camera.position.y += (-mouseY - camera.position.y) * 0.05;
                camera.lookAt(scene.position);

                if (particles) {
                    particles.rotation.x = time * 0.5;
                    particles.rotation.y = time * 0.4;
                }

                if (renderer) renderer.render(scene, camera);
            }

            function startThreeJSAnimation() {
                if (!animationFrameId && isThreeJSInitialized) {
                    animate();
                }
            }
            
            function stopThreeJSAnimation() {
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                }
            }
            
            function onWindowResize() {
                if (!camera || !renderer) return;
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }

            function onMouseMove(event) {
                mouseX = (event.clientX - windowHalfX) * 0.5;
                mouseY = (event.clientY - windowHalfY) * 0.5;
            }



            function getLikedProjects() {
                return JSON.parse(localStorage.getItem('likedProjects')) || [];
            }

            function setLikedProjects(liked) {
                localStorage.setItem('likedProjects', JSON.stringify(liked));
            }

            async function incrementProjectView(projectId) {
                const projectRef = doc(db, 'projects', projectId);
                try {
                    await updateDoc(projectRef, { views: increment(1) });
                } catch(e) {
                    console.error("Error incrementing view:", e);
                }
            }

            async function toggleLike(projectId) {
                const likeButton = document.getElementById('like-btn');
                const likeCountSpan = document.getElementById('like-count');
                if (!likeButton || !likeCountSpan) return;

                let likedProjects = getLikedProjects();
                const projectRef = doc(db, 'projects', projectId);
                let currentLikes = parseInt(likeCountSpan.textContent, 10);

                if (likedProjects.includes(projectId)) {

                    likedProjects = likedProjects.filter(id => id !== projectId);
                    await updateDoc(projectRef, { likes: increment(-1) });
                    likeButton.classList.remove('liked');
                    likeCountSpan.textContent = currentLikes - 1;

                } else {

                    likedProjects.push(projectId);
                    await updateDoc(projectRef, { likes: increment(1) });
                    likeButton.classList.add('liked');
                    likeCountSpan.textContent = currentLikes + 1;
                }
                setLikedProjects(likedProjects);
            }
            

            async function getProjectRecommendations(currentProject) {
                const recommendationsContainer = document.getElementById('project-recommendations-container');
                if (!recommendationsContainer) return;
                

                recommendationsContainer.innerHTML = `
                    <h4 class="text-xl font-bold text-white">You May Also Like</h4>
                    <div class="text-center p-4">
                        <div class="typing-indicator" style="opacity: 0.5;"><span></span><span></span><span></span></div>
                        <p class="text-gray-400 mt-2 text-sm">Generating recommendations with Gemini AI...</p>
                    </div>
                `;


                const otherProjects = myProjects
                    .filter(p => p.id !== currentProject.id)
                    .map(p => ({ title: p.title, description: p.description, tags: p.tags }));

                if (otherProjects.length < 3) {
                     recommendationsContainer.innerHTML = ''; 
                     return;
                }

                const apiKey = "AIzaSyCyuyuxLEWbcl8XIxZRqTDV4kKVc1xY_H8"; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const systemPrompt = `You are an expert portfolio curator. Your task is to recommend three relevant projects from a provided list based on a user's currently viewed project. Analyze the current project's title, description, and tags. Then, from the list of "other projects", select the three that are most similar in style, tools used, or theme.
                
                You MUST respond ONLY with a valid JSON array containing the exact titles of the three recommended projects. Do not include any other text, explanation, or formatting.
                
                Example response:
                ["Project Title A", "Project Title B", "Project Title C"]`;
                
                const userQuery = `Current Project:
                - Title: "${currentProject.title}"
                - Description: "${currentProject.description}"
                - Tags: "${currentProject.tags}"

                List of other projects to choose from:
                ${JSON.stringify(otherProjects, null, 2)}

                Based on the "Current Project", what are the three most relevant projects from the list?`;

                const payload = {
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                    contents: [{ parts: [{ text: userQuery }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                    }
                };


                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API Error: ${response.status}`);
                    }

                    const result = await response.json();
                    const recommendedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (!recommendedText) {
                        throw new Error("No recommendation text received from API.");
                    }

                    const recommendedTitles = JSON.parse(recommendedText);
                    renderRecommendations(recommendedTitles);

                } catch (error) {
                    console.error("Error getting AI recommendations:", error);
                    recommendationsContainer.innerHTML = `
                        <h4 class="text-xl font-bold text-white">You May Also Like</h4>
                        <p class="text-gray-400 text-sm">Could not load recommendations at this time.</p>
                    `;
                }
            }

            function renderRecommendations(titles) {
                const recommendationsContainer = document.getElementById('project-recommendations-container');
                if (!titles || titles.length === 0) {
                    recommendationsContainer.innerHTML = ''; 
                    return;
                }

                const recommendedProjects = titles
                    .map(title => myProjects.find(p => p.title === title))
                    .filter(Boolean); 

                if (recommendedProjects.length === 0) {
                     recommendationsContainer.innerHTML = '';
                     return;
                }

                const recommendationsHTML = recommendedProjects.map(project => `
                    <a href="#" class="recommendation-card block glass-card rounded-lg overflow-hidden p-3 view-project-btn-from-recommendation" data-id="${project.id}">
                        <img src="${project.coverImageUrl}" alt="${project.title}" class="w-full h-24 object-cover rounded-md mb-3">
                        <h5 class="font-bold text-white truncate">${project.title}</h5>
                        <p class="text-xs text-gray-400 truncate">${project.tags || ''}</p>
                    </a>
                `).join('');

                recommendationsContainer.innerHTML = `
                    <h4 class="text-xl font-bold text-white">You May Also Like</h4>
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                        ${recommendationsHTML}
                    </div>
                `;


                document.querySelectorAll('.view-project-btn-from-recommendation').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        const project = myProjects.find(p => p.id === btn.dataset.id);
                        if (project) {
                            showProjectDetailView(project);
                        }
                    });
                });
            }


            const loginModal = document.getElementById('login-modal');
            const closeLoginModalBtn = document.getElementById('close-login-modal-btn');
            const loginModalOverlay = loginModal.querySelector('.login-modal-overlay-bg');
            const loginError = document.getElementById('login-error');
            const googleSignInBtn = document.getElementById('google-signin-btn');

            /* --- LOGIN MODAL DISABLED ---
            function showLoginModal() { if (loginModal) loginModal.classList.remove('modal-hidden'); }
            function hideLoginModal() { if (loginModal) loginModal.classList.add('modal-hidden'); }

            if(loginModal && closeLoginModalBtn && loginModalOverlay) {
                closeLoginModalBtn.addEventListener('click', hideLoginModal);
                loginModalOverlay.addEventListener('click', hideLoginModal);
            }
            */

            if (googleSignInBtn) {
                /* --- GOOGLE SIGN-IN DISABLED ---
                googleSignInBtn.addEventListener('click', () => {
                    loginError.textContent = ''; 
                    const provider = new GoogleAuthProvider();
                    signInWithPopup(auth, provider)
                        .then((result) => {
                            hideLoginModal();
                        }).catch((error) => {
                            console.error("Google Sign-in Error:", error);
                            loginError.textContent = "Could not sign in with Google.";
                        });
                });
                */
            }
            

            const projectModal = document.getElementById('project-modal');
            const projectForm = document.getElementById('project-form');
            const closeProjectModalBtn = document.getElementById('close-project-modal-btn');
            const projectModalOverlay = projectModal.querySelector('.project-modal-overlay-bg');
            const addProjectBtn = document.getElementById('add-project-btn');

            function showProjectModal() { projectModal.classList.remove('modal-hidden'); }
            function hideProjectModal() { projectModal.classList.add('modal-hidden'); }

            addProjectBtn.addEventListener('click', () => {
                editingProjectId = null;
                projectForm.reset();
                document.getElementById('project-id').value = '';
                document.getElementById('project-modal-title').textContent = 'Add New Project';
                document.getElementById('project-submit-btn-text').textContent = 'Add Project';
                showProjectModal();
            });

            closeProjectModalBtn.addEventListener('click', hideProjectModal);
            projectModalOverlay.addEventListener('click', hideProjectModal);

            projectForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const galleryImages = document.getElementById('project-gallery').value
                    .split('\n')
                    .map(url => url.trim())
                    .filter(url => url);

                const projectData = {
                    title: document.getElementById('project-title').value,
                    description: document.getElementById('project-description').value,
                    coverImageUrl: document.getElementById('project-coverImageUrl').value,
                    galleryImages: galleryImages,
                    additionalDetails: document.getElementById('project-additionalDetails').value,
                    url: document.getElementById('project-url').value,
                    downloadUrl: document.getElementById('project-downloadUrl').value,
                    tools: document.getElementById('project-tools').value,
                    tags: document.getElementById('project-tags').value,
                    date: document.getElementById('project-date').value,
                    featured: document.getElementById('project-featured').checked,
                    status: document.getElementById('project-status').value,
                };

                try {
                    if (editingProjectId) {
                        const projectRef = doc(db, 'projects', editingProjectId);
                        await updateDoc(projectRef, projectData);
                    } else {
                        await addDoc(projectsCollection, {...projectData, views: 0, likes: 0, createdAt: serverTimestamp()});
                    }
                    hideProjectModal();
                } catch (error) {
                    console.error("Error saving project:", error);
                    alert("Could not save project. See console for details.");
                }
            });


            const articleModal = document.getElementById('article-modal');
            const articleForm = document.getElementById('article-form');
            const closeArticleModalBtn = document.getElementById('close-article-modal-btn');
            const articleModalOverlay = articleModal.querySelector('.article-modal-overlay-bg');
            const addArticleBtn = document.getElementById('add-article-btn');

            function showArticleModal() { articleModal.classList.remove('modal-hidden'); }
            function hideArticleModal() { articleModal.classList.add('modal-hidden'); }

            if (addArticleBtn) {
                addArticleBtn.addEventListener('click', () => {
                    editingArticleId = null;
                    articleForm.reset();
                    document.getElementById('article-id').value = '';
                    document.getElementById('article-modal-title').textContent = 'Write New Article';
                    document.getElementById('article-submit-btn-text').textContent = 'Publish Article';
                    showArticleModal();
                });
            }
            
            if (closeArticleModalBtn && articleModalOverlay) {
                closeArticleModalBtn.addEventListener('click', hideArticleModal);
                articleModalOverlay.addEventListener('click', hideArticleModal);
            }

            if (articleForm) {
                articleForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const articleData = {
                        title: document.getElementById('article-title').value,
                        coverImageUrl: document.getElementById('article-coverImageUrl').value,
                        tags: document.getElementById('article-tags').value,
                        direction: document.getElementById('article-direction').value,
                        content: document.getElementById('article-content').value,
                    };

                    try {
                        if (editingArticleId) {
                            const articleRef = doc(db, 'articles', editingArticleId);
                            await updateDoc(articleRef, articleData);
                        } else {
                            await addDoc(articlesCollection, {...articleData, createdAt: serverTimestamp()});
                        }
                        hideArticleModal();
                    } catch (error) {
                        console.error("Error saving article:", error);
                        alert("Could not save article. See console for details.");
                    }
                });
            }

            function attachProjectEventListeners() {
                document.querySelectorAll('.edit-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = btn.dataset.id;
                        const project = myProjects.find(p => p.id === id);
                        if (!project) return;
                        
                        editingProjectId = id;
                        
                        document.getElementById('project-id').value = project.id;
                        document.getElementById('project-title').value = project.title || '';
                        document.getElementById('project-description').value = project.description || '';
                        document.getElementById('project-coverImageUrl').value = project.coverImageUrl || '';
                        document.getElementById('project-additionalDetails').value = project.additionalDetails || '';
                        document.getElementById('project-url').value = project.url || '';
                        document.getElementById('project-downloadUrl').value = project.downloadUrl || '';
                        document.getElementById('project-tools').value = project.tools || '';
                        document.getElementById('project-tags').value = project.tags || '';
                        document.getElementById('project-date').value = project.date || '';
                        document.getElementById('project-featured').checked = project.featured || false;
                        
                        let projectStatus = project.status || 'Completed';
                        if (projectStatus === 'Concept') projectStatus = 'Idea';
                        document.getElementById('project-status').value = projectStatus;

                        document.getElementById('project-gallery').value = (project.galleryImages || []).join('\n');
                        
                        document.getElementById('project-modal-title').textContent = 'Edit Project';
                        document.getElementById('project-submit-btn-text').textContent = 'Save Changes';
                        
                        showProjectModal();
                    });
                });

                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.addEventListener('click', async () => {
                        const id = btn.dataset.id;
                        if (confirm('Are you sure you want to delete this project?')) {
                           try {
                                await deleteDoc(doc(db, 'projects', id));
                           } catch(error) {
                                console.error("Error deleting project: ", error);
                                alert("Could not delete project.");
                           }
                        }
                    });
                });
                
                document.querySelectorAll('.view-project-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        renderPage({ view: 'project', id: btn.dataset.id });
                    });
                });
            }

            function attachArticleEventListeners() {
                document.querySelectorAll('.edit-article-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = btn.dataset.id;
                        const article = articlesData.find(a => a.id === id);
                        if (!article) return;
                        
                        editingArticleId = id;
                        
                        document.getElementById('article-id').value = article.id;
                        document.getElementById('article-title').value = article.title || '';
                        document.getElementById('article-coverImageUrl').value = article.coverImageUrl || '';
                        document.getElementById('article-tags').value = article.tags || '';
                        document.getElementById('article-direction').value = article.direction || 'ltr';
                        document.getElementById('article-content').value = article.content || '';
                        
                        document.getElementById('article-modal-title').textContent = 'Edit Article';
                        document.getElementById('article-submit-btn-text').textContent = 'Save Changes';
                        
                        showArticleModal();
                    });
                });

                document.querySelectorAll('.delete-article-btn').forEach(btn => {
                    btn.addEventListener('click', async () => {
                        const id = btn.dataset.id;
                        if (confirm('Are you sure you want to delete this article?')) {
                           try {
                                await deleteDoc(doc(db, 'articles', id));
                           } catch(error) {
                                console.error("Error deleting article: ", error);
                                alert("Could not delete article.");
                           }
                        }
                    });
                });

                document.querySelectorAll('.view-article-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        renderPage({ view: 'article', id: btn.dataset.id });
                    });
                });
            }

            function attachProductEventListeners() {
                 document.querySelectorAll('.view-product-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        renderPage({ view: 'product', id: btn.dataset.id });
                    });
                });

                document.querySelectorAll('.edit-product-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = btn.dataset.id;
                        const product = productsData.find(p => p.id === id);
                        if (product) {
                            showProductAdminModal(product);
                        }
                    });
                });

                document.querySelectorAll('.delete-product-btn').forEach(btn => {
                    btn.addEventListener('click', async () => {
                        const id = btn.dataset.id;
                        if (confirm('Are you sure you want to delete this product?')) {
                            try {
                                await deleteDoc(doc(db, 'products', id));
                            } catch (error) {
                                console.error("Error deleting product:", error);
                                alert("Could not delete product.");
                            }
                        }
                    });
                });
            }

            function attachCertificateEventListeners() {

                document.querySelectorAll('.certificate-card-slider').forEach(card => {
                    card.addEventListener('click', (event) => {
                         if (!event.target.closest('.admin-controls') && card.classList.contains('active')) {
                            const index = parseInt(card.dataset.index, 10);
                            showCertificateGallery(index);
                        }
                    });
                });


                document.querySelectorAll('.edit-certificate-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const id = btn.dataset.id;
                        const cert = certificatesData.find(c => c.id === id);
                        if (cert) {
                            editingCertificateId = id;
                            const form = document.getElementById('certificate-form');
                            form.querySelector('#certificate-id').value = cert.id;
                            form.querySelector('#certificate-title').value = cert.title;
                            form.querySelector('#certificate-imageUrl').value = cert.imageUrl;
                            document.getElementById('certificate-modal-title').textContent = 'Edit Certificate';
                            document.getElementById('certificate-submit-btn-text').textContent = 'Save Changes';
                            showCertificateModal();
                        }
                    });
                });


                document.querySelectorAll('.delete-certificate-btn').forEach(btn => {
                    btn.addEventListener('click', async () => {
                        const id = btn.dataset.id;
                        if (confirm('Are you sure you want to delete this certificate?')) {
                            try {
                                await deleteDoc(doc(db, 'certificates', id));
                            } catch (error) {
                                console.error("Error deleting certificate:", error);
                                alert("Could not delete certificate.");
                            }
                        }
                    });
                });
            }


            const backToHomeBtn = document.getElementById('back-to-home-btn');
            const projectDetailContent = document.getElementById('project-detail-content');
            let galleryKeydownListener = null; 

            function showProjectDetailView(project) {

                projectDetailView.classList.remove('hidden');
                document.title = `${project.title} | Badr Ibraheem`;

                incrementProjectView(project.id);

                window.scrollTo(0, 0);


                const oldSchema = document.getElementById('dynamic-schema-script');
                if(oldSchema) oldSchema.remove();


                const allImages = [project.coverImageUrl];

                const galleryImages = Array.isArray(project.galleryImages) ? project.galleryImages : [];
                if (galleryImages.length > 0) {
                    allImages.push(...galleryImages);
                }

                const projectSchema = {
                    "@context": "https://schema.org",
                    "@type": "CreativeWork",
                    "name": project.title,
                    "description": project.description,
                    "image": allImages.filter(Boolean), 
                    "author": {
                        "@type": "Person",
                        "name": "Badr Ibraheem Mohameed",
                        "url": "https://badre.site/"
                    },
                    "datePublished": project.date,
                    "url": `https://badre.site/#project/${project.id}`
                };

                const videoUrl = project.mediaUrl || project.youtubeUrl;
                if (videoUrl) {
                    try {
                        const urlObj = new URL(videoUrl);
                        const hostname = urlObj.hostname.replace('www.', '');
                        let videoId;
                        let embedUrl;
                        
                        if (hostname === 'youtube.com' || hostname === 'youtu.be') {
                            if (hostname === 'youtu.be') {
                                videoId = urlObj.pathname.substring(1);
                            } else {
                                videoId = urlObj.searchParams.get('v');
                            }
                            if (videoId) {
                                embedUrl = `https://www.youtube.com/embed/${videoId}`;
                                projectSchema.video = {
                                    "@type": "VideoObject",
                                    "name": project.title,
                                    "description": project.description,
                                    "thumbnailUrl": `https://i.ytimg.com/vi/${videoId}/hqdefault.jpg`,
                                    "uploadDate": project.date,
                                    "embedUrl": embedUrl
                                };
                            }
                        } else if (hostname === 'vimeo.com') {
                             videoId = urlObj.pathname.split('/').pop();
                             if(videoId) {
                                 embedUrl = `https://player.vimeo.com/video/${videoId}`;
                                 
                                 projectSchema.video = {
                                    "@type": "VideoObject",
                                    "name": project.title,
                                    "description": project.description,
                                    "thumbnailUrl": project.coverImageUrl,
                                    "uploadDate": project.date,
                                    "embedUrl": embedUrl
                                };
                             }
                        }
                    } catch (e) {
                        console.error("Could not parse video URL for schema:", e);
                    }
                }


                let mediaHTML = '';


                if (project.mediaUrl) {
                    mediaHTML += getMediaEmbedHTML(project.mediaUrl, 'video', project.title);
                }
                

                if (galleryImages.length > 0) {

                    mediaHTML += createGalleryHTML(galleryImages, !!project.mediaUrl, project.title);
                }


                if (!project.mediaUrl && galleryImages.length === 0) {
                    mediaHTML = getMediaEmbedHTML(project.coverImageUrl, 'image', project.title);
                }

                const dateFormatted = project.date ? new Date(project.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long' }) : 'N/A';
                const isLiked = getLikedProjects().includes(project.id);
                
                let actionButtonHTML = '';
                if (project.url) {
                     actionButtonHTML += `
                        <a href="${project.url}" target="_blank" rel="noopener noreferrer" class="submit-btn group w-full justify-center mt-2">
                            <span data-translate-key="projectDetailVisitBtn">Visit Project</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 ml-2 transition-transform duration-300"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
                        </a>
                    `;
                }
                if (project.downloadUrl) {
                    actionButtonHTML += `
                        <a href="${project.downloadUrl}" target="_blank" rel="noopener noreferrer" class="submit-btn group w-full justify-center mt-2" style="background: linear-gradient(to right, #10B981, #34D399); color: white;">
                            <span data-translate-key="projectDetailDownloadBtn">Download</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5 ml-2 transition-transform duration-300"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                        </a>
                    `;
                }
                
                const tagsHTML = project.tags ? project.tags.split(',').map(tag => `<span class="inline-block bg-white/10 text-violet-300 text-xs font-semibold mr-1 mb-1 px-2.5 py-1 rounded-full">${tag.trim()}</span>`).join('') : 'None';
                const toolsHTML = project.tools ? project.tools.split(',').map(tool => `<span class="inline-block bg-white/10 text-gray-300 text-xs font-semibold mr-1 mb-1 px-2.5 py-1 rounded-full">${tool.trim()}</span>`).join('') : 'N/A';
                
                projectDetailContent.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 md:gap-12">
                        <!-- Main Content -->
                        <div class="lg:col-span-2">
                            ${mediaHTML}
                            <div class="mt-8">
                                <h3 class="text-2xl font-bold text-white mb-4" data-translate-key="projectDetailAboutTitle">About This Project</h3>
                                <div class="text-gray-300 leading-relaxed prose prose-invert max-w-none">
                                    ${project.additionalDetails ? project.additionalDetails.replace(/\n/g, '<br>') : 'No additional details provided.'}
                                </div>
                            </div>
                            
                            <!-- AI Recommendations Section -->
                            <div id="project-recommendations-container" class="mt-12"></div>
                        </div>

                        <!-- Sidebar -->
                        <div class="lg:col-span-1">
                            <div class="glass-card p-6 rounded-2xl sticky top-24">
                                <h1 class="text-3xl md:text-4xl font-bold gradient-text mb-4">${project.title}</h1>
                                
                                <div class="space-y-5">
                                    <div>
                                        <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider" data-translate-key="projectDetailDate">Date</h4>
                                        <p class="text-white">${dateFormatted}</p>
                                    </div>
                                     <div>
                                        <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider" data-translate-key="projectDetailStatus">Status</h4>
                                        <p class="text-white">${project.status.replace(/([A-Z])/g, ' $1').trim()}</p>
                                    </div>
                                    <div>
                                        <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider" data-translate-key="projectDetailTools">Tools Used</h4>
                                        <div class="flex flex-wrap mt-1">${toolsHTML}</div>
                                    </div>
                                     <div>
                                        <h4 class="text-sm font-bold text-gray-400 uppercase tracking-wider" data-translate-key="projectDetailTags">Tags</h4>
                                        <div class="flex flex-wrap mt-1">${tagsHTML}</div>
                                    </div>
                                </div>
                                
                                <div class="flex justify-between items-center pt-5 mt-5 border-t border-white/10">
                                    <div class="flex items-center gap-3">
                                         <button class="like-btn ${isLiked ? 'liked' : ''}" id="like-btn" data-id="${project.id}" title="Like">
                                             <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>
                                            <span id="like-count">${project.likes || 0}</span>
                                        </button>
                                        <button class="share-btn" id="share-project-btn" title="Copy Link">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                                        </button>
                                    </div>
                                     <div class="project-stats text-sm">
                                        <div class="flex items-center gap-1" title="Views">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                                            <span id="view-count">${project.views || 0}</span>
                                        </div>
                                    </div>
                                </div>

                                <div class="pt-2">
                                    ${actionButtonHTML}
                                </div>
                            </div>
                        </div>
                    </div>
                `;


                document.getElementById('like-btn')?.addEventListener('click', (e) => {
                    toggleLike(e.currentTarget.dataset.id);
                });


                const shareBtn = document.getElementById('share-project-btn');
                if (shareBtn) {

                    const newShareBtn = shareBtn.cloneNode(true);
                    shareBtn.parentNode.replaceChild(newShareBtn, shareBtn);

                    newShareBtn.addEventListener('click', (e) => {
                        const shareUrl = `${window.location.origin}${window.location.pathname}#project/${project.id}`;
                        navigator.clipboard.writeText(shareUrl).then(() => {
                            const originalHTML = newShareBtn.innerHTML;
                            newShareBtn.classList.add('copied');
                            newShareBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';
                            setTimeout(() => {
                                newShareBtn.classList.remove('copied');
                                newShareBtn.innerHTML = originalHTML;
                            }, 2000);
                        }).catch(err => {
                             console.error('Failed to copy: ', err);
                        });
                    });
                }
                

                if (galleryImages.length > 0) {
                    initGallery(!project.mediaUrl); 
                }
                

                getProjectRecommendations(project);
            }
            
            backToHomeBtn.addEventListener('click', (e) => {
                e.preventDefault();
                renderPage({ view: 'home' });
                window.location.hash = '';
            });



            const backToHomeFromArticleBtn = document.getElementById('back-to-home-from-article-btn');
            const articleDetailContent = document.getElementById('article-detail-content');
                const articleDetailAdminControls = document.getElementById('article-detail-admin-controls');

            if(backToHomeFromArticleBtn) {
                backToHomeFromArticleBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    renderPage({ view: 'home' });
                    window.location.hash = '';
                });
            }


            async function getArticleRecommendations(currentArticle) {
                const recommendationsContainer = document.getElementById('article-recommendations-container');
                if (!recommendationsContainer) return;
                

                recommendationsContainer.innerHTML = `
                    <h4 class="text-xl font-bold text-white">Related Articles</h4>
                    <div class="text-center p-4">
                        <div class="typing-indicator" style="opacity: 0.5;"><span></span><span></span><span></span></div>
                        <p class="text-gray-400 mt-2 text-sm">Finding similar articles with Gemini AI...</p>
                    </div>
                `;


                const otherArticles = articlesData
                    .filter(a => a.id !== currentArticle.id)
                    .map(a => ({ 
                        id: a.id, 
                        title: a.title, 
                        tags: a.tags, 
                        coverImageUrl: a.coverImageUrl, 
                        content: a.content ? a.content.substring(0, 200) + '...' : '', 
                        createdAt: a.createdAt?.toDate ? a.createdAt.toDate().toISOString().split('T')[0] : 'N/A' 
                    }));

                if (otherArticles.length < 3) {
                     recommendationsContainer.innerHTML = ''; 
                     return;
                }

                const apiKey = "AIzaSyCyuyuxLEWbcl8XIxZRqTDV4kKVc1xY_H8"; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const systemPrompt = `You are an expert blog editor. Your task is to recommend three relevant articles from a provided list based on a user's currently viewed article.
                
                1.  Analyze the current article's title and tags.
                2.  From the list of "other articles", select the three that are most similar in topic or theme.
                3.  For each recommended article, you MUST:
                    a.  Provide its exact \`id\`, \`title\`, and \`coverImageUrl\`.
                    b.  Generate a **very brief, one-sentence description** (max 15 words) based on its \`content\` snippet.
                    c.  Provide its publication date (\`createdAt\`).

                You MUST respond ONLY with a valid JSON array adhering to this schema. Do not include any other text.
                
                JSON Schema:
                [
                  {
                    "type": "article",
                    "id": "The unique ID of the item",
                    "title": "The title of the item",
                    "coverImageUrl": "The cover image URL",
                    "description": "A very short, 15-word max summary of the article.",
                    "date": "The publication date (e.g., 2024-10-25)"
                  }
                ]`;
                
                const userQueryForApi = `WEBSITE CONTENT:
- Other Articles: ${JSON.stringify(otherArticles)}

USER IS VIEWING:
- Current Article: { title: "${currentArticle.title}", tags: "${currentArticle.tags}" }

Based on the "Current Article", select the three most relevant from "Other Articles" and format them according to the schema.`;


                const payload = {
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                    contents: [{ parts: [{ text: userQueryForApi }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "ARRAY",
                            items: {
                                type: "OBJECT",
                                properties: {
                                    type: { type: "STRING" },
                                    id: { type: "STRING" },
                                    title: { type: "STRING" },
                                    coverImageUrl: { type: "STRING" },
                                    description: { type: "STRING" }, 
                                    date: { type: "STRING" }          
                                },
                                required: ["type", "id", "title", "description", "date"] 
                            }
                        }
                    }
                };


                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API Error: ${response.status}`);
                    }

                    const result = await response.json();
                    const recommendedText = result.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (!recommendedText) {
                        throw new Error("No recommendation text received from API.");
                    }

                    const recommendedTitles = JSON.parse(recommendedText);
                    renderArticleRecommendations(recommendedTitles);

                } catch (error) {
                    console.error("Error getting AI article recommendations:", error);
                    recommendationsContainer.innerHTML = `
                        <h4 class="text-xl font-bold text-white">Related Articles</h4>
                        <p class="text-gray-400 text-sm">Could not load recommendations at this time.</p>
                    `;
                }
            }

            function renderArticleRecommendations(titles) {
                const recommendationsContainer = document.getElementById('article-recommendations-container');
                if (!titles || titles.length === 0) {
                    recommendationsContainer.innerHTML = '';  
                    return;
                }

                const recommendedArticles = titles; 

                if (recommendedArticles.length === 0) {
                     recommendationsContainer.innerHTML = '';
                     return;
                }

                const recommendationsHTML = recommendedArticles.map(article => {
                    const placeholderImg = `https://placehold.co/80x50/2B2729/988381?text=${article.title.substring(0,1)}`;
                    const coverImg = article.coverImageUrl ? `<img src="${article.coverImageUrl}" alt="${article.title}" onerror="this.src='${placeholderImg}'">` : `<img src="${placeholderImg}" alt="${article.title}">`;
                    
 
                    let dateFormatted = 'N/A';
                    try {
 
                        dateFormatted = new Date(article.date).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
                    } catch(e) { dateFormatted = article.date; }  
                    
                    return `
                        <a href="#" class="article-recommendation-card view-article-btn-from-recommendation" data-id="${article.id}">
                            ${coverImg}
                            <div class="article-recommendation-card-info">
                                <h5>${article.title}</h5>
                                <p class="article-recommendation-desc">${article.description}</p>
                                <p class="article-recommendation-date">${dateFormatted}</p>
                            </div>
                        </a>
                    `;
                }).join('');


                recommendationsContainer.innerHTML = `
                    <h4 class="text-xl font-bold text-white">Related Articles</h4>
                    <div class="flex flex-col gap-4">
                        ${recommendationsHTML}
                    </div>
                `;

 
                document.querySelectorAll('.view-article-btn-from-recommendation').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        const article = articlesData.find(a => a.id === btn.dataset.id);
                        if (article) {
                            showArticleDetailView(article);
                        }
                    });
                });
            }



            function renderArticleContent(text) {
                if (!text) return '';


                return text.split(/\n\n+/).map(block => {
                    block = block.trim();
                    if (!block) return '';


                    let formattedBlock = block
                        .replace(/\*\*(.*?)\*\*/g, '<strong class="text-white font-bold">$1</strong>')
                        .replace(/\*(.*?)\*/g, '<em class="text-gray-200">$1</em>');


                    if (block.startsWith('# ')) {
                        return `<h2 class="text-3xl md:text-4xl font-bold gradient-text mt-16 mb-8 pb-4 border-b border-white/10">${formattedBlock.substring(2)}</h2>`;
                    }

                    if (block.startsWith('## ')) {
                        return `<h3 class="text-2xl md:text-3xl font-bold text-white mt-10 mb-6">${formattedBlock.substring(3)}</h3>`;
                    }

                    if (block.startsWith('### ')) {
                        return `<h4 class="text-xl md:text-2xl font-bold text-white/90 mt-8 mb-4">${formattedBlock.substring(4)}</h4>`;
                    }

                    if (block.startsWith('- ')) {

                        const listItems = formattedBlock.split('\n').map(item => {
                            return item.trim().startsWith('- ') 
                                ? `<li class="mb-3 pl-2">${item.trim().substring(2)}</li>` 
                                : item;
                        }).join('');
                        return `<ul class="list-disc pl-8 text-gray-300 mb-8 space-y-2 marker:text-[var(--accent-color)]">${listItems}</ul>`;
                    }


                    return `<p class="text-gray-300 leading-relaxed mb-8 text-lg">${formattedBlock.replace(/\n/g, '<br>')}</p>`;
                }).join('');
            }

            function showArticleDetailView(article) {

                articleDetailView.classList.remove('hidden');
                document.title = `${article.title} | Badr Ibraheem's Blog`;
                window.scrollTo(0, 0);


                readingProgressBar.style.display = 'block';
                window.addEventListener('scroll', updateReadingProgress, { passive: true });

                setTimeout(updateReadingProgress, 100); 


                const oldSchema = document.getElementById('dynamic-schema-script');
                if(oldSchema) oldSchema.remove();
                
                const articleSchema = {
                    "@context": "https://schema.org",
                    "@type": "Article",
                    "headline": article.title,
                    "author": {
                        "@type": "Person",
                        "name": "Badr Ibraheem Mohameed",
                        "url": "https://badre.site/"
                    },
                    "datePublished": article.createdAt?.toDate ? article.createdAt.toDate().toISOString() : new Date().toISOString(),
                    "image": article.coverImageUrl || "https://badre.site/images/50.webp"
                };
                const schemaScript = document.createElement('script');
                schemaScript.type = 'application/ld+json';
                schemaScript.id = 'dynamic-schema-script';
                schemaScript.text = JSON.stringify(articleSchema);
                document.head.appendChild(schemaScript);


                if (document.body.classList.contains('logged-in')) {
                    articleDetailAdminControls.innerHTML = `
                        <button class="admin-btn edit-article-btn" data-id="${article.id}" aria-label="Edit Article" title="Edit" data-translate-title="tooltipAdminEdit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg></button>
                        <button class="admin-btn delete-article-btn delete" data-id="${article.id}" aria-label="Delete Article" title="Delete" data-translate-title="tooltipAdminDelete"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg></button>
                    `;

                    attachArticleEventListeners(); 
                } else {
                    articleDetailAdminControls.innerHTML = '';
                }

                const wordCount = article.content.trim().split(/\s+/).length;
                const readTime = Math.ceil(wordCount / 200); 
                const dateFormatted = article.createdAt?.toDate ? new Date(article.createdAt.toDate()).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) : 'N/A';
                const tagsHTML = article.tags ? article.tags.split(',').map(tag => `<span class="inline-block border border-[var(--border-primary)] bg-white/5 text-gray-300 text-sm font-medium mr-2 mb-2 px-4 py-1.5 rounded-full">#${tag.trim()}</span>`).join('') : '';
                const coverImageHTML = article.coverImageUrl ? `<div class="max-w-5xl mx-auto mb-12 md:mb-16"><img src="${article.coverImageUrl}" alt="الصورة الرئيسية لمقال: ${article.title}" class="w-full h-auto max-h-[600px] object-cover rounded-3xl shadow-2xl" loading="lazy"></div>` : '';


                articleDetailContent.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 md:gap-12">
                        <!-- Main Article Content -->
                        <div class="lg:col-span-2">
                            <header class="text-center max-w-4xl mx-auto mb-12 md:mb-16">
                                <h1 class="text-4xl md:text-5xl lg:text-6xl font-black text-[var(--text-primary-color)] mb-8 leading-tight">${article.title}</h1>
                                <div class="flex flex-wrap items-center justify-center gap-4 md:gap-8 text-gray-400 text-sm md:text-base">
                                    <div class="flex items-center gap-3">
                                        <img src="https://badre.site/images/50.webp" alt="Badr Ibraheem" class="w-10 h-10 rounded-full object-cover ring-2 ring-[var(--accent-color)]">
                                        <span class="font-medium text-[var(--text-primary-color)]">Badr Ibraheem</span>
                                    </div>
                                    <span class="hidden md:block">•</span>
                                    <time class="flex items-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                                        ${dateFormatted}
                                    </time>
                                    <span class="hidden md:block">•</span>
                                    <span class="flex items-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                        ${readTime} min read
                                    </span>
                                </div>
                            </header>

                            ${coverImageHTML}

                            <article class="max-w-3xl mx-auto">
                                <!-- Use standard div instead of prose class for custom parsed content -->
                                <div class="article-body text-gray-300 leading-relaxed" dir="${article.direction || 'ltr'}">
                                    ${renderArticleContent(article.content)}
                                </div>
                                
                                <footer class="mt-16 pt-8 border-t border-white/10">
                                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
                                        <div>
                                            <h4 class="text-lg font-bold text-white mb-4">Tags</h4>
                                            <div class="flex flex-wrap">${tagsHTML}</div>
                                        </div>
                                        <button class="share-btn self-start md:self-auto" id="share-article-btn" title="Copy Article Link" style="width: auto; padding: 0.5rem 1rem; gap: 0.5rem;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                                            <span>Share Article</span>
                                        </button>
                                    </div>
                                </footer>
                            </article>
                        </div>
                        
                        <!-- NEW: Article Recommendations Sidebar -->
                        <aside class="lg:col-span-1 lg:pl-8">
                            <div class="sticky top-24">
                                <div id="article-recommendations-container" class="mt-16 lg:mt-0">
                                    <!-- AI Recommendations will be injected here -->
                                </div>
                            </div>
                        </aside>
                    </div>
                `;
                 applyTheme(localStorage.getItem('theme')); 
                 translatePage(getCookie('selected_language') || 'en');


                 const shareArticleBtn = document.getElementById('share-article-btn');
                 if (shareArticleBtn) {
                    shareArticleBtn.addEventListener('click', () => {

                        const shareUrl = `${window.location.origin}${window.location.pathname}#article/${article.id}`;
                        
                        navigator.clipboard.writeText(shareUrl).then(() => {
                            const originalHTML = shareArticleBtn.innerHTML;
                            shareArticleBtn.classList.add('copied');
                            shareArticleBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> <span>Copied Link!</span>';
                            setTimeout(() => {
                                shareArticleBtn.classList.remove('copied');
                                shareArticleBtn.innerHTML = originalHTML;
                            }, 2000);
                        });
                    });
                 }
                 

                 getArticleRecommendations(article);
            }


            function showProductDetailView(product) {
                productDetailView.classList.remove('hidden');
                document.title = `${product.name} | Badr's Store`;
                window.scrollTo(0, 0);

                const productDetailContent = document.getElementById('product-detail-content');
                if (!productDetailContent) return;


                let unifiedMedia = [];
                if (product.youtubeUrl) {
                    try {
                        const url = new URL(product.youtubeUrl);
                        let videoId = url.searchParams.get('v');
                        if (url.hostname === 'youtu.be') {
                            videoId = url.pathname.substring(1);
                        }
                        if (videoId) {
                             unifiedMedia.push({
                                type: 'youtube',
                                videoId: videoId,
                                thumbnailUrl: `https://img.youtube.com/vi/${videoId}/hqdefault.jpg`
                            });
                        }
                    } catch(e) { console.error("Invalid YouTube URL", e); }
                }
                if (product.media && product.media.length > 0) {
                    product.media.forEach(item => {
                        if (item.type === 'image') {
                            unifiedMedia.push({ type: 'image', url: item.url, thumbnailUrl: item.url });
                        }
                    });
                }
                
                const hasMedia = unifiedMedia.length > 0;


                const slidesHTML = hasMedia
                    ? unifiedMedia.map((item, index) => {
                        if (item.type === 'youtube') {
                            return `<div class="product-media-slide" data-index="${index}" data-media-type="youtube">
                                        <iframe src="https://www.youtube.com/embed/${item.videoId}?enablejsapi=1" 
                                                frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                                allowfullscreen></iframe>
                                    </div>`;
                        }
                        return `<div class="product-media-slide" data-index="${index}" data-media-type="image" data-media-url="${item.url}">
                                    <img src="${item.url}" alt="${product.name} - Image ${index + 1}">
                                </div>`;
                    }).join('')
                    : `<div class="product-media-slide active" data-index="0" data-media-type="image">
                           <img src="https://placehold.co/600x400/0D0D0D/FFD700?text=No+Media" alt="Placeholder">
                       </div>`;

                const galleryNavHTML = hasMedia && unifiedMedia.length > 1 ? `
                    <button id="product-gallery-prev" class="slider-btn absolute top-1/2 -translate-y-1/2 left-0 sm:-left-4 z-30 disabled"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg></button>
                    <button id="product-gallery-next" class="slider-btn absolute top-1/2 -translate-y-1/2 right-0 sm:-right-4 z-30"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg></button>
                ` : '';
                
                const tagsHTML = product.tags 
                    ? product.tags.split(',').map(tag => 
                        `<span class="inline-block border border-[var(--border-primary)] bg-white/5 text-gray-300 text-sm font-medium mr-2 mb-2 px-4 py-1.5 rounded-full">#${tag.trim()}</span>`
                      ).join('')
                    : '';


                productDetailContent.innerHTML = `
                    <div class="max-w-7xl mx-auto">
                        <!-- Media Slider Section -->
                        <div class="relative h-[300px] sm:h-[400px] md:h-[550px] flex items-center justify-center mb-12">
                             <div id="product-media-slider-container">
                                ${slidesHTML}
                            </div>
                            ${galleryNavHTML}
                        </div>

                        <!-- Details Section -->
                        <div class="max-w-4xl mx-auto">
                            <h1 class="text-4xl md:text-5xl font-bold text-white mb-4">${product.name}</h1>
                            <div class="flex flex-wrap mb-8">
                                ${tagsHTML}
                            </div>
                            <h2 class="text-2xl font-bold gradient-text mb-4" data-translate-key="productDescriptionTitle">Description</h2>
                            <p class="text-gray-300 leading-relaxed mb-12">${product.description.replace(/\n/g, '<br>')}</p>
                            
                            <!-- Price and Order Section -->
                            <div class="border border-[var(--border-primary)] p-6 rounded-2xl">
                                <p class="text-sm text-gray-400 mb-2">${product.category}</p>
                                <div class="text-4xl md:text-5xl font-bold text-white mb-6">
                                    <span>${product.currency || 'EGP'} ${product.price}</span>
                                </div>
                                <div class="flex flex-col sm:flex-row gap-4">
                                    <a href="https://wa.me/201069913150?text=Hello, I'm interested in the product: ${encodeURIComponent(product.name)} (${window.location.href})" target="_blank" rel="noopener noreferrer" class="submit-btn group w-full justify-center flex-grow text-center">
                                        <span data-translate-key="orderViaWhatsApp">Order via WhatsApp</span>
                                        <svg class="w-5 h-5 ml-2" fill="currentColor" viewBox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.894 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 4.316 1.905 6.03l-.419 1.533 1.519-.4zM9.5 14.5c-.042-.124-.125-.195-.27-.295-.145-.1-.315-.148-.43-.153s-.24-.008-.344.092c-.105.1-.33.34-.438.465-.108.125-.216.25-.324.375s-.24.165-.368.125c-.128-.04-.547-.21-1.046-.595s-.863-.835-1.19-1.16c-.27-.27-.504-.635-.504-.975s.25-.56.375-.75c.125-.19.25-.31.375-.435s.125-.24.062-.375c-.062-.125-.562-1.345-.75-1.845-.19-.5-.375-.435-.5-.435s-.24-.008-.344.092c-.105.1-.33.34-.438.465s-.33.375-.438.635c-.108.25-.165.56-.165.875s.125 1.19.25 1.435c.125.25.562.935 1.312 1.688s1.438 1.19 2.188 1.5s1.19.438 1.562.438c.312 0 .562-.062.75-.125s.562-.625.625-.75c.062-.125.062-.25.062-.31s-.062-.125-.125-.19c0-.062-.042-.125-.062-.165z"/></svg>
                                    </a>
                                    <button id="share-product-btn" class="share-btn" style="width: auto; padding: 0 1.5rem; gap: 0.5rem; border-radius: 9999px; height: auto;">
                                         <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                                         <span>Share</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                

                initProductMediaSlider(unifiedMedia.length);


                const shareProductBtn = document.getElementById('share-product-btn');
                if (shareProductBtn) {
                    shareProductBtn.addEventListener('click', () => {

                        const shareUrl = `${window.location.origin}${window.location.pathname}#product/${product.id}`;

                        navigator.clipboard.writeText(shareUrl).then(() => {
                            const originalHTML = shareProductBtn.innerHTML;
                            shareProductBtn.classList.add('copied');
                            shareProductBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg> <span>Copied!</span>';
                            setTimeout(() => {
                                shareProductBtn.classList.remove('copied');
                                shareProductBtn.innerHTML = originalHTML;
                            }, 2000);
                        });
                    });
                }
            }


            function initProductMediaSlider(mediaCount) {
                const sliderContainer = document.getElementById('product-media-slider-container');
                const prevBtn = document.getElementById('product-gallery-prev');
                const nextBtn = document.getElementById('product-gallery-next');
                if (!sliderContainer || mediaCount <= 1) {
                    if(prevBtn) prevBtn.style.display = 'none';
                    if(nextBtn) nextBtn.style.display = 'none';
                    return;
                }
                
                let currentIndex = 0;

                function updateSlider() {
                    const slides = sliderContainer.querySelectorAll('.product-media-slide');
                    slides.forEach((slide, i) => {
                        slide.classList.remove('active', 'prev', 'next', 'hidden-prev', 'hidden-next');
                        const index = parseInt(slide.dataset.index, 10);

                        if (index === currentIndex) {
                            slide.classList.add('active');

                            if (slide.dataset.mediaType === 'image') {
                                slide.onclick = () => showLightbox(slide.dataset.mediaUrl, 'Enlarged product image');
                            } else {
                                slide.onclick = null; 
                            }
                        } else if (index === currentIndex - 1) {
                            slide.classList.add('prev');
                             slide.onclick = null;
                        } else if (index === currentIndex + 1) {
                            slide.classList.add('next');
                             slide.onclick = null;
                        } else if (index < currentIndex - 1) {
                            slide.classList.add('hidden-prev');
                             slide.onclick = null;
                        } else if (index > currentIndex + 1) {
                            slide.classList.add('hidden-next');
                             slide.onclick = null;
                        }
                    });
                    
                    prevBtn.classList.toggle('disabled', currentIndex === 0);
                    nextBtn.classList.toggle('disabled', currentIndex === mediaCount - 1);
                }

                prevBtn.addEventListener('click', () => {
                    if (currentIndex > 0) {
                        currentIndex--;
                        updateSlider();
                    }
                });

                nextBtn.addEventListener('click', () => {
                    if (currentIndex < mediaCount - 1) {
                        currentIndex++;
                        updateSlider();
                    }
                });

                updateSlider(); 
            }


            const certificateModal = document.getElementById('certificate-modal');
            const certificateForm = document.getElementById('certificate-form');
            const closeCertificateModalBtn = document.getElementById('close-certificate-modal-btn');
            const certificateModalOverlay = certificateModal.querySelector('.certificate-modal-overlay-bg');
            const addCertificateBtn = document.getElementById('add-certificate-btn');
            
            const galleryModal = document.getElementById('certificate-gallery-modal');
            const galleryImage = document.getElementById('certificate-gallery-image');
            const galleryTitle = document.getElementById('certificate-gallery-title');
            const closeGalleryBtn = document.getElementById('close-certificate-gallery-btn');
            const prevGalleryBtn = document.getElementById('certificate-gallery-prev');
            const nextGalleryBtn = document.getElementById('certificate-gallery-next');
            let currentCertificateIndex = 0;
            let currentCertificateSlideIndex = 0;
            let certificateTouchStartX = 0;
            let certificateTouchEndX = 0;

            function showCertificateModal() { if(certificateModal) certificateModal.classList.remove('modal-hidden'); }
            function hideCertificateModal() { if(certificateModal) certificateModal.classList.add('modal-hidden'); }
            
            function showCertificateGallery(index) {
                if (certificatesData.length === 0) return;
                currentCertificateIndex = index;
                updateCertificateGalleryView();
                galleryModal.classList.remove('modal-hidden');
                 document.addEventListener('keydown', handleGalleryKeyPress);
            }

            function hideCertificateGallery() {
                galleryModal.classList.add('modal-hidden');
                document.removeEventListener('keydown', handleGalleryKeyPress);
            }

            function updateCertificateGalleryView() {
                const cert = certificatesData[currentCertificateIndex];
                galleryImage.src = cert.imageUrl;
                galleryImage.alt = cert.title;
                galleryTitle.textContent = cert.title;
                prevGalleryBtn.classList.toggle('disabled', currentCertificateIndex === 0);
                nextGalleryBtn.classList.toggle('disabled', currentCertificateIndex === certificatesData.length - 1);
            }
            
            function handleGalleryKeyPress(e) {
                if (e.key === 'ArrowRight') nextGalleryBtn.click();
                if (e.key === 'ArrowLeft') prevGalleryBtn.click();
                if (e.key === 'Escape') hideCertificateGallery();
            }

            if (addCertificateBtn) {
                addCertificateBtn.addEventListener('click', () => {
                    editingCertificateId = null;
                    certificateForm.reset();
                    document.getElementById('certificate-modal-title').textContent = 'Add Certificate';
                    document.getElementById('certificate-submit-btn-text').textContent = 'Add Certificate';
                    showCertificateModal();
                });
            }

            if(closeCertificateModalBtn && certificateModalOverlay) {
                closeCertificateModalBtn.addEventListener('click', hideCertificateModal);
                certificateModalOverlay.addEventListener('click', hideCertificateModal);
            }
            if(galleryModal) {
                 closeGalleryBtn.addEventListener('click', hideCertificateGallery);
                 galleryModal.querySelector('.certificate-gallery-overlay').addEventListener('click', hideCertificateGallery);
                 prevGalleryBtn.addEventListener('click', () => {
                    if (currentCertificateIndex > 0) {
                        showCertificateGallery(currentCertificateIndex - 1);
                    }
                 });
                 nextGalleryBtn.addEventListener('click', () => {
                    if (currentCertificateIndex < certificatesData.length - 1) {
                        showCertificateGallery(currentCertificateIndex + 1);
                    }
                 });
            }

            if (certificateForm) {
                certificateForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const certificateData = {
                        title: document.getElementById('certificate-title').value,
                        imageUrl: document.getElementById('certificate-imageUrl').value,
                    };
                    try {
                        if (editingCertificateId) {
                            await updateDoc(doc(db, 'certificates', editingCertificateId), certificateData);
                        } else {
                            await addDoc(certificatesCollection, { ...certificateData, createdAt: serverTimestamp() });
                        }
                        hideCertificateModal();
                    } catch (error) {
                        console.error("Error saving certificate:", error);
                        alert("Could not save certificate.");
                    }
                });
            }

            const productAdminModal = document.getElementById('product-admin-modal');
            const productAdminForm = document.getElementById('product-admin-form');
            const closeProductAdminModalBtn = document.getElementById('close-product-admin-modal-btn');
            const productAdminModalOverlay = productAdminModal.querySelector('.product-admin-modal-overlay-bg');
            const addProductBtn = document.getElementById('add-product-btn');

            function showProductAdminModal(product = null) {
                editingProductId = product ? product.id : null;
                productAdminForm.reset();
                if (product) {
                    document.getElementById('product-admin-modal-title').textContent = 'Edit Product';
                    document.getElementById('product-admin-submit-btn-text').textContent = 'Save Changes';
                    document.getElementById('product-admin-id').value = product.id;
                    document.getElementById('product-admin-name').value = product.name;
                    document.getElementById('product-admin-category').value = product.category;
                    document.getElementById('product-admin-tags').value = product.tags || '';
                    document.getElementById('product-admin-price').value = product.price;
                    document.getElementById('product-admin-currency').value = product.currency || 'EGP';
                    document.getElementById('product-admin-description').value = product.description;
                    document.getElementById('product-admin-youtube').value = product.youtubeUrl || ''; // Add this line
                    const mediaText = (product.media || []).filter(item => item.type === 'image').map(item => item.url).join('\n');
                    document.getElementById('product-admin-media').value = mediaText;
                } else {
                    document.getElementById('product-admin-modal-title').textContent = 'Add New Product';
                    document.getElementById('product-admin-submit-btn-text').textContent = 'Add Product';
                }
                productAdminModal.classList.remove('modal-hidden');
            }

            function hideProductAdminModal() {
                productAdminModal.classList.add('modal-hidden');
            }

            if (addProductBtn) addProductBtn.addEventListener('click', () => showProductAdminModal());
            if (closeProductAdminModalBtn) closeProductAdminModalBtn.addEventListener('click', hideProductAdminModal);
            if (productAdminModalOverlay) productAdminModalOverlay.addEventListener('click', hideProductAdminModal);

            if (productAdminForm) {
                productAdminForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    const mediaText = document.getElementById('product-admin-media').value;
                    const media = mediaText.split('\n')
                        .map(line => line.trim())
                        .filter(line => line)
                        .map(line => {

                            return { type: 'image', url: line };
                        });

                    const productData = {
                        name: document.getElementById('product-admin-name').value,
                        category: document.getElementById('product-admin-category').value,
                        tags: document.getElementById('product-admin-tags').value,
                        price: parseFloat(document.getElementById('product-admin-price').value),
                        currency: document.getElementById('product-admin-currency').value,
                        description: document.getElementById('product-admin-description').value,
                        youtubeUrl: document.getElementById('product-admin-youtube').value.trim(), // Get YouTube URL
                        media: media,
                    };

                    try {
                        if (editingProductId) {
                            await updateDoc(doc(db, 'products', editingProductId), productData);
                        } else {
                            await addDoc(productsCollection, { ...productData, createdAt: serverTimestamp() });
                        }
                        hideProductAdminModal();
                    } catch (error) {
                        console.error("Error saving product:", error);
                        alert("Could not save product.");
                    }
                });
            }



            const prevCertificateBtn = document.getElementById('prev-certificate-slide');
            const nextCertificateBtn = document.getElementById('next-certificate-slide');
            
            function updateCertificatesSlider() {
                const cards = document.querySelectorAll('.certificate-card-slider');
                cards.forEach((card, i) => {
                    card.classList.remove('active', 'prev', 'next', 'hidden-prev', 'hidden-next');
                    const index = parseInt(card.dataset.index);
                    if (index === currentCertificateSlideIndex) {
                        card.classList.add('active');
                    } else if (index === currentCertificateSlideIndex - 1) {
                        card.classList.add('prev');
                    } else if (index === currentCertificateSlideIndex + 1) {
                        card.classList.add('next');
                    } else if (index < currentCertificateSlideIndex -1) {
                        card.classList.add('hidden-prev');
                    } else if (index > currentCertificateSlideIndex + 1) {
                        card.classList.add('hidden-next');
                    }
                });
            }

            function updateCertificatesSliderButtons() {
                if (!prevCertificateBtn || !nextCertificateBtn) return;
                prevCertificateBtn.classList.toggle('disabled', currentCertificateSlideIndex === 0);
                nextCertificateBtn.classList.toggle('disabled', currentCertificateSlideIndex >= certificatesData.length - 1);
            }

            if(prevCertificateBtn && nextCertificateBtn){
                prevCertificateBtn.addEventListener('click', () => {
                    if (currentCertificateSlideIndex > 0) {
                        currentCertificateSlideIndex--;
                        updateCertificatesSlider();
                        updateCertificatesSliderButtons();
                    }
                });

                nextCertificateBtn.addEventListener('click', () => {
                    if (currentCertificateSlideIndex < certificatesData.length - 1) {
                        currentCertificateSlideIndex++;
                        updateCertificatesSlider();
                        updateCertificatesSliderButtons();
                    }
                });

                const certificatesSliderContainer = document.getElementById('certificates-slider-container');
                if (certificatesSliderContainer) {
                    certificatesSliderContainer.addEventListener('touchstart', e => {
                        certificateTouchStartX = e.changedTouches[0].screenX;
                    }, { passive: true });

                    certificatesSliderContainer.addEventListener('touchend', e => {
                        certificateTouchEndX = e.changedTouches[0].screenX;
                        handleCertificateSwipe();
                    }, { passive: true });
                }

                function handleCertificateSwipe() {
                    const swipeThreshold = 50; 
                    if (certificateTouchEndX < certificateTouchStartX - swipeThreshold) {

                        nextCertificateBtn.click();
                    }
                    if (certificateTouchEndX > certificateTouchStartX + swipeThreshold) {

                        prevCertificateBtn.click();
                    }
                }
            }


            function createGalleryHTML(images, thumbnailsOnly = false, title = "Project") {
                const thumbsHTML = images.map((img, index) => `<img src="${img}" alt="صورة مصغرة ${index + 1} لمشروع ${title}" class="gallery-thumb ${index === 0 && !thumbnailsOnly ? 'active' : ''}" data-index="${index}" loading="lazy" width="80" height="60">`).join('');

                if (thumbnailsOnly) {
                     return `<div class="gallery-thumbs mt-0">${thumbsHTML}</div>`;
                }

                return `
                    <div class="gallery-container">
                        <div class="gallery-main-image">
                            <img src="${images[0]}" alt="صورة المعرض الرئيسية لمشروع: ${title}" loading="lazy">
                        </div>
                        <div class="gallery-nav">
                            <button id="gallery-prev"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg></button>
                            <button id="gallery-next"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg></button>
                        </div>
                        <div class="gallery-thumbs">${thumbsHTML}</div>
                    </div>
                `;
            }

            function initGallery(isFullGallery = true) {
                 const thumbs = document.querySelectorAll('.gallery-thumb');
                if (!isFullGallery) {
                    thumbs.forEach(thumb => {
                         thumb.addEventListener('click', () => showLightbox(thumb.src, thumb.alt));
                    });
                    return;
                }

                const mainImageContainer = document.querySelector('.gallery-main-image');
                if (!mainImageContainer) return;
                const mainImage = mainImageContainer.querySelector('img');
                const prevBtn = document.getElementById('gallery-prev');
                const nextBtn = document.getElementById('gallery-next');
                let currentIndex = 0;

                function updateGallery(index) {
                    if (index < 0) {
                        index = thumbs.length - 1;
                    } else if (index >= thumbs.length) {
                        index = 0;
                    }
                    mainImage.src = thumbs[index].src;
                    mainImage.alt = thumbs[index].alt; 
                    thumbs.forEach(t => t.classList.remove('active'));
                    thumbs[index].classList.add('active');
                    currentIndex = index;
                }

                const showNext = () => updateGallery(currentIndex + 1);
                const showPrev = () => updateGallery(currentIndex - 1);

                thumbs.forEach(thumb => {
                    thumb.addEventListener('click', () => updateGallery(parseInt(thumb.dataset.index)));
                });
                
                mainImageContainer.style.cursor = 'pointer';
                mainImageContainer.addEventListener('click', () => {
                    showLightbox(mainImage.src, mainImage.alt);
                });
                
                prevBtn.addEventListener('click', showPrev);
                nextBtn.addEventListener('click', showNext);


                if (galleryKeydownListener) {
                    document.removeEventListener('keydown', galleryKeydownListener);
                }

                galleryKeydownListener = (e) => {

                    if (!projectDetailView.classList.contains('hidden')) {
                        if (e.key === 'ArrowRight') {
                            showNext();
                        } else if (e.key === 'ArrowLeft') {
                            showPrev();
                        }
                    }
                };

                document.addEventListener('keydown', galleryKeydownListener);
            }



            function showSearchUI() {
                searchModal.classList.add('visible');

                setTimeout(() => searchInput.focus(), 50);
            }

            function hideSearchUI() {
                searchModal.classList.remove('visible');
                searchInput.blur();
            }

            function showSearchResultsView(query) {

                searchResultsView.classList.remove('hidden');
                document.querySelector('#search-results-view h2').textContent = `Search Results`;
                document.getElementById('search-query-display').innerHTML = `Showing results for: <strong class="text-white">"${escapeHTML(query)}"</strong>`;
                window.scrollTo(0, 0);
            }

            function hideSearchResultsView() {

                mainContent.classList.remove('hidden');
                searchResultsView.classList.add('hidden');
                searchInput.value = '';
            }

            async function getAiSummaryAndSuggestions(query) {
                aiSearchAnswerContainer.innerHTML = `
                    <div class="text-center p-4 glass-card rounded-lg">
                        <div class="typing-indicator" style="opacity: 0.5;"><span></span><span></span><span></span></div>
                        <p class="text-gray-400 mt-2 text-sm">Generating AI summary for "${escapeHTML(query)}"...</p>
                    </div>
                `;

                const projectsContext = myProjects.map(p => ({ title: p.title, description: p.description, tags: p.tags })).slice(0, 15);
                const articlesContext = articlesData.map(a => ({ title: a.title, tags: a.tags })).slice(0, 15);

                const apiKey = "AIzaSyCyuyuxLEWbcl8XIxZRqTDV4kKVc1xY_H8";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const systemPrompt = `You are a helpful AI assistant for Badr Ibraheem's portfolio website. Your task is to provide a comprehensive response to a user's search query based on the provided website content (projects and articles).
                Your response MUST be in JSON format and adhere to the provided schema.
                1.  **Analyze the User's Query:** Understand the user's intent (are they asking a question, looking for a specific project, or exploring a topic?).
                2.  **Generate a 'summary':** Write a concise, conversational answer to the user's query using the provided content. If you find directly relevant projects or articles, mention their titles within the summary. If no relevant information is found, state that you couldn't find a match on the site.
                3.  **Generate 'suggestions':** Create an array of 3 to 4 follow-up search queries that the user might find interesting. These suggestions should guide the user to explore other relevant areas of the portfolio.
                Respond in the language of the user's query. The user's query is: "${query}"`;
                
                const userQuery = `Website Content:\n- Projects: ${JSON.stringify(projectsContext)}\n- Articles: ${JSON.stringify(articlesContext)}\n\nBased on the content above, answer the search query: "${query}"`;

                const payload = {
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                    contents: [{ parts: [{ text: userQuery }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "OBJECT",
                            properties: {
                                summary: { type: "STRING" },
                                suggestions: {
                                    type: "ARRAY",
                                    items: { type: "STRING" }
                                }
                            },
                            required: ["summary", "suggestions"]
                        }
                    }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) throw new Error(`API Error: ${response.status}`);
                    
                    const result = await response.json();
                    const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (!jsonText) throw new Error("No response text from AI.");
                    
                    const aiResponse = JSON.parse(jsonText);

                    let formattedSummary = escapeHTML(aiResponse.summary)
                        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                        .replace(/\*(.*?)\*/g, '<em>$1</em>')
                        .replace(/\n/g, '<br>');

                    const suggestionsHTML = aiResponse.suggestions.map(suggestion => 
                        `<button class="suggested-search-btn text-sm font-semibold bg-white/5 hover:bg-white/10 text-gray-300 py-2 px-4 rounded-full transition-colors">${suggestion}</button>`
                    ).join('');

                    aiSearchAnswerContainer.innerHTML = `
                        <div class="glass-card p-6 rounded-2xl">
                            <h3 class="text-xl font-bold gradient-text mb-4 flex items-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L14.5 9.5L22 12L14.5 14.5L12 22L9.5 14.5L2 12L9.5 9.5L12 2z"></path></svg>
                                AI Answer & Suggestions
                            </h3>
                            <div class="prose prose-invert max-w-none text-gray-300 mb-6">${formattedSummary}</div>
                            <div class="flex flex-wrap gap-2">
                                ${suggestionsHTML}
                            </div>
                        </div>`;
                    
                    document.querySelectorAll('.suggested-search-btn').forEach(btn => {
                        btn.addEventListener('click', () => {
                            const newQuery = btn.textContent;
                            searchInput.value = newQuery;
                            handleSearch(newQuery);
                        });
                    });

                } catch (error) {
                    console.error("AI Search Error:", error);
                    aiSearchAnswerContainer.innerHTML = `
                        <div class="text-center p-4 glass-card rounded-lg border border-red-500/30">
                            <p class="text-red-400">Sorry, the AI search is currently unavailable. Please try again later.</p>
                        </div>
                    `;
                }
            }


            function performKeywordSearch(query) {
                if (!query || query.length < 1) {
                    keywordSearchResultsContainer.innerHTML = '';
                    return;
                };

                const currentLang = getCookie('selected_language') || 'en';
                const lowerCaseQuery = query.toLowerCase();
                let resultsHTML = '';
                let resultCount = 0;

                // Search Projects
                const projectResults = myProjects.filter(p => 
                    (p.title && p.title.toLowerCase().includes(lowerCaseQuery)) ||
                    (p.description && p.description.toLowerCase().includes(lowerCaseQuery)) ||
                    (p.tags && p.tags.toLowerCase().includes(lowerCaseQuery)) ||
                    (p.tools && p.tools.toLowerCase().includes(lowerCaseQuery))
                );
                
                if (projectResults.length > 0) {
                    resultsHTML += `<h3 class="text-2xl font-bold text-white mb-6 border-b border-white/10 pb-3">${translations[currentLang].searchProjectsTitle}</h3>`;
                    projectResults.forEach(project => {
                        resultCount++;
                        resultsHTML += `
                            <a href="#" class="search-result-card view-project-btn-from-search gsap-reveal" data-id="${project.id}">
                                <div class="search-result-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" /></svg>
                                </div>
                                <div class="search-result-content">
                                    <h4 class="search-result-title">${project.title}</h4>
                                    <p class="search-result-description">${project.description}</p>
                                </div>
                                <div class="search-result-type-badge">${translations[currentLang].searchResultTypeProject}</div>
                            </a>
                        `;
                    });
                }


                const articleResults = articlesData.filter(a => 
                    (a.title && a.title.toLowerCase().includes(lowerCaseQuery)) ||
                    (a.content && a.content.toLowerCase().includes(lowerCaseQuery)) ||
                    (a.tags && a.tags.toLowerCase().includes(lowerCaseQuery))
                );

                if (articleResults.length > 0) {
                    resultsHTML += `<h3 class="text-2xl font-bold text-white mb-6 mt-10 border-b border-white/10 pb-3">${translations[currentLang].searchArticlesTitle}</h3>`;
                    articleResults.forEach(article => {
                         resultCount++;
                        resultsHTML += `
                            <a href="#" class="search-result-card view-article-btn-from-search gsap-reveal" data-id="${article.id}">
                                <div class="search-result-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" /></svg>
                                </div>
                                <div class="search-result-content">
                                    <h4 class="search-result-title">${article.title}</h4>
                                    <p class="search-result-description">${article.content.substring(0, 150)}...</p>
                                </div>
                                <div class="search-result-type-badge">${translations[currentLang].searchResultTypeArticle}</div>
                            </a>
                        `;
                    });
                }

                if (resultCount === 0) {
                    resultsHTML = `
                        <div class="text-center flex flex-col items-center justify-center gap-4 p-8">
                            <svg class="w-16 h-16 text-gray-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                            </svg>
                            <h4 class="text-2xl font-bold text-white">${translations[currentLang].searchNoResultsTitle}</h4>
                            <p class="text-gray-400 max-w-sm">${translations[currentLang].searchNoResultsDesc}</p>
                        </div>
                    `;
                }

                keywordSearchResultsContainer.innerHTML = resultsHTML;
                

                document.querySelectorAll('.view-project-btn-from-search').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        renderPage({ view: 'project', id: btn.dataset.id });
                    });
                });
                document.querySelectorAll('.view-article-btn-from-search').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.preventDefault();
                        renderPage({ view: 'article', id: btn.dataset.id });
                    });
                });
            }


            const contactFabBtn = document.getElementById('contact-fab-btn');
            const contactModal = document.getElementById('contact-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const modalOverlay = contactModal.querySelector('.modal-overlay-bg');
            const heroStoreBtn = document.getElementById('hero-store-btn');

            function showModal() {
                contactModal.classList.remove('modal-hidden');
            }

            function hideModal() {
                contactModal.classList.add('modal-hidden');
            }

            if(contactFabBtn && contactModal && closeModalBtn && modalOverlay) {
                contactFabBtn.addEventListener('click', showModal);
                closeModalBtn.addEventListener('click', hideModal);
                modalOverlay.addEventListener('click', hideModal);
            }

            if(heroStoreBtn) {
                heroStoreBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    renderPage({ view: 'store' });
                });
            }


            const chatFabBtn = document.getElementById('chat-fab-btn');
            const chatWidget = document.getElementById('chat-widget');
            const closeChatBtn = document.getElementById('close-chat-btn');
            const chatMessagesContainer = document.getElementById('chat-messages');
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            let chatHistory = [];

            function renderMessages() {
                chatMessagesContainer.innerHTML = '';
                chatHistory.forEach(msg => {
                    const messageEl = document.createElement('div');
                    messageEl.classList.add('chat-message', msg.role);
                    
                    const textEl = document.createElement('p');
                    textEl.innerHTML = msg.text.replace(/\n/g, '<br>'); 
                    messageEl.appendChild(textEl);

                    if (msg.role === 'bot' && msg.suggestions && msg.suggestions.length > 0) {
                        const suggestionsContainer = document.createElement('div');
                        suggestionsContainer.className = 'flex flex-col gap-2 mt-3'; 
                        msg.suggestions.forEach(suggestion => {

                            if (typeof suggestion === 'object' && suggestion.title && suggestion.id && suggestion.type) {
                                const link = document.createElement('a');
                                link.href = `#${suggestion.type}/${suggestion.id}`;
                                link.className = 'bot-suggestion-card';
                                
                                const placeholderImg = 'https://placehold.co/48x48/2B2729/988381?text=?';
                                
                                link.innerHTML = `
                                    <img src="${suggestion.coverImageUrl || placeholderImg}" alt="${suggestion.title}" onerror="this.src='${placeholderImg}'">
                                    <div class="suggestion-info">
                                        <div class="suggestion-type">${suggestion.type}</div>
                                        <div class="suggestion-title">${suggestion.title}</div>
                                    </div>
                                `;

                                link.onclick = (e) => {
                                    e.preventDefault();
                                    renderPage({ view: suggestion.type, id: suggestion.id });
                                    chatWidget.classList.remove('visible'); 
                                };
                                suggestionsContainer.appendChild(link);
                            } else if (typeof suggestion === 'string') {

                                const button = document.createElement('button');
                                button.textContent = suggestion;
                                button.className = 'text-xs sm:text-sm bg-white/10 hover:bg-white/20 text-gray-200 py-1.5 px-3 rounded-full transition-colors';
                                if (document.body.classList.contains('light-mode')) {
                                    button.className = 'text-xs sm:text-sm bg-black/5 hover:bg-black/10 text-gray-700 py-1.5 px-3 rounded-full transition-colors';
                                }
                                button.onclick = () => {
                                    getBotResponse(suggestion);
                                };
                                suggestionsContainer.appendChild(button);
                            }
                        });
                        messageEl.appendChild(suggestionsContainer);
                    }

                    chatMessagesContainer.appendChild(messageEl);
                });
                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            }
            
            function showTypingIndicator() {
                const typingEl = document.createElement('div');
                typingEl.classList.add('chat-message', 'bot', 'typing-indicator');
                typingEl.innerHTML = '<span></span><span></span><span></span>';
                chatMessagesContainer.appendChild(typingEl);
                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            }

            function removeTypingIndicator() {
                const indicator = chatMessagesContainer.querySelector('.typing-indicator');
                if (indicator) {
                    indicator.remove();
                }
            }

            async function getBotResponse(userMessage) {
                chatHistory.push({ role: 'user', text: userMessage });
                renderMessages();
                showTypingIndicator();

                const apiKey = "AIzaSyCyuyuxLEWbcl8XIxZRqTDV4kKVc1xY_H8"; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                const projectsContext = myProjects.map(p => ({ id: p.id, title: p.title, description: p.description, tags: p.tags, coverImageUrl: p.coverImageUrl })).slice(0, 10);
                const articlesContext = articlesData.map(a => ({ id: a.id, title: a.title, tags: a.tags, coverImageUrl: a.coverImageUrl })).slice(0, 10);

                const systemPrompt = `You are a helpful and friendly AI assistant for Badr Ibraheem's portfolio website. Your goal is to answer user questions and suggest relevant content.
- **Analyze the User's Query:** Understand their intent.
- **Formulate an Answer:** Based on the provided JSON data for projects and articles, create a concise, conversational answer.
- **Provide Suggestions:** From the provided content, select 2-3 of the MOST relevant projects or articles related to the user's query. If no content is relevant, return an empty array.
- **Language:** Respond in the same language as the user's query.
- **JSON Output:** Your entire response MUST be a valid JSON object following this schema: 
{
  "answer": "Your conversational answer here.", 
  "suggestions": [
    {
      "type": "project" | "article",
      "id": "The unique ID of the item",
      "title": "The title of the item",
      "coverImageUrl": "The cover image URL of the item"
    }
  ]
}`;

                const userQueryForApi = `WEBSITE CONTENT:
- Projects: ${JSON.stringify(projectsContext)}
- Articles: ${JSON.stringify(articlesContext)}

USER QUERY: "${userMessage}"`;


                const payload = {
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                    contents: [{ parts: [{ text: userQueryForApi }] }],
                    generationConfig: {
                        responseMimeType: "application/json",
                        responseSchema: {
                            type: "OBJECT",
                            properties: {
                                answer: { type: "STRING" },
                                suggestions: {
                                    type: "ARRAY",
                                    items: {
                                        type: "OBJECT",
                                        properties: {
                                            type: { type: "STRING" },
                                            id: { type: "STRING" },
                                            title: { type: "STRING" },
                                            coverImageUrl: { type: "STRING" }
                                        },
                                        required: ["type", "id", "title"]
                                    }
                                }
                            },
                            required: ["answer", "suggestions"]
                        }
                    }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        throw new Error(`API request failed with status ${response.status}`);
                    }

                    const result = await response.json();
                    const jsonText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (!jsonText) throw new Error("No valid JSON response from AI.");

                    const aiResponse = JSON.parse(jsonText);
                    
                    chatHistory.push({ role: 'bot', text: aiResponse.answer, suggestions: aiResponse.suggestions });
                } catch (error) {
                    console.error("Chatbot API Error:", error);
                    chatHistory.push({ role: 'bot', text: "Apologies, I'm having trouble connecting right now. Please try again in a moment.", suggestions: [] });
                } finally {
                    removeTypingIndicator();
                    renderMessages();
                    sessionStorage.setItem('chatHistory', JSON.stringify(chatHistory));
                }
            }

            if(chatFabBtn) {
                 window.addEventListener('scroll', () => {
                    if (window.scrollY > 400) {
                        chatFabBtn.classList.add('fab-visible');
                    } else {
                        chatFabBtn.classList.remove('fab-visible');
                    }
                }, { passive: true });

                chatFabBtn.addEventListener('click', () => {
                    chatWidget.classList.toggle('visible');
                    if (chatWidget.classList.contains('visible') && chatHistory.length === 0) {

                        chatHistory.push({ role: 'bot', text: "Hello! I'm Badr's AI assistant. How can I help you today?" });
                        renderMessages();
                    }
                });
            }
            if(closeChatBtn) closeChatBtn.addEventListener('click', () => chatWidget.classList.remove('visible'));

            if(chatForm) {
                chatForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const userMessage = chatInput.value.trim();
                    if (userMessage) {
                        getBotResponse(userMessage);
                        chatInput.value = '';
                    }
                });
            }


            const savedHistory = sessionStorage.getItem('chatHistory');
            if (savedHistory) {
                chatHistory = JSON.parse(savedHistory);
                renderMessages();
            }



            if (contactFabBtn) {
                window.addEventListener('scroll', () => {
                    const scrollThreshold = 400; 
                    if (window.scrollY > scrollThreshold) {
                        contactFabBtn.classList.add('fab-visible');
                    } else {
                        contactFabBtn.classList.remove('fab-visible');
                    }
                }, { passive: true });
            }


            const lightbox = document.getElementById('image-lightbox');
            const lightboxImage = document.getElementById('lightbox-image');
            const closeLightboxBtn = document.getElementById('close-lightbox-btn');
            const lightboxOverlay = lightbox.querySelector('.lightbox-overlay');

            function showLightbox(src, alt = "Enlarged project image") {
                lightboxImage.src = src;
                lightboxImage.alt = alt;
                lightbox.classList.remove('modal-hidden');
            }

            function hideLightbox() {
                lightbox.classList.add('modal-hidden');
            }

            if(lightbox && closeLightboxBtn && lightboxOverlay) {
                closeLightboxBtn.addEventListener('click', hideLightbox);
                lightboxOverlay.addEventListener('click', hideLightbox);
            }


            const settingsModal = document.getElementById('settings-modal');
            const closeSettingsModalBtn = document.getElementById('close-settings-modal-btn');
            const settingsModalOverlay = settingsModal.querySelector('.settings-modal-overlay-bg');
            const settingsForm = document.getElementById('settings-form');
            const settingsStatus = document.getElementById('settings-status');


            async function showSettingsModal() {
                if (settingsModal) {
                    const profilePic = document.getElementById('profile-picture-img');
                    document.getElementById('light-mode-url').value = profilePic.dataset.lightSrc;
                    document.getElementById('dark-mode-url').value = profilePic.dataset.darkSrc;

                    const maintenanceToggle = document.getElementById('maintenance-mode-toggle');
                    try {
                        const statusDoc = await getDoc(siteStatusRef);
                        maintenanceToggle.checked = statusDoc.exists() && statusDoc.data().isMaintenanceMode;
                    } catch (error) {
                        console.error("Could not fetch maintenance status for settings:", error);
                        maintenanceToggle.checked = false;
                    }

                    settingsModal.classList.remove('modal-hidden');
                }
            }

            function hideSettingsModal() {
                if (settingsModal) {
                    settingsModal.classList.add('modal-hidden');
                    settingsStatus.textContent = '';
                }
            }

            if (settingsModal) {
                closeSettingsModalBtn.addEventListener('click', hideSettingsModal);
                settingsModalOverlay.addEventListener('click', hideSettingsModal);


                document.getElementById('maintenance-mode-toggle').addEventListener('change', async (e) => {
                    const isEnabled = e.target.checked;
                    settingsStatus.textContent = 'Updating...';
                    try {
                        await setDoc(siteStatusRef, { isMaintenanceMode: isEnabled }, { merge: true });
                        settingsStatus.textContent = `Maintenance mode ${isEnabled ? 'enabled' : 'disabled'}.`;
                    } catch (error) {
                        console.error("Error updating maintenance mode:", error);
                        settingsStatus.textContent = "Update failed.";
                    }
                    setTimeout(() => settingsStatus.textContent = '', 3000);
                });

                settingsForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const user = auth.currentUser;
                    if (!user) {
                        alert("You must be logged in to update settings.");
                        return;
                    }

                    const lightModeUrl = document.getElementById('light-mode-url').value;
                    const darkModeUrl = document.getElementById('dark-mode-url').value;
                    const settingsData = { lightModeUrl, darkModeUrl };
                    
                    settingsStatus.textContent = 'Saving image settings...';
                    try {
                        const adminRef = doc(db, 'admins', user.uid);
                        const publicSettingsRef = doc(db, 'settings', 'main_profile');


                        await updateDoc(adminRef, settingsData);
                        await setDoc(publicSettingsRef, settingsData, { merge: true });

                        const profilePic = document.getElementById('profile-picture-img');
                        profilePic.dataset.lightSrc = lightModeUrl;
                        profilePic.dataset.darkSrc = darkModeUrl;

                        applyTheme(localStorage.getItem('theme') || 'dark');
                        settingsStatus.textContent = 'Image settings saved!';
                        setTimeout(hideSettingsModal, 1500);

                    } catch (error) {
                        console.error("Error saving settings:", error);
                        settingsStatus.textContent = 'Failed to save image settings.';
                    }
                });
            }



            function initHorizontalTimeline() {
                const navContainer = document.getElementById('timeline-nav');
                const contentContainer = document.getElementById('timeline-content-cards');
                if (!navContainer || !contentContainer) return () => {};

                const experienceData = [
                    { year: '2025 - Present', titleKey: 'exp5Title', metaKey: 'exp5Meta', descKey: 'exp5Desc' },
                    { year: '2024 - 2025', titleKey: 'exp1Title', metaKey: 'exp1Meta', descKey: 'exp1Desc' },
                    { year: '2023', titleKey: 'exp6Title', metaKey: 'exp6Meta', descKey: 'exp6Desc' },
                    { year: '2021 - 2022', titleKey: 'exp2Title', metaKey: 'exp2Meta', descKey: 'exp2Desc' },
                    { year: '2019', titleKey: 'exp4Title', metaKey: 'exp4Meta', descKey: 'exp4Desc' }
                ];

                function render() {
                    const currentLang = getCookie('selected_language') || 'en';
                    let navHTML = '';
                    let contentHTML = '';

                    experienceData.forEach((event, index) => {
                        navHTML += `
                            <button class="timeline-nav-btn ${index === 0 ? 'active' : ''}" data-target="timeline-${index}">
                                ${event.year}
                            </button>
                        `;

                        contentHTML += `
                            <div class="timeline-content-card ${index === 0 ? 'active' : ''}" id="timeline-${index}">
                                <div class="glass-card p-6 rounded-xl text-center md:text-left">
                                    <h4 class="font-bold text-lg md:text-xl text-white">${translations[currentLang][event.titleKey]}</h4>
                                    <p class="text-sm text-gray-400">${translations[currentLang][event.metaKey]}</p>
                                    <p class="text-gray-300 mt-2 text-sm">${translations[currentLang][event.descKey]}</p>
                                </div>
                            </div>
                        `;
                    });

                    navContainer.innerHTML = navHTML;
                    contentContainer.innerHTML = contentHTML;


                    navContainer.querySelectorAll('.timeline-nav-btn').forEach(btn => {
                        btn.addEventListener('click', () => {

                            navContainer.querySelector('.active')?.classList.remove('active');
                            contentContainer.querySelector('.active')?.classList.remove('active');


                            btn.classList.add('active');
                            const targetId = btn.dataset.target;
                            document.getElementById(targetId)?.classList.add('active');
                        });
                    });
                }
                
                render(); 
                return render; 
            }

            const rerenderExperienceTimeline = initHorizontalTimeline();



            const langSwitcherBtn = document.getElementById('language-switcher-btn');
            const langDropdown = document.getElementById('language-dropdown');
            const langOptions = document.querySelectorAll('.language-option');
            const htmlEl = document.documentElement;

            function setCookie(name, value, days) {
                let expires = "";
                if (days) {
                    let date = new Date();
                    date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                    expires = "; expires=" + date.toUTCString();
                }
                document.cookie = name + "=" + (value || "") + expires + "; path=/";
            }

            function getCookie(name) {
                let nameEQ = name + "=";
                let ca = document.cookie.split(';');
                for (let i = 0; i < ca.length; i++) {
                    let c = ca[i];
                    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            }

            function applyLanguageStyles(lang) {
                if (lang === 'ar') {
                    htmlEl.dir = 'rtl';
                } else {
                    htmlEl.dir = 'ltr';
                }
            }

            function translatePage(lang = 'en') {
                document.querySelectorAll('[data-translate-key]').forEach(el => {
                    const key = el.dataset.translateKey;
                    const translationExists = translations[lang] && translations[lang][key];
                    

                    const text = translationExists ? translations[lang][key] : translations['en'][key];
                    if (text !== undefined) {
                      el.innerHTML = text;
                    }
                });
                document.querySelectorAll('[data-translate-placeholder]').forEach(el => {
                    const key = el.dataset.translatePlaceholder;
                    const translationExists = translations[lang] && translations[lang][key];
                    const text = translationExists ? translations[lang][key] : translations['en'][key];
                    if (text !== undefined) {
                        el.placeholder = text;
                    }
                });
                document.querySelectorAll('[data-translate-title]').forEach(el => {
                    const key = el.dataset.translateTitle;
                    const translationExists = translations[lang] && translations[lang][key];
                    const text = translationExists ? translations[lang][key] : (translations['en'][key] || '');
                    if (text) {
                        el.title = text;
                    }
                });
                

                const downloadCvBtn = document.getElementById('download-cv-btn');
                if (downloadCvBtn) {
                    if (lang === 'ar') {
                        downloadCvBtn.href = 'https://download947.mediafire.com/7td3gbmqs9ngLquD4JlZHMix8UFC_fxelPqF0_B5Z9COW5yH0YNjeFGfCaL8iyzJbz1yL3xUcaf2VaQSIbVlJickhh4hwEADbkpKXP3Oos20ZskLchksgf8c5A1ZcUNF63zxvd3c9xKlqw0WjKv-njHBX_8yfvlJ_C1w1nLbNQ/cliwrxtfrynub95/arabic.pdf';
                    } else {
                        downloadCvBtn.href = 'https://download848.mediafire.com/6095jg3kplfgm2ECsf8uZ007siImbRgRmEi7lGfW4GcUKB53-lPiL0yFaIDez_fJMr5tP89KkZ-stT-_9w6QuqER-EJpFSVGSQRTKi9xcaErDnxYDm-FPokxpIw2mqc1jpUVB5FUePNaeeUYGi8Lq0lE3x_vvHTzN1KgaiA11w/ezt3y339bjheap0/engish.pdf';
                    }
                }


                if (typeof rerenderExperienceTimeline === 'function') {
                    rerenderExperienceTimeline();
                }

                applyLanguageStyles(lang);
                setCookie('selected_language', lang, 365);
            }


            function generateSitemap() {
                const baseUrl = "https://badre.site/";
                const today = new Date().toISOString();

                let xml = `<?xml version="1.0" encoding="UTF-8"?>\n`;
                xml += `<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n`;


                xml += `  <url>\n`;
                xml += `    <loc>${baseUrl}</loc>\n`;
                xml += `    <lastmod>${today}</lastmod>\n`;
                xml += `    <priority>1.0</priority>\n`;
                xml += `  </url>\n`;


                myProjects.forEach(project => {
                    xml += `  <url>\n`;
                    xml += `    <loc>${baseUrl}#project/${project.id}</loc>\n`;
                    xml += `    <lastmod>${project.date ? new Date(project.date).toISOString() : today}</lastmod>\n`;
                    xml += `    <priority>0.8</priority>\n`;
                    xml += `  </url>\n`;
                });


                articlesData.forEach(article => {
                    xml += `  <url>\n`;
                    xml += `    <loc>${baseUrl}#article/${article.id}</loc>\n`;
                    xml += `    <lastmod>${article.createdAt?.toDate ? article.createdAt.toDate().toISOString() : today}</lastmod>\n`;
                    xml += `    <priority>0.7</priority>\n`;
                    xml += `  </url>\n`;
                });
                

                 ['#store', '#cv'].forEach(page => {
                    xml += `  <url>\n`;
                    xml += `    <loc>${baseUrl}${page}</loc>\n`;
                    xml += `    <lastmod>${today}</lastmod>\n`;
                    xml += `    <priority>0.9</priority>\n`;
                    xml += `  </url>\n`;
                });


                xml += `</urlset>`;

                const blob = new Blob([xml], { type: 'text/xml' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'sitemap.xml';
                a.click();
                URL.revokeObjectURL(url);
            }


            langSwitcherBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                langDropdown.classList.toggle('show');
            });

            document.addEventListener('click', (e) => {
                if (langDropdown && !langSwitcherBtn.contains(e.target) && !langDropdown.contains(e.target)) {
                    langDropdown.classList.remove('show');
                }

                const userMenu = document.getElementById('user-menu');
                const userDropdown = document.getElementById('user-dropdown');
                if (userMenu && userDropdown && !userMenu.contains(e.target)) {
                    userDropdown.classList.remove('show');
                    document.getElementById('user-menu-btn')?.classList.remove('open');
                }
            });
            
            langOptions.forEach(option => {
                option.addEventListener('click', (e) => {
                    e.preventDefault();
                    const lang = e.currentTarget.dataset.lang;
                    translatePage(lang);
                    langDropdown.classList.remove('show');
                });
            });



            gsap.registerPlugin(ScrollTrigger);
            
            function startMainAnimations() {
                gsap.set(".gsap-reveal", { opacity: 0, y: 30 });

                const headerElement = document.querySelector("header");
                const heroElements = {
                    greeting: document.getElementById('hero-greeting'),
                    line1: document.querySelector('[data-translate-key="heroLine1"]'),
                    line2: document.querySelector('[data-translate-key="heroLine2"]'),
                    line3: document.querySelector('[data-translate-key="heroLine3"]'),
                    bio: document.querySelector('[data-translate-key="heroBio"]'),
                    socials: document.getElementById('hero-socials'),
                    ctas: document.getElementById('hero-ctas'),
                    image: document.getElementById('hero-image-container')
                };

                gsap.to('.content-hidden', { opacity: 1, duration: 0.5 });
                
                if (headerElement && Object.values(heroElements).every(el => el)) {
                     const masterTimeline = gsap.timeline({ defaults: { ease: 'power3.out' }});

                    masterTimeline
                        .fromTo(headerElement, { y: -30, opacity: 0 }, { y: 0, opacity: 1, duration: 1 }, 0.2)
                        .fromTo(heroElements.image, { scale: 0.9, opacity: 0 }, { scale: 1, opacity: 1, duration: 1.2 }, 0.4)
                        .fromTo([
                            heroElements.greeting, 
                            heroElements.line1, 
                            heroElements.line2, 
                            heroElements.line3, 
                            heroElements.bio
                        ], { y: 30, opacity: 0 }, {
                            y: 0,
                            opacity: 1,
                            stagger: 0.15,
                            duration: 1
                        }, 0.6)
                        .fromTo(heroElements.socials, { y: 20, opacity: 0 }, { y: 0, opacity: 1, duration: 0.8 }, 1.0)
                        .fromTo(heroElements.ctas, { y: 20, opacity: 0 }, { y: 0, opacity: 1, duration: 0.8 }, 1.2);
                }


                if (document.getElementById('typing-effect')) {
                    const typed = new Typed('#typing-effect', {
                        strings: [
                            'Digital Experience Designer',
                            'Creative Graphic Designer',
                            'Front-End Developer'
                        ],
                        typeSpeed: 50,
                        backSpeed: 25,
                        backDelay: 2000,
                        loop: true
                    });
                }

                const sections = document.querySelectorAll('main > section');
                sections.forEach(section => {
                    if (section.id === 'hero') return;

                    const elementsToReveal = section.querySelectorAll('.gsap-reveal');
                    if (elementsToReveal.length > 0) {
                        gsap.to(elementsToReveal, {
                            scrollTrigger: { trigger: section, start: "top 85%", toggleActions: "play none none none" },
                            opacity: 1, y: 0, duration: 1.2, ease: "power3.out", stagger: 0.15,
                        });
                    }
                });

                const skillItems = document.querySelectorAll('.skill-item');
                skillItems.forEach(item => {
                    const bar = item.querySelector('.skill-bar');
                    const level = bar.dataset.level;
                    
                    ScrollTrigger.create({
                        trigger: item,
                        start: "top 90%",
                        once: true,
                        onEnter: () => { bar.style.width = level; }
                    });
                });
                
            }


            const preloader = document.getElementById('preloader');
            window.addEventListener('load', () => {

                    preloader.classList.add('hidden'); 
                    setTimeout(startMainAnimations, 50); 

            });

            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuCloseButton = document.getElementById('mobile-menu-close-button');
            const mobileMenuLinks = document.querySelectorAll('#mobile-menu .mobile-menu-link');
            const contactModalTriggers = document.querySelectorAll('.contact-modal-trigger');

            function openMobileMenu() {
                mobileMenu.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeMobileMenu() {
                mobileMenu.classList.remove('active');
                document.body.style.overflow = '';
            }

            mobileMenuButton.addEventListener('click', openMobileMenu);
            mobileMenuCloseButton.addEventListener('click', closeMobileMenu);
            
            mobileMenuLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    const href = link.getAttribute('href');
                    
                    if (href === '#store') {
                        e.preventDefault();
                        renderPage({ view: 'store' });
                        closeMobileMenu(); 
                    } else if (href && href.startsWith('#') && ['#hero', '#projects', '#blog', '#certificates'].includes(href)) {
                        e.preventDefault();
                        const viewId = href.substring(1);
                        

                        renderPage({ view: 'home' }); 
                        

                        setTimeout(() => {
                            const element = document.getElementById(viewId);
                            if (element) {
                                element.scrollIntoView({ behavior: 'smooth' });
                            }
                        }, 100);
                        
                        closeMobileMenu(); 
                    } else if (e.currentTarget.classList.contains('contact-modal-trigger')) {

                        e.preventDefault();
                        showModal();
                        closeMobileMenu();
                    } else {

                        closeMobileMenu();
                    }
                });
            });

            contactModalTriggers.forEach(trigger => {
                trigger.addEventListener('click', (e) => {
                    e.preventDefault();
                    showModal();

                    if (mobileMenu.classList.contains('active')) {
                        closeMobileMenu();
                    }
                });
            });
            

            listenForProjects();

            listenForArticles();
            listenForCertificates();
            listenForProducts();
            updateAndDisplayVisitorCount();


            const testimonialsSection = document.getElementById('testimonials');
            if (testimonialsSection) {
                const commentObserver = new IntersectionObserver((entries, observer) => {

                    if (entries[0].isIntersecting && !commentsLoaded) {
                        fetchComments();
                        observer.unobserve(testimonialsSection); 
                    }
                }, { rootMargin: '200px', threshold: 0.01 }); 

                commentObserver.observe(testimonialsSection);
            }
            

            const savedLang = getCookie('selected_language') || 'en';
            applyLanguageStyles(savedLang); 
            translatePage(savedLang);


            const sitemapBtn = document.getElementById('download-sitemap-btn');
            if (sitemapBtn) {
                sitemapBtn.addEventListener('click', generateSitemap);
            }


            const sections = document.querySelectorAll('main > section[id]');
            const navLinks = document.querySelectorAll('.nav-link');

            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.5 
            };

            const observer = new IntersectionObserver((entries) => {
                let activeSectionId = null;
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        activeSectionId = entry.target.id;
                    }
                });

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.dataset.navLink === activeSectionId) {
                        link.classList.add('active');
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });


            const headerSearchContainer = document.getElementById('header-search-container');
            const headerSearchInput = document.getElementById('header-search-input');
            const headerSearchBtn = document.getElementById('header-search-btn');
            const languageSwitcher = document.getElementById('language-switcher'); // تمت الإضافة



            function expandHeaderSearch() {
                if (!headerSearchInput || !themeToggleBtn || !languageSwitcher) return;
                headerSearchInput.classList.add('w-32', 'md:w-48', 'opacity-100', 'ml-2', 'px-1');
                headerSearchInput.classList.remove('w-0', 'opacity-0');
                themeToggleBtn.style.display = 'none';
                languageSwitcher.style.display = 'none';
                headerSearchInput.focus();
            }

            function collapseHeaderSearch() {
                if (!headerSearchInput || !themeToggleBtn || !languageSwitcher) return;
                headerSearchInput.classList.remove('w-32', 'md:w-48', 'opacity-100', 'ml-2', 'px-1');
                headerSearchInput.classList.add('w-0', 'opacity-0');
                themeToggleBtn.style.display = 'flex';
                languageSwitcher.style.display = 'block'; 
                headerSearchInput.value = ''; 
                headerSearchInput.blur();
            }
            
            if (headerSearchBtn && headerSearchInput) {
                headerSearchBtn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const isExpanded = headerSearchInput.classList.contains('w-32') || headerSearchInput.classList.contains('w-48');
                    const query = headerSearchInput.value.trim();

                    if (isExpanded && query.length > 0) {

                        window.location.hash = `search/${encodeURIComponent(query)}`;
                        collapseHeaderSearch(); 
                    } else if (isExpanded && query.length === 0) {

                        collapseHeaderSearch();
                    } else {

                        expandHeaderSearch();
                    }
                });

                headerSearchInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        const query = headerSearchInput.value.trim();
                        if (query.length > 0) {
                            window.location.hash = `search/${encodeURIComponent(query)}`;
                            collapseHeaderSearch(); 
                        }
                    }
                });


                document.addEventListener('click', (e) => {
                    if (headerSearchContainer && !headerSearchContainer.contains(e.target)) {
                        collapseHeaderSearch(); 
                    }
                });
            }

            searchCloseBtn.addEventListener('click', hideSearchUI);

            searchModal.addEventListener('click', (e) => {
                if(e.target === searchModal) {
                    hideSearchUI();
                }
            });

            closeSearchBtn.addEventListener('click', () => {
                renderPage({ view: 'home' });
                window.location.hash = '';
            });
            closeStoreBtn.addEventListener('click', () => {
                renderPage({ view: 'home' });
                window.location.hash = '';
            });

            searchForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const query = searchInput.value.trim();
                if (query) {
                    hideSearchUI();
                    renderPage({ view: 'search', query: query });
                }
            });

            function handleSearch(query) {
                showSearchResultsView(query);
                performKeywordSearch(query);
                getAiSummaryAndSuggestions(query);
            }


            document.addEventListener('copy', (event) => {
                const selection = document.getSelection();
                const copyrightNotice = `\n\n© 2025 Badr Ibraheem. All rights reserved`;
                const textToCopy = selection.toString() + copyrightNotice;
                
                event.clipboardData.setData('text/plain', textToCopy);
                event.preventDefault();
            });


            async function renderPage(state = { view: 'home' }) {

                window.removeEventListener('scroll', updateReadingProgress, { passive: true });
                readingProgressBar.style.display = 'none';
                if (galleryKeydownListener) {
                    document.removeEventListener('keydown', galleryKeydownListener);
                    galleryKeydownListener = null;
                }
                const schemaScript = document.getElementById('dynamic-schema-script');
                if (schemaScript) schemaScript.remove();
                
                const isLeavingHome = !mainContent.classList.contains('hidden');
                if (isLeavingHome && state.view !== 'home') {
                    lastScrollPosition = window.scrollY;
                }


                mainContent.classList.add('hidden');
                projectDetailView.classList.add('hidden');
                articleDetailView.classList.add('hidden');
                searchResultsView.classList.add('hidden');
                storeView.classList.add('hidden');
                cvView.classList.remove('visible');
                productDetailView.classList.add('hidden');

                if (state.view === 'project') {
                    const projectId = state.id;
                    await waitForData(myProjects);
                    const project = myProjects.find(p => p.id === projectId);
                    if (project) {
                        showProjectDetailView(project);
                    } else {
                        showNotFound();
                    }
                } else if (state.view === 'article') {
                    const articleId = state.id;
                    await waitForData(articlesData);
                    const article = articlesData.find(a => a.id === articleId);
                    if (article) {
                        showArticleDetailView(article);
                    } else {
                        showNotFound();
                    }
                } else if (state.view === 'search') {
                    const query = state.query;
                    handleSearch(query);
                } else if (state.view === 'store') {
                    document.title = "Store | Badr Ibraheem";
                    storeView.classList.remove('hidden');
                    window.scrollTo(0, 0);
                } else if (state.view === 'product') {
                    const productId = state.id;
                    const product = productsData.find(p => p.id == productId);
                    if (product) {
                        showProductDetailView(product);
                    } else {
                        showNotFound();
                    }
                } else if (state.view === 'cv') {
                    mainContent.classList.remove('hidden'); 
                    cvView.classList.add('visible');
                } else { 
                    document.title = originalTitle;
                    mainContent.classList.remove('hidden');
                    hideSearchResultsView(); 
                    setTimeout(() => {
                        window.scrollTo({ top: lastScrollPosition, behavior: 'auto' });
                    }, 0);
                }
            }

            function updateCommentAvatar(theme) {
                const profilePic = document.getElementById('profile-picture-img');
                const commentAvatar = document.getElementById('comment-avatar');
                if (profilePic && commentAvatar) {
                    const themeSpecificSrc = theme === 'light' ? profilePic.dataset.lightSrc : profilePic.dataset.darkSrc;
                    if(themeSpecificSrc) commentAvatar.src = themeSpecificSrc;
                }
            }

            function showNotFound() {
                switchToView(mainContent); 
                mainContent.innerHTML = `<div class="min-h-screen flex items-center justify-center text-center p-4"><div><h1 class="text-5xl font-bold gradient-text mb-4">404</h1><p class="text-xl text-gray-300">The page you're looking for could not be found.</p><a href="#" class="submit-btn mt-8" onclick="window.location.hash=''; window.location.reload(); return false;">Return Home</a></div></div>`;
                window.scrollTo(0,0);
            }
            
            async function waitForData(checkFn) {
                if (checkFn()) return;

                const loadingTimeout = setTimeout(() => {
                     if (preloader) preloader.classList.remove('hidden');
                }, 200);

                return new Promise(resolve => {
                    const interval = setInterval(() => {
                        if (checkFn()) {
                            clearInterval(interval);
                            clearTimeout(loadingTimeout);
                            if (preloader) preloader.classList.add('hidden');
                            resolve();
                        }
                    }, 100);
                     setTimeout(() => { 
                        clearInterval(interval);
                        clearTimeout(loadingTimeout);
                        if (preloader) preloader.classList.add('hidden');
                        resolve(); 
                    }, 8000); 
                });
            }


            function updateAllStructuredData() {

                if (myProjects.length === 0 && articlesData.length === 0 && certificatesData.length === 0 && productsData.length === 0) {
                    return;
                }

                const oldSchema = document.getElementById('site-wide-schema-script');
                if(oldSchema) oldSchema.remove();

                const siteData = {
                    "@context": "https://schema.org",
                    "@type": "WebSite",
                    "url": "https://badre.site/",
                    "name": "Badr Ibraheem - Portfolio",
                    "author": {
                        "@type": "Person",
                        "name": "Badr Ibraheem Mohameed",
                        "url": "https://badre.site/"
                    },
                    "potentialAction": {
                        "@type": "SearchAction",
                        "target": {
                            "@type": "EntryPoint",
                            "urlTemplate": "https://badre.site/#search/{search_term_string}"
                        },
                        "query-input": "required name=search_term_string"
                    },
                    "hasPart": []
                };


                myProjects.forEach(project => {
                    siteData.hasPart.push({
                        "@type": "CreativeWork",
                        "name": project.title,
                        "description": project.description,
                        "url": `https://badre.site/#project/${project.id}`,
                        "image": project.coverImageUrl
                    });
                });


                articlesData.forEach(article => {
                    siteData.hasPart.push({
                        "@type": "Article",
                        "headline": article.title,
                        "url": `https://badre.site/#article/${article.id}`,
                        "image": article.coverImageUrl,
                         "author": {
                            "@type": "Person",
                            "name": "Badr Ibraheem Mohameed"
                        }
                    });
                });


                productsData.forEach(product => {
                    const coverImage = (product.media && product.media.length > 0) ? product.media.find(m => m.type === 'image')?.url || product.media[0].url : undefined;
                    siteData.hasPart.push({
                        "@type": "Product",
                        "name": product.name,
                        "description": product.description,
                        "image": coverImage,
                        "offers": {
                            "@type": "Offer",
                            "price": product.price,
                            "priceCurrency": product.currency || "EGP",
                            "availability": "https://schema.org/InStock"
                        },
                        "aggregateRating": {
                            "@type": "AggregateRating",
                            "ratingValue": "4.9",
                            "reviewCount": "89"
                        },
                        "review": {
                            "@type": "Review",
                            "author": {
                                "@type": "Person",
                                "name": "Badr Ibraheem"
                            },
                            "reviewBody": "A high-quality product that meets professional standards, designed by Badr Ibraheem."
                        }
                    });
                });


                certificatesData.forEach(cert => {
                    siteData.hasPart.push({
                        "@type": "CreativeWork",
                        "name": cert.title,
                        "image": cert.imageUrl
                    });
                });

                const schemaScript = document.createElement('script');
                schemaScript.type = 'application/ld+json';
                schemaScript.id = 'site-wide-schema-script';
                schemaScript.text = JSON.stringify(siteData);
                document.head.appendChild(schemaScript);
            }


            async function router() {
                const hash = window.location.hash.substring(1);
                if (!hash) {
                    renderPage({ view: 'home' });
                    return;
                }

                const [view, ...params] = hash.split('/');
                const id = params[0] || null;

                if (view === 'project' && id) {
                    renderPage({ view: 'project', id: id });
                } else if (view === 'article' && id) {
                    renderPage({ view: 'article', id: id });
                } else if (view === 'search' && id) {
                    renderPage({ view: 'search', query: decodeURIComponent(id) });
                } else if (view === 'store') {
                    renderPage({ view: 'store' });
                } else if (view === 'product' && id) {
                    renderPage({ view: 'product', id: id });
                } else if (view === 'cv') {
                    renderPage({ view: 'cv' });
                } else if (['hero', 'projects', 'blog', 'certificates'].includes(view)) {

                    await renderPage({ view: 'home' }); 

                    setTimeout(() => {
                        const element = document.getElementById(view);
                        if (element) {
                            element.scrollIntoView({ behavior: 'smooth' });
                        }
                    }, 100); 
                } else { 
                    renderPage({ view: 'home' });
                }
            }


            function switchToView(viewToShow) {

                const allViews = [
                    mainContent, 
                    projectDetailView, 
                    articleDetailView, 
                    searchResultsView, 
                    storeView, 
                    productDetailView
                ];


                allViews.forEach(view => {
                    if (view) view.classList.add('hidden');
                });


                if (cvView) cvView.classList.remove('visible');


                if (viewToShow) {
                     viewToShow.classList.remove('hidden');
                }
            }


            async function renderPage(state = { view: 'home' }) {

                window.removeEventListener('scroll', updateReadingProgress, { passive: true });
                if (readingProgressBar) readingProgressBar.style.display = 'none';
                if (galleryKeydownListener) {
                    document.removeEventListener('keydown', galleryKeydownListener);
                    galleryKeydownListener = null;
                }
                const schemaScript = document.getElementById('dynamic-schema-script');
                if (schemaScript) schemaScript.remove();
                
                const isLeavingHome = mainContent && !mainContent.classList.contains('hidden');
                if (isLeavingHome && state.view !== 'home') {
                    lastScrollPosition = window.scrollY;
                }

                try {
                    if (state.view === 'project') {
                        const projectId = state.id;
                        await waitForData(() => myProjects.length > 0);
                        const project = myProjects.find(p => p.id === projectId);
                        if (project) {
                            showProjectDetailView(project);
                            switchToView(projectDetailView);
                        } else {
                            showNotFound();
                        }
                    } else if (state.view === 'article') {
                        const articleId = state.id;
                        await waitForData(() => articlesData.length > 0);
                        const article = articlesData.find(a => a.id === articleId);
                        if (article) {
                            showArticleDetailView(article);
                            switchToView(articleDetailView);
                        } else {
                            showNotFound();
                        }
                    } else if (state.view === 'search') {
                        const query = state.query;

                        await waitForData(() => myProjects.length > 0 || articlesData.length > 0);
                        handleSearch(query);
                        switchToView(searchResultsView);
                    } else if (state.view === 'store') {
                        document.title = "Store | Badr Ibraheem";
                        switchToView(storeView);
                        window.scrollTo(0, 0);
                    } else if (state.view === 'product') {
                        const productId = state.id;
                        await waitForData(() => productsData.length > 0);
                        const product = productsData.find(p => p.id == productId);
                        if (product) {
                            showProductDetailView(product);
                            switchToView(productDetailView);
                        } else {
                            showNotFound();
                        }
                    } else if (state.view === 'cv') {

                        switchToView(mainContent); 
                        if (cvView) cvView.classList.add('visible');
                    } else { 
                        document.title = originalTitle;
                        switchToView(mainContent);

                        if (lastScrollPosition > 0) {
                            setTimeout(() => {
                                window.scrollTo({ top: lastScrollPosition, behavior: 'auto' });
                            }, 0);
                        } else {
                             window.scrollTo(0, 0);
                        }
                    }
                } catch (error) {
                    console.error("Error during page render:", error);
                    switchToView(mainContent);
                }
            }
            window.addEventListener('hashchange', router);
            router(); 
        });
    </script>
</body>


</html>

